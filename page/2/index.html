<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="killsos">
<meta property="og:url" content="http://jsonload.com/page/2/index.html">
<meta property="og:site_name" content="killsos">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="killsos">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://jsonload.com/page/2/">





  <title>killsos</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">killsos</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人情似水分高下 世事如云任卷舒</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/12/web性能测试优化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/12/web性能测试优化/" itemprop="url">web性能测试优化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-12T09:44:59+08:00">
                2019-12-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-lighthouse"><a href="#1-lighthouse" class="headerlink" title="1. lighthouse"></a>1. lighthouse</h2><pre><code>npm i -g lighthouse
</code></pre><h2 id="2-FP、FCP、FMP与LCP"><a href="#2-FP、FCP、FMP与LCP" class="headerlink" title="2. FP、FCP、FMP与LCP"></a>2. FP、FCP、FMP与LCP</h2><pre><code>FP（全称“First Paint”，翻译为“首次绘制”） 是时间线上的第一个“时间点”

它代表浏览器第一次向屏幕传输像素的时间，也就是页面在屏幕上首次发生视觉变化的时间

FP不包含默认背景绘制，但包含非默认的背景绘制


FCP（全称“First Contentful Paint”，翻译为“首次内容绘制”）
它代表浏览器第一次向屏幕绘制 “内容”

注意：只有首次绘制文本、图片（包含背景图）、非白色的canvas或SVG时才被算作FCP

FP与FCP这两个指标之间的主要区别是：FP是当浏览器开始绘制内容到屏幕上的时候

只要在视觉上开始发生变化，无论是什么内容触发的视觉变化，在这一刻，这个时间点，叫做FP

相比之下，FCP指的是浏览器首次绘制来自DOM的内容。例如：文本，图片，SVG，canvas元素等，这个时间点叫FCP。

FP和FCP可能是相同的时间，也可能是先FP后FCP
</code></pre><h2 id="FMP"><a href="#FMP" class="headerlink" title="FMP"></a>FMP</h2><pre><code>FMP（全称“First Meaningful Paint”，翻译为“首次有效绘制”） 表示页面的“主要内容”开始出现在屏幕上的时间点。它是我们测量用户加载体验的主要指标。

FMP本质上是通过一个算法来猜测某个时间点可能是FMP，所以有时候不准
</code></pre><h2 id="LCP"><a href="#LCP" class="headerlink" title="LCP"></a>LCP</h2><pre><code>LCP（全称“Largest Contentful Paint”） 表示可视区“内容”最大的可见元素开始出现在屏幕上的时间点
了解和测量网站真实的性能其实非常困难，像load和DOMContentLoaded不会告诉我们用户什么时候可以在屏幕上看到内容
而FP和FCP又只能捕获整个渲染过程的最开始，FMP更好一点，但是它的算法比较复杂，而且前面说了，有时候不准
根据W3C Web性能工作组的讨论和Google的研究，发现测量页面主要内容的可见时间有一种更精准且简单的方法是查看什么时候渲染最大元素
</code></pre><h2 id="TTI"><a href="#TTI" class="headerlink" title="TTI"></a>TTI</h2><pre><code>TTI（全称“Time to Interactive”，翻译为“可交互时间”） 表示网页第一次 完全达到可交互状态 的时间点。可交互状态指的是页面上的UI组件是可以交互的

（可以响应按钮的点击或在文本框输入文字等），不仅如此，此时主线程已经达到“流畅”的程度，主线程的任务均不超过50毫秒。

TTI很重要，因为TTI可以让我们了解我们的产品需要多久可以真正达到“可用”的状态
</code></pre><h2 id="TTFB"><a href="#TTFB" class="headerlink" title="TTFB"></a>TTFB</h2><pre><code>TTFB（全称“Time to First Byte”） 表示浏览器接收第一个字节的时间
</code></pre><h2 id="FCI"><a href="#FCI" class="headerlink" title="FCI"></a>FCI</h2><pre><code>全称“First CPU Idle”） 是对TTI的一种补充，TTI可以告诉我们页面什么时候完全达到可用，但是我们不知道浏览器第一次可以响应用户输入是什么时候。
我们不知道网页的“最小可交互时间”是多少，最小可交互时间是说网页的首屏已经达到了可交互的状态了，但整个页面可能还没达到。
从名字也可以看出这个指标的意思，第一次CPU空闲，主线程空闲就代表可以接收用户的响应了。
更通俗的理解TTI与FCI的区别：FCI代表浏览器真正的第一次可以响应用户的输入，而TTI代表浏览器已经可以持续性的响应用户的输入
</code></pre><h2 id="FID"><a href="#FID" class="headerlink" title="FID"></a>FID</h2><pre><code>全称“First Input Delay”，翻译为“首次输入延迟”） 顾名思义，FID指的是用户首次与产品进行交互时，我们产品可以在多长时间给出反馈
TTI可以告诉我们网页什么时候可以开始流畅地响应用户的交互，但是如果用户在TTI的时间内，没有与网页产生交互，那么TTI其实是影响不到用户的
TTI是不需要用户参与的指标，但如果我们真的想知道TTI对用户的影响，我们需要FID。不同的用户可能会在TTI之前开始与网页产生交互
也可能在TTI之后才与网页产生交互。所以对于不同的用户它的FID是不同的。如果在TTI之前用户就已经与网页产生了交互
那么它的FID时间就比较长，而如果在TTI之后才第一次与网页产生交互，那么他的FID时间就短。

捕获FID比较简单，我们只需要在网页的head标签里注册一个事件（click、mousedown、keydown、touchstart、pointerdown）
然后在事件响应函数中使用当前时间减去事件对象被创建的时间即可

performance.now() - event.timeStamp
</code></pre><h2 id="DCL"><a href="#DCL" class="headerlink" title="DCL"></a>DCL</h2><pre><code>DCL 表示DomContentloaded事件触发的时间。
L 表示onLoad事件触发的时间。
DomContentloaded事件与onLoad事件的区别是，浏览器解析HTML这个操作完成后立刻触发DomContentloaded事件
而只有页面所有资源都加载完毕后（比如图片，CSS），才会触发onLoad事件
</code></pre><h2 id="Speed-Index"><a href="#Speed-Index" class="headerlink" title="Speed Index"></a>Speed Index</h2><pre><code>表示显示页面可见部分的平均时间（注意，是真正的可见，用户可以立马看见的，屏幕外的部分不算），数值越小说明速度越快
它主要用于测量页面内容在视觉上填充的速度。通常会使用这个指标来进行性能的比较。比如优化前和优化后
我们的产品与竞品的性能比较等。但是只能用于 粗略 的比较，不同的产品侧重点完全不同
所以还是需要根据自己产品所侧重的方向，并结合其他指标来进行更详细的对比
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/12/图片懒加载小结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/12/图片懒加载小结/" itemprop="url">图片懒加载小结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-12T09:14:31+08:00">
                2019-12-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-如何判断图片出现在当前视口"><a href="#1-如何判断图片出现在当前视口" class="headerlink" title="1. 如何判断图片出现在当前视口"></a>1. 如何判断图片出现在当前视口</h2><p>监听window.scroll事件  通过clientTop，offsetTop，clientHeight 以及 scrollTop 都是一些元素高度的属性 判断是否出现当前视口</p>
<pre><code>&lt;img data-src=&quot;imgurl.jpg&quot;&gt;
首先设置一个临时属性 data-src，加载时再使用 src 代替 data-src
</code></pre><h2 id="2-如何判断图片出现在了当前视口"><a href="#2-如何判断图片出现在了当前视口" class="headerlink" title="2. 如何判断图片出现在了当前视口"></a>2. 如何判断图片出现在了当前视口</h2><pre><code>Element.getBoundingClientRect() 方法返回元素的大小及其相对于视口的位置

// clientHeight 代表当前视口的高度
img.getBoundingClientRect().top &lt; document.documentElement.clientHeight

监听 window.scroll 事件也优化  通过节流提高性能 一般使用 lodash.throttle 
</code></pre><h2 id="3-如何判断图片出现在了当前视口"><a href="#3-如何判断图片出现在了当前视口" class="headerlink" title="3. 如何判断图片出现在了当前视口"></a>3. 如何判断图片出现在了当前视口</h2><pre><code>最新API IntersectionObserver 能够监听元素是否到了当前视口的事件，一步到位

事件回调的参数是 IntersectionObserverEntry 的集合，代表关于是否在可见视口的一系列值
其中，entry.isIntersecting 代表目标元素可见

const observer = new IntersectionObserver((changes) =&gt; {
// changes: 目标元素集合
changes.forEach((change) =&gt; {
    // intersectionRatio
    if (change.isIntersecting) {
    const img = change.target
    img.src = img.dataset.src
    observer.unobserve(img)
    }
})
})

observer.observe(img);

IntersectionObserver 除了给图片做懒加载外，还可以对单页应用资源做预加载

如在 next.js v9 中，会对视口内的资源做预加载，可以参考 next 9 production optimizations
</code></pre><h2 id="4-loading-”lazy”"><a href="#4-loading-”lazy”" class="headerlink" title="4. loading=”lazy”"></a>4. loading=”lazy”</h2><pre><code>&lt;img src=&quot;celebration.jpg&quot; loading=&quot;lazy&quot; alt=&quot;...&quot; /&gt;
&lt;iframe src=&quot;video-player.html&quot; loading=&quot;lazy&quot;&gt;&lt;/iframe&gt;

lazy还可以用在 iframe
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/05/js两大基石/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/05/js两大基石/" itemprop="url">js两大基石</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-05T15:22:39+08:00">
                2019-12-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基石"><a href="#基石" class="headerlink" title="基石"></a>基石</h2><ol>
<li><p>原型继承</p>
<pre><code>对象没有类 原型委托
</code></pre></li>
<li><p>函数式编程</p>
<pre><code>通过lambdas 和 闭包
</code></pre></li>
</ol>
<h2 id="创建对象方法"><a href="#创建对象方法" class="headerlink" title="创建对象方法"></a>创建对象方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj1= &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="built_in">Object</span>.create(prototype, &#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj3 = <span class="built_in">Object</span>.assign()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj4 = <span class="built_in">Object</span>.create()</span><br></pre></td></tr></table></figure>
<h2 id="new"><a href="#new" class="headerlink" title="new"></a>new</h2><pre><code>1. The `new` keyword is used to invoke a constructor. What it actually does is:

2. Create a new instance

3. Bind `this` to the new instance

4. Reference the new object’s delegate [[Prototype]] to the object referenced by the constructor function’s `prototype` property.

5. Reference the new object’s .constructor property to the constructor that was invoked.
Names the object type after the constructor, which you’ll notice mostly in the debugging console. You’ll see `[Object Foo]`, for example, instead of `[Object object]`.

6. Allows `instanceof` to check whether or not an object’s prototype reference is the same object referenced by the .prototype property of the constructor.
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/04/闭包最终一击/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/04/闭包最终一击/" itemprop="url">闭包最终一击</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-04T14:49:18+08:00">
                2019-12-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="执行上下文"><a href="#执行上下文" class="headerlink" title="执行上下文"></a>执行上下文</h2><pre><code>1. 全局代码  默认环境执行

2. 函数代码  生成一个函数上下文

3. let const花括号  块级作用域
</code></pre><h2 id="函数执行上下文"><a href="#函数执行上下文" class="headerlink" title="函数执行上下文"></a>函数执行上下文</h2><pre><code>1. js执行一个函数 首先创建一个新执行上下文  用于执行函数内部代码的局部上下文

2. 局部上下文会有自己变量集合 同时这些变量对上下文也是局部的

3. 新创建的执行上下文会处在调用栈最顶层

4. 调用栈可以认为是保存程序执行的上下文的机器

如果函数执行中遇到 return 或者 } 就认为函数结束了

函数结束之后会发生下面的步骤:

    1. 函数的局部执行上下文会被从调用栈抛出

    2. 函数将返回值返给调用执行上文

    3. 调用执行上下文也是一个执行上下文只是函数调用者 可能是全局上下文或局部上下文

    4. 调用执行上下文来处理这个返回值

    5. 如果没有返回值 默认是undefined

    6. 局部执行上下文会被销毁

    7. 局部执行上下文的结果是 局部执行上下文中声明局部变量也会被销毁

    8. 这些变量将不会被找到了 这也是为何被称之为 局部变量
</code></pre><h2 id="简单例子"><a href="#简单例子" class="headerlink" title="简单例子"></a>简单例子</h2><pre><code>1: let a = 3
2: function addTwo(x) {
3:   let ret = x + 2
4:   return ret
5: }
6: let b = addTwo(a)
7: console.log(b)


第一个行 创建全局变量a  并且赋值为3

第2行至第5行 在全局执行上下文中声明一个全局变量 addTwo 
并且一个函数赋值给addTwo

addTwo函数内代码没有被执行

第6行 在全局执行上下文创建一个变量b 值为undefined

这时候遇见一个赋值操作符 准备将一个新值赋给变量b

再进一步是一个函数调用  函数调用如果有return返回值给b 如果没有就是undefined

现在我们看函数addTwo调用中过程

注意javascript函数调用过程的参数 字面量是值传递方式 对象是引用方式传值

在执行函数执行过程第一步先创建新的局部执行上下文 我们起一个addTwo execution contex的名字 这个执行上下文压入到调用栈中 

函数addTwo执行的局部执行上下文创建后第一件事情是 查看函数的参数
在addTwo函数中有一个参数x 并且值为3 

接着addTwo执行上下文会查找var声明变量和函数声明 进行预解析

变量ret用let关键字声明的 所以不会预解析

执行到第3行时候 首先声明了变量ret 并且初始值为undefined 在局部执行上线文中

接着在局部执行上下文中查找变量x 并且查找到了 其值为3

第二个操作数是2  运算之后为5 赋值给变量ret

第4行是返回变量ret 在局部执行上下文查找ret 找到之后 返回其值 5

addTwo函数将5返回之后 addTwo就执行完毕了

函数addTwo执行完毕之后 变量x 和 ret 也会消失 不再存在 

对应创建创建的局部执行上下文也会销毁 同时会被调用栈

addTwo局部执行上下文会将返回值 返给 调用执行上下文

此时调用执行上下文是全局执行上下文 因为addTwo被调用是从全局执行上文中调用的

这是再继续执行就是 将addTwo局部执行上下文的返回值 赋值给变量b
</code></pre><h2 id="词法作用域-lexical-scope"><a href="#词法作用域-lexical-scope" class="headerlink" title="词法作用域 lexical scope"></a>词法作用域 lexical scope</h2><p>理解词法作用域 我们看下面的例子</p>
<pre><code>1: let val1 = 2
2: function multiplyThis(n) {
3:   let ret = n * val1
4:   return ret
5: }
6: let multiplied = multiplyThis(6)
7: console.log(&apos;example of scope:&apos;, multiplied)

在这里主要局部执行上下文中变量和全局执行上下文中变量是如何查找的

如果在局部执行上下文中没有发现的变量 可以在调用执行上下文中继续查找

然后不断向上查找 一直到全局执行上下文

1. 全局执行上下文声明变量x 并赋值2

2. 2-5行声明一个新变量 multiThis 并且赋值一个函数

3. 在全局执行上下文中声明变量multiplied

4. 找到全局执行上下文中变量multiThis 执行这个函数变量 赋值参数为6

5. 函数调用 会 生成一个新执行上下文 并且这是一个局部执行上下文

6. 在局部执行上下文声明一个变量n 并赋值6

7. 声明变量ret 

8. 执行乘法运算 n是局部执行上下文中的变量可以找到 val1在局部执行上下文没有
然后去调用执行上下文继续查找 一直到全局执行上下文

9. multiplyThis执行完毕后 销毁局部执行上下文和局部变量 ret n

10. 将返回值 返回给 调用执行上下文

函数有权访问调用执行上下文中变量的现象叫做 词法作用域 ## 这是原作者的看法
我认为词法作用域 一个函数访问权限取决于函数定义 而不是执行的时候

词法作用域 是根据 函数声明的位置 决定 函数访问父级作用域的现象

而不是函数执行位置来决定
</code></pre><h2 id="函数返回函数"><a href="#函数返回函数" class="headerlink" title="函数返回函数"></a>函数返回函数</h2><pre><code>1: let val = 7
2: function createAdder() {
3:   function addNumbers(a, b) {
4:     let ret = a + b
5:     return ret
6:   }
7:   return addNumbers
8: }
9: let adder = createAdder()
10: let sum = adder(val, 8)
11: console.log(&apos;example of function returning a function: &apos;, sum)

1. 在全局执行上下文中声明变量 val 并且赋值给7

2. 在全局执行上下文中声明一个变量createAdder 并且将一个函数赋值这个变量

3. 第9行 在全局变量声明变量adder 临时赋值undefined给这个变量adder

4. 接着执行函数createAdder 这时候去全局执行上下文寻找变量createAdder 然后调用

5. 函数调用 一个新的局部执行上下文被创建 然后在局部执行上下文创建局部变量 v8将新局部执行上下文压入调用栈

6. 接着是函数声明  创建一个局部变量addNumbers在局部执行上下文中 addNumbers仅存在局部执行上下文中
   addNumbers存储一个函数

7. 第7行返回变量addNumbers存储的值  一个函数可以返回任何 也包含函数 
   createAdder函数执行完毕后 与其对应的执行上下文 也会被从调用栈中移除

8. 第10行中 在全局上下文中创建一个新变量 sum 临时赋值为undefined

...
</code></pre><h2 id="closure"><a href="#closure" class="headerlink" title="closure"></a>closure</h2><pre><code>理解闭包 首先能懂两个概念 词法作用域 和  执行上下文

函数 与对其状态-即词法环境lexical environment的引用共同构成闭包（closure）

也就是说，闭包可以让你从内部函数访问外部函数作用域。

在JavaScript，函数在每次创建时生成闭包

总结 闭包 是 对函数与对其词法作用域的引用

1: function createCounter() {
2:   let counter = 0
3:   const myFunction = function() {
4:     counter = counter + 1
5:     return counter
6:   }
7:   return myFunction
8: }
9: const increment = createCounter()
10: const c1 = increment()
11: const c2 = increment()
12: const c3 = increment()
13: console.log(&apos;example increment&apos;, c1, c2, c3)

1. 全局作用域中创建一个函数变量createCounter

2. 全局作用域中创建一个常量 increment 初始值undefined

3. 执行createCounter函数 创建一个局部执行上下文 返回一个函数给变量increment

4. 在创建新的局部执行上下文中 声明一个新变量counter 赋值0

5. 接着声明一个常量myFunction 并将一个函数赋值给常量myFunction

6. 将常量myFunction的值 一个函数 赋值给 变量increment

7. 同时局部作用域中 myFunction 和 counter 被销毁 // 原作者的idea

8. 第10行 创建一个变量c1  寻找increment函数变量 并执行

9. increment函数执行 会创建一个新局部执行上下文  寻找变量counter 在当前局部执行上下文

10. 在这个局部执行上下文中没有声明任何变量  全局执上下文也没有counter这个变量

11. 这时候该闭包亮相了  闭包中包含变量counter 并且初始值为0

...
</code></pre><h2 id="重要的闭包"><a href="#重要的闭包" class="headerlink" title="重要的闭包"></a>重要的闭包</h2><pre><code>let c = 4
const addX = x =&gt; n =&gt; n + x
const addThree = addX(3)
let d = addThree(c)
console.log(&apos;example partial application&apos;, d)
</code></pre><h2 id="自己总结"><a href="#自己总结" class="headerlink" title="自己总结"></a>自己总结</h2><pre><code>闭包 是词法声明位置的词法作用域和调用作用域共同的引用
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/04/13-npm-tricks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/04/13-npm-tricks/" itemprop="url">13-npm-tricks</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-04T13:47:10+08:00">
                2019-12-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-基本快捷键"><a href="#1-基本快捷键" class="headerlink" title="1. 基本快捷键"></a>1. 基本快捷键</h2><pre><code>初始化  npm i

测试   npm t

帮助   npm -h 

全局   npm -g

开发依赖  npm -D 

初始化默认 npm init -y / npm init -f 

安装默认是 npm install --save -S 

--no-save
</code></pre><h2 id="2-少用快捷键"><a href="#2-少用快捷键" class="headerlink" title="2. 少用快捷键"></a>2. 少用快捷键</h2><pre><code>可选保存    --save-optional . Shortcut: -O

保存精确版本 --save-exact. Shortcut: -E
</code></pre><h2 id="3-The-Root-Shortcut"><a href="#3-The-Root-Shortcut" class="headerlink" title="3. The Root Shortcut"></a>3. The Root Shortcut</h2><pre><code>package.json main字段保存是 入口文件
</code></pre><h2 id="4-设置npm-init-默认值"><a href="#4-设置npm-init-默认值" class="headerlink" title="4. 设置npm init 默认值"></a>4. 设置npm init 默认值</h2><pre><code>npm config set init.author.name  &quot;Joe Bloggs&quot;
npm config set init.author.email &quot;joebloggs@gmail.com&quot;
npm config set init.author.url   &quot;joebloggs.com&quot;
npm config set init.license      &quot;MIT&quot;

npm config edit

npm config edit    -g
</code></pre><h2 id="5-跨平台兼容的脚本"><a href="#5-跨平台兼容的脚本" class="headerlink" title="5. 跨平台兼容的脚本"></a>5. 跨平台兼容的脚本</h2><pre><code>通过 cross-env 包

npm i -D cross-env

{
    &quot;scripts&quot;: {
        &quot;build&quot;: &quot;cross-env NODE_ENV=production webpack --config build/webpack.config.js&quot;
    }
}

rimraf can be installed globally to run cross-platform scripts
The UNIX command rm -rf for node.

ShellJS is a portable implementation of Unix shell commands on top of the Node.js API
</code></pre><h2 id="6-并行运行脚本"><a href="#6-并行运行脚本" class="headerlink" title="6. 并行运行脚本"></a>6. 并行运行脚本</h2><pre><code>1. &amp;&amp;  

2. concurrently 

3. npm-run-all 

npm i -D concurrently
{
    &quot;start&quot;: &quot;concurrently \&quot;command1 arg\&quot; \&quot;command2 arg\&quot;&quot;
}
</code></pre><h2 id="7-运行脚本在不同文件夹"><a href="#7-运行脚本在不同文件夹" class="headerlink" title="7. 运行脚本在不同文件夹"></a>7. 运行脚本在不同文件夹</h2><pre><code>有时候, 在一个app有多个package.json在不同文件夹中
如果在根目录下访问这些ackage.json中的脚本 而不是通过指定路径的方式
就是很方便 下面这种两种方法可以解决

1. cd folder &amp;&amp; npm start &amp;&amp; cd ..

2. 优雅方式是用 --prefix

    npm start --prefix path/to/your/folder

    如果同时启动前后端文件夹中脚本

    &quot;start&quot;: &quot;concurrently \&quot;(npm start --prefix client)\&quot; \&quot;(npm start --prefix server)\&quot;&quot;
</code></pre><h2 id="8-端口准备完毕后运行脚本"><a href="#8-端口准备完毕后运行脚本" class="headerlink" title="8. 端口准备完毕后运行脚本"></a>8. 端口准备完毕后运行脚本</h2><pre><code>Electron打开页面 等待react工程启动完毕后

&quot;dev&quot;: &quot;concurrently \&quot;cross-env BROWSER=none npm run start\&quot; \&quot;wait-on http://localhost:3000 &amp;&amp; electron .\&quot;&quot;

另外，React默认会打开一个浏览器窗口，但是对于Electron子开发而言，这是不必要的。 我们可以通过传递环境变量BROWSER=none来禁用此行为，该变量前面带有cross-env以实现跨平台兼容性
</code></pre><h2 id="9-列出并选择可选的脚本"><a href="#9-列出并选择可选的脚本" class="headerlink" title="9. 列出并选择可选的脚本"></a>9. 列出并选择可选的脚本</h2><pre><code>安装 npm i -g ntl

ntl 会列出package.json中的脚本
</code></pre><h2 id="10-Run-Pre-and-Post-Scripts"><a href="#10-Run-Pre-and-Post-Scripts" class="headerlink" title="10. Run Pre and Post Scripts"></a>10. Run Pre and Post Scripts</h2><pre><code>prebuild and postbuildwhich allow you to define code to run either before or after your build script

in fact pre and post can be added before any script, including custom ones
</code></pre><h2 id="11-Control-Your-App’s-Version"><a href="#11-Control-Your-App’s-Version" class="headerlink" title="11. Control Your App’s Version"></a>11. Control Your App’s Version</h2><pre><code>npm version plus major , minor or patch

// 1.0.0 当前版本

npm version patch
// 1.0.1

npm version minor
// 1.1.0

npm version major
// 2.0.0

{
    &quot;predeploy&quot;: &quot;npm version patch&quot;
}
</code></pre><h2 id="12-Edit-package-json-from-the-Command-Line"><a href="#12-Edit-package-json-from-the-Command-Line" class="headerlink" title="12. Edit package.json from the Command Line"></a>12. Edit package.json from the Command Line</h2><pre><code>npm install -g json

json -I -f package.json -e &apos;this.scripts.foo=&quot;bar&quot;&apos;
</code></pre><h2 id="13-Set-and-Open-Your-Repository-Automatically"><a href="#13-Set-and-Open-Your-Repository-Automatically" class="headerlink" title="13. Set and Open Your Repository Automatically"></a>13. Set and Open Your Repository Automatically</h2><pre><code>获取远程仓库地址

    git config --get remote.origin.url

package.json中添加仓库地址

json -I -f package.json -e &quot;this.repository=\&quot;$(git config --get remote.origin.url)\&quot;&quot;
</code></pre><h2 id="13-Create-a-Custom-npm-init-Script"><a href="#13-Create-a-Custom-npm-init-Script" class="headerlink" title="13. Create a Custom npm init Script"></a>13. Create a Custom npm init Script</h2><pre><code>npm config set init-module ~\.npm-init.js

.npm-init.js

    module.exports = {
        name: prompt(&apos;package name&apos;, basename || package.name),
        version: prompt(&apos;version&apos;, &apos;0.0.0&apos;),
        decription: prompt(&apos;description&apos;, &apos;&apos;),  
        main: prompt(&apos;entry point&apos;, &apos;index.js&apos;),
        repository: prompt(&apos;git repository&apos;, &apos;&apos;),
        keywords: prompt(function (s) { return s.split(/\s+/) }),
        author: prompt(&apos;author&apos;, &apos;Joe Bloggs &lt;joe.bloggs@gmail.com&gt; (joebloggs.com)&apos;),
        license: prompt(&apos;license&apos;, &apos;ISC&apos;)
    }
</code></pre><h2 id="14-Push-Your-First-Commit-to-GitHub-with-a-Custom-npm-init-Script"><a href="#14-Push-Your-First-Commit-to-GitHub-with-a-Custom-npm-init-Script" class="headerlink" title="14. Push Your First Commit to GitHub with a Custom npm init Script"></a>14. Push Your First Commit to GitHub with a Custom npm init Script</h2><pre><code>const { execSync } = require(&apos;child_process&apos;);

function run(func) {
    console.log(execSync(func).toString())
}

repository: prompt(&apos;github repository url&apos;, &apos;&apos;, function (url) {
    if (url) {
        run(&apos;touch README.md&apos;);
        run(&apos;git init&apos;);
        run(&apos;git add README.md&apos;);
        run(&apos;git commit -m &quot;first commit&quot;&apos;);
        run(`git remote add origin ${url}`);
        run(&apos;git push -u origin master&apos;);
    }
    return url;
})
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/04/自执行匿名函数本质/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/04/自执行匿名函数本质/" itemprop="url">自执行匿名函数本质</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-04T11:17:41+08:00">
                2019-12-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/03/javascript4种语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/03/javascript4种语句/" itemprop="url">javascript4种语句</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-03T17:06:43+08:00">
                2019-12-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-空语句"><a href="#1-空语句" class="headerlink" title="1. 空语句"></a>1. 空语句</h2><pre><code>用一个; 表示空语句
var litmus = &apos;neutral&apos;;
var pH; 

if(pH&gt;0 &amp;&amp; pH&lt;7)
    litmus = &apos;acidic&apos;;
else if(pH===7)
    ;       /* empty statement */
else if(pH&gt;7 &amp;&amp; pH&lt;15)
    litmus = &apos;basic&apos;;
else
    throw &quot;Invalid pH value&quot;;
</code></pre><h2 id="2-debugger语句"><a href="#2-debugger语句" class="headerlink" title="2. debugger语句"></a>2. debugger语句</h2><h2 id="3-labeled语句"><a href="#3-labeled语句" class="headerlink" title="3. labeled语句"></a>3. labeled语句</h2><pre><code>break continue

goto
</code></pre><h2 id="4-with语句"><a href="#4-with语句" class="headerlink" title="4. with语句"></a>4. with语句</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/03/使用ES6符号隐藏对象属性-属性的后备变量/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/03/使用ES6符号隐藏对象属性-属性的后备变量/" itemprop="url">使用ES6符号隐藏对象属性/属性的后备变量</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-03T16:43:19+08:00">
                2019-12-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="The-Problem-Hiding-The-Backing-Variable"><a href="#The-Problem-Hiding-The-Backing-Variable" class="headerlink" title="The Problem: Hiding The Backing Variable"></a>The Problem: Hiding The Backing Variable</h2><pre><code>1. this._foo 
</code></pre><h2 id="Hiding-Via-Closures"><a href="#Hiding-Via-Closures" class="headerlink" title="Hiding Via Closures"></a>Hiding Via Closures</h2><pre><code>function defineProperty(obj, key, value) {
    Object.defineProperty(obj, key, {
        get() {
            return value;
        },
        set(newValue) {
            value = newValue;
        }
    })
</code></pre><h2 id="Hiding-The-Backing-Variable-With-ES6-Symbols"><a href="#Hiding-The-Backing-Variable-With-ES6-Symbols" class="headerlink" title="Hiding The Backing Variable With ES6 Symbols"></a>Hiding The Backing Variable With ES6 Symbols</h2><pre><code>Symbol(“foo”)

Object.getOwnPropertySymbols() returns an array of Symbols that are stored on the object
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/03/Symbols/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/03/Symbols/" itemprop="url">Symbols</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-03T12:28:09+08:00">
                2019-12-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2019/12/03/javascript中getter与setter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/03/javascript中getter与setter/" itemprop="url">javascript中getter与setter</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-03T09:34:20+08:00">
                2019-12-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Getter与Setter是用来获得或者设置变量值得函数或者方法<br>Getter与Setter的概念是在计算机编程中一个普遍的概念<br>几乎所有高级编程语言<br>几乎所有的高级编程语言都带有一组用于实现getter和setter的语法，包括JavaScipt  </p>
<p>在这篇文章 我们将能懂getters setters是什么 如何建立和使用他们在Javascript  </p>
<h2 id="Getters-setters与封装"><a href="#Getters-setters与封装" class="headerlink" title="Getters-setters与封装"></a>Getters-setters与封装</h2><p>Getters-setters总是会与封装联系在一起<br>封装可以用两种方式来理解  </p>
<ol>
<li><p>首先 它是数据获取者、设置者和修改者的集合 这种限定在某些操作的时候是非常有意义的<br> 例如验证 在数据保存和展示之前 getter和setter提供了完美解决</p>
</li>
<li><p>依据封装是为了隐藏数据 使得外部不能访问内部数据 除了通过getter和setter 这样避免了程序中其他代码重写数据</p>
</li>
</ol>
<h2 id="创建Getters-setters"><a href="#创建Getters-setters" class="headerlink" title="创建Getters-setters"></a>创建Getters-setters</h2><ol>
<li>通过方法</li>
</ol>
<p>由于getter和setter本质改变和设置值的函数 </p>
<pre><code>var obj = {
    foo:    &apos;this is the value of foo&apos;,
    getFoo: function() {
                return this.foo;
    ,
    setFoo: function(val) {
                this.foo = val;
    }
}

    console.log(obj.getFoo());
    // &quot;this is the value of foo&quot;

    obj.setFoo(&apos;hello&apos;);

    console.log(obj.getFoo());
    // &quot;hello&quot;
    This is the simples  
</code></pre><ol start="2">
<li><p>通过关键字</p>
<pre><code>通过关键字get/set是官方和健壮的做法

var obj = {
    fooVal: &apos;this is the value of foo&apos;,
    get foo() {
        return this.fooVal;
    },
    set foo(val) {
        this.fooVal = val;
    }
}

    console.log(obj.foo);
    // &quot;this is the value of foo&quot;

    obj.foo = &apos;hello&apos;;

    console.log(obj.foo);
    // &quot;hello&quot;
</code></pre></li>
</ol>
<p>注意，数据只能存储在与getter-setter方法不同的属性名(fooVal)下，因为持有getter-setter方法的属性也不能持有数据。  </p>
<h2 id="Overwrite-prevention-重写保护"><a href="#Overwrite-prevention-重写保护" class="headerlink" title="Overwrite prevention 重写保护"></a>Overwrite prevention 重写保护</h2><p>如果因为某种原因选择第一种 想使属性通过getter-setter方法并且是一个只读属性<br>可以通过Object.defineProperties<br>Object.defineProperties, Object.defineProperty and Reflect.defineProperty automatically configure to writable: false which means read-only:</p>
<pre><code>/* Overwrite prevention */
var obj = {
foo: &apos;this is the value of foo&apos;
};

Object.defineProperties(obj, {
&apos;getFoo&apos;: {
    value: function () {
        return this.foo;
    }
},
&apos;setFoo&apos;: {
    value: function (val) {
        this.foo = val;
    }
}
});

obj.getFoo = 66;
// getFoo is not going to be overwritten!

console.log(obj.getFoo());
// &quot;this is the value of foo&quot;
</code></pre><h2 id="getter和setter中的操作"><a href="#getter和setter中的操作" class="headerlink" title="getter和setter中的操作"></a>getter和setter中的操作</h2><pre><code>var obj = {
n: 67,
get id() {
    return &apos;The ID is: &apos; + this.n;
},
set id(val) {
    if (typeof val === &apos;number&apos;)
        this.n = val;
}
}

console.log(obj.id);
// &quot;The ID is: 67&quot;

obj.id = 893;

console.log(obj.id);
// &quot;The ID is: 893&quot;

obj.id = &apos;hello&apos;;

console.log(obj.id);
// &quot;The ID is: 893&quot;
</code></pre><h2 id="通过getter与setter保护数据"><a href="#通过getter与setter保护数据" class="headerlink" title="通过getter与setter保护数据"></a>通过getter与setter保护数据</h2><ul>
<li><p>Unprotected data</p>
<pre><code>var obj = {
    fooVal: &apos;this is the value of foo&apos;,
    get foo() {
        return this.fooVal;
    },
    set foo(val) {
        this.fooVal = val;
    }
}

obj.fooVal = &apos;hello&apos;;

console.log(obj.foo);
// &quot;hello&quot;
</code></pre></li>
</ul>
<p>保护数据通过块级作用域或者函数作用域  </p>
<ol>
<li>块级作用域 通过let</li>
</ol>
<p>创建块级作用域一种方法是通过{}中创建</p>
<pre><code>/* BLOCK SCOPE, leave the braces alone! */

{
    let fooVal = &apos;this is the value of foo&apos;;
    var obj = {
        get foo() {
            return fooVal;
        },
        set foo(val) {
            fooVal = val
        }
    }
}

fooVal = &apos;hello&apos;;
// not going to affect the fooVal inside the block

console.log(obj.foo);
// &quot;this is the value of foo&quot;
</code></pre><ol start="2">
<li>函数作用域</li>
</ol>
<p>The more common way to protect the data with scoping is by keeping the data inside a function and returning an object with the getters and setters from that function.  </p>
<pre><code>function myobj(){
    var fooVal = &apos;this is the value of foo&apos;;
    return {
        get foo() {
            return fooVal;
        },
        set foo(val) {
            fooVal = val
        }
    }
}

fooVal = &apos;hello&apos;;
// not going to affect our original fooVal

var obj = myobj();

console.log(obj.foo);
// &quot;this is the value of foo&quot;
</code></pre><ol start="3">
<li>Data protection without scoping</li>
</ol>
<p>如果数据具有一个不太容易复制的变量/属性名称，则没有人（甚至我们自己）也不会通过为该变量/属性名称分配一些值来覆盖它  </p>
<pre><code>var obj = {
    s89274934764: &apos;this is the value of foo&apos;,
    get foo() {
        return this.s89274934764;
    },
    set foo(val) {
        this.s89274934764 = val;
    }
}

console.log(obj.foo);
// &quot;this is the value of foo&quot;
</code></pre><ol start="4">
<li><p>通过闭包</p>
<pre><code>function reactive(obj, prop, value){
    Object.defineProperty(obj, prop,{
        get() {
            return value
        },
        set(newValue) {
            value = newValue;
        }   
    })
}
</code></pre></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">killsos.ql@gmail.com</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">57</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">killsos.ql@gmail.com</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
