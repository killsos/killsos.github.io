<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="keywords" content="javascript 前端">
<meta property="og:type" content="website">
<meta property="og:title" content="killsos">
<meta property="og:url" content="http://jsonload.com/page/8/index.html">
<meta property="og:site_name" content="killsos">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="killsos">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://jsonload.com/page/8/">





  <title>killsos</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">killsos</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人情似水分高下 世事如云任卷舒</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/03/05/add链式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/05/add链式/" itemprop="url">add链式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-05T08:08:02+08:00">
                2020-03-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="add-1-2-3"><a href="#add-1-2-3" class="headerlink" title="add(1)(2)(3)"></a>add(1)(2)(3)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> sum = x;</span><br><span class="line">  <span class="keyword">let</span> tmp = <span class="function"><span class="keyword">function</span> (<span class="params">y</span>) </span>&#123;</span><br><span class="line">    sum += y;</span><br><span class="line">    <span class="keyword">return</span> tmp;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tmp.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>`</code>javascript<br>function add(x) {<br>  let tmp = function (y) {<br>    return add(x + y);<br>  }</p>
<p>  tmp.toString = function () {<br>    return x<br>  }</p>
<p>  return tmp;<br>}<br><code>`</code>9</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/03/04/How-the-new-‘Top-Level-Await’-feature-works-in-JavaScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/How-the-new-‘Top-Level-Await’-feature-works-in-JavaScript/" itemprop="url">How the new ‘Top Level Await’ feature works in JavaScript</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-04T16:12:30+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>以前，为了使用await，代码需要放在一个标记为async的函数中。<br>这意味着你不能在任何函数符号之外使用await。顶级的wait使模块能够像异步函数一样工作  </p>
<p>模块是异步的，并且具有导入和导出，这些模块也在顶层表示。</p>
<p>实际的含义是，如果您想提供一个依赖于某些异步任务的模块来执行某项操作，那么您实际上没有好的选择。</p>
<p>顶级await可以解决此问题，并使开发人员可以在异步函数之外使用await关键字。</p>
<p>通过顶层等待，ECMAScript模块可以等待资源，从而导致其他导入资源的模块在开始评估其主体之前等待，</p>
<p>或者如果模块加载失败或用作加载第一个模块，也可以将其用作加载依赖项回退 资源下载。</p>
<p>ps</p>
<ol>
<li><p>顶层等待仅在顶层模块上起作用。 不支持经典脚本或非异步功能。</p>
</li>
<li><p>截至撰写本文时，ECMAScript第3阶段</p>
</li>
</ol>
<h2 id="用例"><a href="#用例" class="headerlink" title="用例"></a>用例</h2><p>在顶层等待的情况下，下一个代码将按您期望的方式在模块中工作</p>
<ol>
<li>Using a fallback if module loading fails</li>
</ol>
<p>以下示例尝试从first.com加载JavaScript模块，如果失败则返回至</p>
<p>//module.mjs</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="built_in">module</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="built_in">module</span>= <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">'https://first.com/libs.com/module1'</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">  <span class="built_in">module</span>= <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">'https://second.com/libs/module1'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2.使用加载速度最快的资源</p>
<p>此处res变量通过首先完成的下载来初始化。</p>
<p>//module.mjs</p>
<p>const resPromises = [<br>    donwloadFromResource1Site,<br>    donwloadFromResource2Site<br> ];</p>
<p>const res = await Promise.any(resPromises);</p>
<ol start="3">
<li>Resource initialization</li>
</ol>
<p>顶级的await允许您在模块中等待承诺，就好像它们被包装在异步函数中一样。<br>这对于执行应用程序初始化非常有用</p>
<p>//module.mjs</p>
<p>import { dbConnector} from ‘./dbUtils.js’<br>//connect() return a promise</p>
<p>const connection = await dbConnector.connect();<br>export default function(){connection.list()}</p>
<ol start="4">
<li>Loading modules dynamically</li>
</ol>
<p>这允许模块使用运行时值来确定依赖项</p>
<p>//module.mjs</p>
<p>const params = new URLSearchParams(window.location.search);<br>const lang = params.get(‘lang’);<br>const messages = await import(<code>./messages-${lang}.mjs</code>)</p>
<ol start="5">
<li>Using await outside async functions in DevTools</li>
</ol>
<p>在使用async / await之前，尝试在async函数之外使用<br>await会导致：“ SyntaxError：await仅在async函数中有效”现在，<br>可以使用它而无需将其放在async函数中</p>
<p>这已在chrome 80和firefox 72.0.2 DevTools中进行了测试。<br>但是，此功能是非标准功能，无法在nodejs中使用。</p>
<p>const helloPromise = new Promise((resolve)=&gt;{<br>  setTimeout(()=&gt; resolve(‘Hello world!’), 5000);<br>})<br>const result =  await helloPromise;<br>console.log(result);</p>
<p>//5 seconds later…:</p>
<p>Implementations<br>V8 with flag: — — harmony-top-level-await<br>Webpack (experimental support in 5.0.0)<br>Parser support has been added to Babel (babel/plugin-syntax-top-level-await).//Hello world!</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/03/04/Phases-of-the-Node-JS-Event-Loop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/Phases-of-the-Node-JS-Event-Loop/" itemprop="url">Phases of the Node JS Event Loop</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-04T15:17:06+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="node-poll"><a href="#node-poll" class="headerlink" title="node  poll"></a>node  poll</h2><p>轮询阶段处理我们执行的所有输入/输出操作</p>
<p>您编写的所有同步JavaScript代码都将在事件循环的轮询阶段执行</p>
<p>当事件循环处于其迭代的轮询阶段时，将执行所有代码</p>
<p>轮询阶段处理的不仅仅是IO操作</p>
<h2 id="node-check"><a href="#node-check" class="headerlink" title="node  check"></a>node  check</h2><p>setImmediate</p>
<h2 id="node-close-callback"><a href="#node-close-callback" class="headerlink" title="node  close callback"></a>node  close callback</h2><h2 id="node-timer"><a href="#node-timer" class="headerlink" title="node  timer"></a>node  timer</h2><p>setTimeout</p>
<p>setTimeout和setImmediate之间的区别</p>
<p>在这一点上，您可能一直想知道没有第二个参数的setTimeout和setImmediate之间有什么区别。</p>
<p>答案：</p>
<p>setImmediate和setTimeout（延迟为0ms）都在下一个事件循环迭代之前运行代码。 但是，有一个要考虑的重点：</p>
<p>setImmediate的优先级高于setTimeout。</p>
<h2 id="node-pending-callbacks"><a href="#node-pending-callbacks" class="headerlink" title="node  pending callbacks"></a>node  pending callbacks</h2><h2 id="node-idle-prepare"><a href="#node-idle-prepare" class="headerlink" title="node idle prepare"></a>node idle prepare</h2><h2 id="process-nextTick"><a href="#process-nextTick" class="headerlink" title="process.nextTick"></a>process.nextTick</h2><p>在事件循环的每个阶段执行之后，并且在开始事件循环的下一阶段之前，将执行nextTickQueue，但正式地它不是事件循环的一部分</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/03/04/JavaScript-new-features-in-ES2019-ES10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/04/JavaScript-new-features-in-ES2019-ES10/" itemprop="url">JavaScript new features in ES2019(ES10)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-04T09:10:39+08:00">
                2020-03-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-Array-prototype-flat-depth"><a href="#1-Array-prototype-flat-depth" class="headerlink" title="1. Array.prototype.flat(depth)"></a>1. Array.prototype.flat(depth)</h2><ol>
<li>指定深度 拍平</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> array1 = [<span class="string">'a'</span>,<span class="string">'b'</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]];</span><br><span class="line"><span class="keyword">let</span> array2 = array1.flat();</span><br><span class="line"></span><br><span class="line"><span class="comment">//['a', 'b', 1, 2, 3]</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>过滤空元素</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> array1 = [<span class="string">'a'</span>, <span class="string">'b'</span>, , , , <span class="string">'c'</span>];</span><br><span class="line"><span class="keyword">let</span> array2 = array1.flat();</span><br><span class="line"><span class="comment">// ['a','b','c']</span></span><br></pre></td></tr></table></figure>
<h2 id="2-Array-prototype-flatMap"><a href="#2-Array-prototype-flatMap" class="headerlink" title="2. Array.prototype.flatMap"></a>2. Array.prototype.flatMap</h2><ol>
<li>自动拍平深度默认是1  用map方法遍历所有元素  返回一个新数组</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">arr1.map(<span class="function"><span class="params">x</span> =&gt;</span> [x * <span class="number">2</span>]); </span><br><span class="line"><span class="comment">// [[2], [4], [6], [8]]</span></span><br><span class="line"></span><br><span class="line">arr1.flatMap(<span class="function"><span class="params">x</span> =&gt;</span> [x * <span class="number">2</span>]);</span><br><span class="line"><span class="comment">// [2, 4, 6, 8]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// only one level is flattened</span></span><br><span class="line">arr1.flatMap(<span class="function"><span class="params">x</span> =&gt;</span> [[x * <span class="number">2</span>]]);</span><br><span class="line"><span class="comment">// [[2], [4], [6], [8]]</span></span><br></pre></td></tr></table></figure>
<h2 id="3-Object-fromEntries"><a href="#3-Object-fromEntries" class="headerlink" title="3. Object.fromEntries()"></a>3. Object.fromEntries()</h2><ol>
<li>转为 key-value对 放到一个数组中 参数对象必须是可迭代的</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> entries = <span class="built_in">Object</span>.entries(obj);</span><br><span class="line"></span><br><span class="line"><span class="comment">// entries</span></span><br><span class="line">(<span class="number">3</span>) [<span class="built_in">Array</span>(<span class="number">2</span>), <span class="built_in">Array</span>(<span class="number">2</span>), <span class="built_in">Array</span>(<span class="number">2</span>)]</span><br><span class="line"><span class="number">0</span>: (<span class="number">2</span>) [<span class="string">"a"</span>, <span class="number">1</span>]</span><br><span class="line"><span class="number">1</span>: (<span class="number">2</span>) [<span class="string">"b"</span>, <span class="number">2</span>]</span><br><span class="line"><span class="number">2</span>: (<span class="number">2</span>) [<span class="string">"c"</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj2 = <span class="built_in">Object</span>.fromEntries(entries)</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123;a: 1, b: 2, c: 3&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="4-String-trimStart-amp-String-trimEnd"><a href="#4-String-trimStart-amp-String-trimEnd" class="headerlink" title="4. String.trimStart() &amp; String.trimEnd()"></a>4. String.trimStart() &amp; String.trimEnd()</h2><ol>
<li>去掉头部或尾部的空格</li>
</ol>
<h2 id="5-Optional-Catch-Binding"><a href="#5-Optional-Catch-Binding" class="headerlink" title="5. Optional Catch Binding"></a>5. Optional Catch Binding</h2><p>catch 本来需要提供error参数 现在不需要了</p>
<p>Without optional catch binding:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="comment">// we have error parameter to handle it</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>With optional catch binding:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="comment">// no binding or parameter to handle it</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-Function-“toString”-Revision"><a href="#6-Function-“toString”-Revision" class="headerlink" title="6. Function “toString” Revision"></a>6. Function “toString” Revision</h2><p>Now the toString method must return source text slice from the beginning of the first token to end of the<br>last token matched by the appropriate grammar</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> /* <span class="title">kk</span>*/ <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* cc */</span> &#125;</span><br><span class="line"><span class="comment">// before:</span></span><br><span class="line">foo.toString();</span><br><span class="line"><span class="comment">// "function foo() &#123;&#125;"</span></span><br><span class="line"><span class="comment">// Now:</span></span><br><span class="line">foo.toString();</span><br><span class="line"><span class="comment">//"function /* kk*/ foo() &#123; /* cc */ &#125;"</span></span><br></pre></td></tr></table></figure>
<h3 id="7-Array-Sort-Stability"><a href="#7-Array-Sort-Stability" class="headerlink" title="7.Array.Sort Stability"></a>7.Array.Sort Stability</h3><p>V8中数组排序使用的不稳定快排算法 如果数组的元素多余10个的时候</p>
<p>v8(chrome&gt;=70) 使用了 稳定 TimeSort 算法</p>
<h2 id="8-Symbol-description"><a href="#8-Symbol-description" class="headerlink" title="8. Symbol.description"></a>8. Symbol.description</h2><p>获得一个Symbol的描述</p>
<p>before</p>
<p>const symbol1 = Symbol(‘my symbol’);<br>console.log(symbol1.toString());//Symbol(my symbol)</p>
<p>Now:</p>
<p>const symbol1 = Symbol(‘my symbol’);<br>console.log(symbol1)<br>console.log(String(symbol1) === <code>Symbol(${&#39;my symbol&#39;})</code>);<br>console.log(symbol1.description);<br>console.log(String(symbol1))</p>
<p>// Symbol(my symbol)<br>// true<br>// my symbol<br>// Symbol(my symbol)</p>
<h2 id="9-私有类变量"><a href="#9-私有类变量" class="headerlink" title="9. 私有类变量"></a>9. 私有类变量</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  #born = 1980</span><br><span class="line">  age() &#123; console.log(2020 - this.#born) &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line">person1.age() <span class="comment">// 40</span></span><br><span class="line">console.log(person1.#age)</span><br><span class="line"></span><br><span class="line"><span class="comment">//Uncaught SyntaxError: Private field '#age' must be declared in an     </span></span><br><span class="line"><span class="comment">//enclosing class</span></span><br></pre></td></tr></table></figure>
<h2 id="10-Promise-allSettled"><a href="#10-Promise-allSettled" class="headerlink" title="10. Promise.allSettled"></a>10. Promise.allSettled</h2><p>静态方法 all race allsettled</p>
<p>all race 只有一个rejected 就会终止  短回路</p>
<p>allsettled 不会因为任何一个 一定是等待所有 settled 后 </p>
<p>Promise.allSettled does not short-circuit added in ES2020</p>
<p>Promise.all short-circuits when an input value is rejected added in ES6</p>
<p>Promise.race short-circuits when an input value is settled added in ES6</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promiseOne = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span></span><br><span class="line">                       setTimeout(resolve, <span class="number">300</span>));</span><br><span class="line"><span class="keyword">const</span> promiseTwo = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span></span><br><span class="line">                       setTimeout(reject, <span class="number">300</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.allSettled([promiseOne, promiseTwo]).then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'data'</span>, data));</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([promiseOne, promiseTwo]).then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'data'</span>, data), error =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'error'</span>, error)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.race([promiseOne, promiseTwo]).then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'data'</span>, data), error =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'error'</span>, error)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="11-String-prototype-matchAll"><a href="#11-String-prototype-matchAll" class="headerlink" title="11. String.prototype.matchAll"></a>11. String.prototype.matchAll</h2><p>给定一个字符串和一个正则表达式，matchAll（）方法返回一个与正则表达式匹配字符串的所有结果的迭代器，包括捕获组</p>
<p>Syntax: str.matchAll(regexp)</p>
<p>regexp: A regular expression object</p>
<p>Return value: An iterator (which is not a restartable iterable)</p>
<p>Capture groups are ignored when using match() with the global /g flag</p>
<p>const regexp = /g(ro)(up(\d?))/g;<br>const groups = ‘group1group2group3’;<br>groups.match(regexp);<br>//(3) [“group1”, “group2”, “group3”]<br>//0: “group1”<br>//1: “group2”<br>//2: “group3”</p>
<p>Using matchAll, you can access capture groups</p>
<p>const regexp = /g(ro)(up(\d?))/g;<br>const someString = ‘group1group2group3’;<br>const array = […someString.matchAll(regexp)];<br>array<br>//(3) [Array(4), Array(4), Array(4)]<br>//0: (4) [“group1”, “ro”, “up1”, “1”, index: 0, input: //“group1group2group3”, groups: undefined]<br>//1: (4) [“group2”, “ro”, “up2”, “2”, index: 6, input: //“group1group2group3”, groups: undefined]<br>//2: (4) [“group3”, “ro”, “up3”, “3”, index: 12, input: //“group1group2group3”, groups: undefined]<br>//length: 3</p>
<h2 id="12-Optional-Chaining-Operator"><a href="#12-Optional-Chaining-Operator" class="headerlink" title="12. Optional Chaining Operator ?."></a>12. Optional Chaining Operator ?.</h2><p>对象 数组 函数调用</p>
<p>let consumption = car?.engine?.consumption</p>
<p>let car1 = array?.[1]</p>
<h2 id="13-Dynamic-Import"><a href="#13-Dynamic-Import" class="headerlink" title="13. Dynamic Import"></a>13. Dynamic Import</h2><p>动态import（）引入了一种类似于函数的新导入形式，与静态导入相比，它可以释放新功能，例如：我们可以与延迟加载一起使用</p>
<p>//greetingsModule.js<br>export hello () =&gt; console.log(“Hello World!”);</p>
<p>静态引入</p>
<p>//main.js<br>import * as greet from ‘./ greetingsModule.js’;<br>greet.hello();<br>//Hello World!</p>
<p>静态导入语法只能在文件的顶层使用</p>
<p>相反，使用动态导入，import（module）表达式将加载模块并返回一个promise</p>
<p>该promise将解析为包含其所有导出内容的模块对象</p>
<p>另外，您可以在代码中的任何位置调用它</p>
<p>…<br>if( 1 === 1){<br>import(’./greetingsModule.js’).then( (greet) =&gt; {<br>             greet.hello();<br>            // Hello World!<br>         });<br>}<br>…</p>
<p>Or you can use async/await:</p>
<p>…<br>async function load() {<br>    let greet = await import(’./greetingsModule.js’);<br>    greet.hello();<br>    // Hello!<br>  }<br>…</p>
<p>静态导入和动态导入()都很有用。</p>
<p>每个都有自己的用例</p>
<p>使用静态导入，例如初始依赖项</p>
<p>在其他情况下，考虑使用动态导入特性按需加载依赖项</p>
<h2 id="BigInt"><a href="#BigInt" class="headerlink" title="BigInt"></a>BigInt</h2><p>JavaScripts Number对固定范围的数字有严格的限制，并且不能正确操作大整数。 </p>
<p>BigInt的新功能解决了这个问题，这在处理大价值的不同领域可能是一个相当大的问题。</p>
<p>BigInt是任意长度的整数。 现在，这种类型的变量可以包含253个数字字符，并且不限于数字值</p>
<p>我们可以使用新的BigInt数据类型解决此问题。 在数字末尾添加字母“ n”</p>
<p>const myBigNumber = 9007199254740991n;<br>console.log(myBigNumber +1n);<br>//9007199254740992n  -&gt; Correct value!<br>console.log(myBigNumber +10n);<br>//9007199254741001n  -&gt; Correct value!<br>//Note:<br>console.log(myBigNumber +10);<br>//Error: you cannot mix BigInt and other types, use explicit //conversions.<br>//Correct way: You have to add the letter ‘n’ on the end of the //number</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/03/03/chrome-devtool-tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/03/chrome-devtool-tips/" itemprop="url">chrome devtool tips</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-03T09:03:18+08:00">
                2020-03-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="console使用类css选择器"><a href="#console使用类css选择器" class="headerlink" title="console使用类css选择器"></a>console使用类css选择器</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'tagName'</span>) /$(<span class="string">'.class'</span>)/ $(<span class="string">'#id'</span>) 还是 $(<span class="string">'.class #id'</span>) 等类似的选择器</span><br><span class="line">都相当于原生JS的<span class="built_in">document</span>.querySelector(<span class="string">''</span>) 方法</span><br><span class="line">这个方法返回第一个匹配选择规则的DOM元素</span><br><span class="line"></span><br><span class="line">$$(<span class="string">'tagName'</span>) 或者 $$(<span class="string">'.className'</span>) 记得是两个$$符号来选择所有匹配规则的DOM元素</span><br><span class="line">选择返回的结果是一个数组，可以通过数组的方法来访问其中的单个元素</span><br><span class="line">都相当于原生JS的<span class="built_in">document</span>.querySelectorAll(<span class="string">''</span>) 方法</span><br></pre></td></tr></table></figure>
<h2 id="获取某个DOM元素绑定的事件"><a href="#获取某个DOM元素绑定的事件" class="headerlink" title="获取某个DOM元素绑定的事件"></a>获取某个DOM元素绑定的事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getEventListeners($(<span class="string">'selector'</span>))方法以数组对象的格式返回某个元素绑定的所有事件</span><br><span class="line">你可以在控制台里展开对象查看详细的内容</span><br><span class="line"></span><br><span class="line">要是你需要选择其中的某个事件，可以通过下面的方法来访问：</span><br><span class="line"></span><br><span class="line">getEventListeners($(<span class="string">'selector'</span>)).eventName[<span class="number">0</span>].listener</span><br><span class="line">这里的 eventName 表示某种事件类型，例如：</span><br><span class="line"></span><br><span class="line">getEventListeners($(<span class="string">'#firstName'</span>)).click[<span class="number">0</span>].listener</span><br></pre></td></tr></table></figure>
<h2 id="获取监测事件"><a href="#获取监测事件" class="headerlink" title="获取监测事件"></a>获取监测事件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">monitorEvents($(<span class="string">'selector'</span>)) 会监测某个元素上绑定的所有事件</span><br><span class="line">一旦该元素的某个事件被触发就会在控制台里显示出来。</span><br><span class="line">monitorEvents($(<span class="string">'selector'</span>),<span class="string">'eventName'</span>) 可以监听某个元素上绑定的具体事件</span><br><span class="line">第二个参数代表事件类型的名称。例如 monitorEvents($(<span class="string">'#firstName'</span>),<span class="string">'click'</span>) </span><br><span class="line">只监测ID为firstName的元素上的click事件</span><br><span class="line"></span><br><span class="line">monitorEvents($(<span class="string">'selector'</span>),[<span class="string">'eventName1'</span>,<span class="string">'eventName3'</span>,….]) 同上</span><br><span class="line">可以同时检测具体指定的多个事件类型</span><br><span class="line"></span><br><span class="line">unmonitorEvents($(<span class="string">'selector'</span>)) 用来停止对某个元素的事件监测</span><br></pre></td></tr></table></figure>
<h2 id="通过控制台方法来检查元素"><a href="#通过控制台方法来检查元素" class="headerlink" title="通过控制台方法来检查元素"></a>通过控制台方法来检查元素</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inspect($(<span class="string">'selector'</span>)) 会检查所有匹配选择器的DOM元素，并返回所有选择器选择的DOM对象</span><br><span class="line">例如inspect($(<span class="string">'#firstName'</span>)) 选择所有ID是 firstName 的元素，inspect($(<span class="string">'a'</span>)[<span class="number">3</span>]) 检查并返回页面上第四个 p元素</span><br></pre></td></tr></table></figure>
<h2 id="列出某个元素的所有属性"><a href="#列出某个元素的所有属性" class="headerlink" title="列出某个元素的所有属性"></a>列出某个元素的所有属性</h2><p>你也可以通过控制台列出某个元素的所有属性<br>dir($(‘selector’)) 会返回匹配选择器的DOM元素的所有属性</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/02/28/preventDefault-vs-stopPropagation-vs-stopImmediatePropagation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/28/preventDefault-vs-stopPropagation-vs-stopImmediatePropagation/" itemprop="url">preventDefault vs. stopPropagation vs. stopImmediatePropagation</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-02-28T08:37:30+08:00">
                2020-02-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="preventDefault-vs-stopPropagation-vs-stopImmediatePropagation"><a href="#preventDefault-vs-stopPropagation-vs-stopImmediatePropagation" class="headerlink" title="preventDefault vs. stopPropagation vs. stopImmediatePropagation"></a>preventDefault vs. stopPropagation vs. stopImmediatePropagation</h2><ol>
<li>什么是事件冒泡和事件捕获</li>
</ol>
<p>事件冒泡和事件捕获是事件（例如，点击事件，键事件等）在DOM结构中移动的不同方式</p>
<p>为了理解这一点，让我们考虑以下HTML元素伪代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"parent"</span> (onClick)=<span class="string">"console.log('parent')"</span>&gt;</span><br><span class="line">    &lt;button <span class="class"><span class="keyword">class</span></span>=<span class="string">"child"</span> (onClick)=<span class="string">"console.log('child')"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>事件捕获意味着当我们单击按钮时，单击事件将从顶部开始并移至子级。 结果，单击按钮将打印  parent  —&gt; child</p>
<p>事件冒泡与事件捕获相反。在事件冒泡时，事件将从子元素开始并向上移动到父元素。因此，单击按钮将打印 child  —&gt; parent</p>
<p>理解了事件冒泡和事件捕获之后，我们就可以了解</p>
<p>preventDefault（）</p>
<p>stopPropagation（）</p>
<p>stopImmediatePropagation（）</p>
<h2 id="event-preventDefault"><a href="#event-preventDefault" class="headerlink" title="event.preventDefault()"></a>event.preventDefault()</h2><p>此方法用于在执行操作时停止浏览器的默认行为。<br>以下是默认行为的一些示例：</p>
<p>单击复选框/选中的选中/取消选中复选框</p>
<p>单击输入/文本区域字段将使输入聚焦并将光标置于输入元素中</p>
<p>W3C的方法是e.preventDefault()，IE则是使用e.returnValue = false<br>preventDefault是事件对象Event的一个方法，作用是取消一个目标元素的默认行为</p>
<p>return false:<br>JS的return false只会阻止默认行为，而jQuery则既阻止默认行为又防止对象冒泡<br>阻止浏览器默认行为兼容：</p>
<p>function stopDefault(e) {<br>    var e = e || window.event;<br>    if (e &amp;&amp; e.preventDefault){<br>        e.preventDefault();<br>    }else{<br>        e.returnValue = false;<br>    }<br>    return false;<br>}</p>
<h2 id="event-stopPropagation"><a href="#event-stopPropagation" class="headerlink" title="event.stopPropagation()"></a>event.stopPropagation()</h2><p>此方法用于防止在浏览器中事件流的捕获/冒泡阶段中定义的事件传播</p>
<p>W3C的方法是e.stopPropagation()，IE则是使用e.cancelBubble = true<br>stopPropagation是事件对象Event的一个方法，作用是阻止目标元素的冒泡事件，但是不会阻止默认行为<br>什么是冒泡事件？如在一个按钮是绑定一个click事件，那么click事件会依次在它的父级元素中被触发<br>stopPropagation就是阻止目标元素的事件冒泡到父级元素</p>
<h2 id="event-stopImmediatePropagation"><a href="#event-stopImmediatePropagation" class="headerlink" title="event.stopImmediatePropagation()"></a>event.stopImmediatePropagation()</h2><p>使用stopImmediatePropagation（）以及事件传播，也将阻止其他事件处理程序的执行。</p>
<p>结果，单击div元素将：</p>
<p>防止事件冒泡到父元素</p>
<p>阻止执行附加到该元素的任何其他事件侦听器</p>
<p>stopImmediatePropagation = stopPropagation + (other event listeners removed)</p>
<h2 id="e的兼容"><a href="#e的兼容" class="headerlink" title="e的兼容"></a>e的兼容</h2><p>function fn(e){<br>    var event = e || window.event;<br>}<br>FireFox里的Event跟IE里的不同，IE里的是全局变量，随时可用。<br>FireFox里的要用参数引导才能用，是运行时的临时变量<br>在IE/Opera中是window.event，在FireFox中是event。而事件的对象<br>在IE中是window.event.srcElement，在Firefox中是event.target，Opera中两者都可用</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/01/22/js2020/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/22/js2020/" itemprop="url">js2020</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-22T16:53:03+08:00">
                2020-01-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>? 可选链</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">obj?.prop       <span class="comment">// optional static property access</span></span><br><span class="line">obj?.[expr]     <span class="comment">// optional dynamic property access</span></span><br><span class="line">func?.(...args) <span class="comment">// optional function or method call</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li><p>空值合并运算符（??）是一个逻辑运算符</p>
<p> 当左侧操作数为 null 或 undefined 时，其返回右侧的操作数。否则返回左侧的操作数</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = <span class="literal">null</span> ?? <span class="string">'default string'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(foo);</span><br><span class="line"><span class="comment">// expected output: "default string"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baz = <span class="number">0</span> ?? <span class="number">42</span>;</span><br><span class="line"><span class="built_in">console</span>.log(baz);</span><br><span class="line"><span class="comment">// expected output: 0</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>globalThis</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getGlobal = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> self !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> self; &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> <span class="built_in">window</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> global !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> global; &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'no global object found'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> globals = getGlobal()</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Nullish coalescing ??</li>
</ol>
<p>If the property is null or undefined, then the right-side expression is returned;<br>f not, then it ignores if it is evaluated as falsy or truthy and returns it.</p>
<p><code>`</code>javascript<br>const response = {<br>  settings: {<br>    nullValue: null,<br>    height: 400,<br>    animationDuration: 0,<br>    headerText: ‘’,<br>    showSplashScreen: false<br>  }<br>};</p>
<p>const undefinedValue = response.settings.undefinedValue ?? ‘some other default’; // result: ‘some other default’<br><code>`</code>javascript</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/01/22/你必须理解14个JS函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/22/你必须理解14个JS函数/" itemprop="url">你必须理解14个JS函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-22T10:47:15+08:00">
                2020-01-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>Determine the specific type of any object</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toRawType</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> _toString = <span class="built_in">Object</span>.prototype.toString;</span><br><span class="line">    <span class="keyword">let</span> str = _toString.call(obj);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str.slice(<span class="number">8</span>, <span class="number">-1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>Caching function calculation results</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cached</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// Create an object to store the results returned after each function execution.</span></span><br><span class="line">  <span class="keyword">const</span> cache = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Returns the wrapped function</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">cachedFn</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If the cache is not hit, the function will be executed</span></span><br><span class="line">    <span class="keyword">if</span> ( !cache[str] ) &#123;</span><br><span class="line">        <span class="keyword">let</span> result = fn(str);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Store the result of the function execution in the cache</span></span><br><span class="line">        cache[str] = result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cache[str]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Implement Array.prototype.map</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="keyword">const</span> selfMap = <span class="function"><span class="keyword">function</span> (<span class="params">fn, context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">Array</span>.prototype.slice.call(<span class="keyword">this</span>)</span><br><span class="line">    <span class="keyword">let</span> mappedArr = <span class="built_in">Array</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!arr.hasOwnProperty(i)) <span class="keyword">continue</span>;</span><br><span class="line">        mappedArr[i] = fn.call(context, arr[i], i, <span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mappedArr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Array.prototype.selfMap = selfMap;</p>
<ol start="4">
<li>Implement Array.prototype.filter</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> selfFilter = <span class="function"><span class="keyword">function</span> (<span class="params">fn, context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">Array</span>.prototype.slice.call(<span class="keyword">this</span>)</span><br><span class="line">    <span class="keyword">let</span> filteredArr = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!arr.hasOwnProperty(i)) <span class="keyword">continue</span>;</span><br><span class="line">         fn.call(context, arr[i], i, <span class="keyword">this</span>) &amp;&amp; filteredArr.push(arr[i])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> filteredArr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.selfFilter = selfFilter;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>Implement Array.prototype.some</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> selfSome = <span class="function"><span class="keyword">function</span> (<span class="params">fn, context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">Array</span>.prototype.slice.call(<span class="keyword">this</span>)</span><br><span class="line">    <span class="keyword">if</span>(!arr.length) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!arr.hasOwnProperty(i)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">let</span> res = fn.call(context,arr[i],i,<span class="keyword">this</span>)</span><br><span class="line">        <span class="keyword">if</span>(res)<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.selfSome = selfSome;</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>Implement Array.prototype.reduce</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> selfReduce = <span class="function"><span class="keyword">function</span> (<span class="params">fn, initialValue</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">Array</span>.prototype.slice.call(<span class="keyword">this</span>)</span><br><span class="line">    <span class="keyword">let</span> res</span><br><span class="line">    <span class="keyword">let</span> startIndex</span><br><span class="line">    <span class="keyword">if</span> (initialValue === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!arr.hasOwnProperty(i)) <span class="keyword">continue</span></span><br><span class="line">            startIndex = i</span><br><span class="line">            res = arr[i]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res = initialValue</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = ++startIndex || <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!arr.hasOwnProperty(i)) <span class="keyword">continue</span></span><br><span class="line">        res = fn.call(<span class="literal">null</span>, res, arr[i], i, <span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.selfReduce = selfReduce;</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>Implement Array.prototype.flat</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> selfFlat = <span class="function"><span class="keyword">function</span> (<span class="params">depth = <span class="number">1</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">Array</span>.prototype.slice.call(<span class="keyword">this</span>)</span><br><span class="line">    <span class="keyword">if</span> (depth === <span class="number">0</span>) <span class="keyword">return</span> arr</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(<span class="function">(<span class="params">pre, cur</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(cur)) &#123;</span><br><span class="line">            <span class="keyword">return</span> [...pre, ...selfFlat.call(cur, depth - <span class="number">1</span>)]</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> [...pre, cur]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, [])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.selfFlat = selfFlat;</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>Currying</li>
</ol>
<p>柯里化是一种将具有多个参数的函数评估为具有单个参数的函数序列的技术  </p>
<p>换句话说，当一个函数不是一次获取所有参数，而是获取第一个参数并返回一个新函数，<br>这个新函数获取第二个参数并返回一个新函数，这个新函数获取第三个参数，以此类推，直到所有参数都被满足  </p>
<p>优点:</p>
<pre><code>1. 有助于您避免一次又一次地传递相同的变量

2. 它有助于创建高阶函数。它对事件处理非常有帮助

3. 可以轻松地配置和重用
</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a,b,c</span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) --&gt; <span class="number">6</span> </span><br><span class="line">add(<span class="number">1</span>,<span class="number">2</span>) --&gt; <span class="literal">NaN</span></span><br><span class="line">add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>) --&gt; <span class="number">6</span> <span class="comment">//Extra parameters will be ignored.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 形参 0 1</span></span><br><span class="line">    <span class="keyword">if</span> (fn.length &lt;= <span class="number">1</span>) <span class="keyword">return</span> fn;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> generator = <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 形参 = 实参</span></span><br><span class="line">        <span class="keyword">if</span> (fn.length === args.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> fn(...args)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 形参 != 实参</span></span><br><span class="line">            <span class="keyword">return</span> <span class="function">(<span class="params">...args2</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> generator(...args, ...args2)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> generator</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="9">
<li><p>Debouncing 防抖</p>
<p> 防抖只是为了减少不必要的耗时计算，从而提高浏览器的性能。在某些场景中，某些功能需要更多时间来执行某个操作。例如，以电子商务网站的搜索栏为例</p>
<p> 例如在搜索栏输入 “Tutorix study kit, 每输入一个字符就会调用api</p>
<p> 会调用17次api 如果人数多 会造成服务器性能降低</p>
<p> 在这个场景中，防抖将设置两个击键之间的时间间隔(假设为2秒)。</p>
<p> 如果两次击键之间的时间超过2秒，那么只会发生Api调用。</p>
<p> 在这两秒中，用户可以至少输入一些字符，从而减少这些字符的Api调用。</p>
<p> 由于Api调用减少了，浏览器性能将得到提高。必须注意的是，每次击键都会更新deb函数</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> debounce = (func, time = <span class="number">17</span>, options = &#123;</span><br><span class="line">    leading: <span class="literal">true</span>,</span><br><span class="line">    context: <span class="literal">null</span></span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> timer;</span><br><span class="line">    <span class="keyword">const</span> _debounce = <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">            clearTimeout(timer)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (options.leading &amp;&amp; !timer) &#123;</span><br><span class="line">            timer = setTimeout(<span class="literal">null</span>, time)</span><br><span class="line">            func.apply(options.context, args)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                func.apply(options.context, args)</span><br><span class="line">                timer = <span class="literal">null</span></span><br><span class="line">            &#125;, time)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    _debounce.cancel = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        clearTimeout(timer)</span><br><span class="line">        timer = <span class="literal">null</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> _debounce</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol start="10">
<li><p>Throttling 节流</p>
<p>节流将改变功能，使其在一个时间间隔内最多可激发一次。 </p>
<p>例如，无论用户单击按钮多少次，节流将仅在1000毫秒内执行一次功能</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> throttle = (func, time = <span class="number">17</span>, options = &#123;</span><br><span class="line">    leading: <span class="literal">true</span>,</span><br><span class="line">    trailing: <span class="literal">false</span>,</span><br><span class="line">    context: <span class="literal">null</span></span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> previous = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">0</span>).getTime()</span><br><span class="line">    <span class="keyword">let</span> timer;</span><br><span class="line">    <span class="keyword">const</span> _throttle = <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!options.leading) &#123;</span><br><span class="line">            <span class="keyword">if</span> (timer) <span class="keyword">return</span></span><br><span class="line">            timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                timer = <span class="literal">null</span></span><br><span class="line">                func.apply(options.context, args)</span><br><span class="line">            &#125;, time)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (now - previous &gt; time) &#123;</span><br><span class="line">            func.apply(options.context, args)</span><br><span class="line">            previous = now</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (options.trailing) &#123;</span><br><span class="line">            clearTimeout(timer)</span><br><span class="line">            timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                func.apply(options.context, args)</span><br><span class="line">            &#125;, time)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    _throttle.cancel = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        previous = <span class="number">0</span>;</span><br><span class="line">        clearTimeout(timer);</span><br><span class="line">        timer = <span class="literal">null</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> _throttle</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol start="11">
<li>Lazy Load Images</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getBoundingClientRect</span></span><br><span class="line"><span class="keyword">let</span> imgList1 = [...document.querySelectorAll(<span class="string">".get_bounding_rect"</span>)]</span><br><span class="line"><span class="keyword">let</span> num = imgList1.length</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> lazyLoad1 = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> deleteIndexList = []</span><br><span class="line">        imgList1.forEach(<span class="function">(<span class="params">img,index</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> rect = img.getBoundingClientRect()</span><br><span class="line">            <span class="keyword">if</span> (rect.top &lt; <span class="built_in">window</span>.innerHeight) &#123;</span><br><span class="line">                img.src = img.dataset.src</span><br><span class="line">                <span class="comment">// Add picture to delete list after loading successfully</span></span><br><span class="line">                deleteIndexList.push(index)</span><br><span class="line">                count++</span><br><span class="line">                <span class="keyword">if</span> (count === num) &#123;</span><br><span class="line">                    <span class="comment">//When all pictures are loaded, unbind scroll event</span></span><br><span class="line">                    <span class="built_in">document</span>.removeEventListener(<span class="string">'scroll'</span>,lazyLoad1)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// Delete loaded pictures</span></span><br><span class="line">        imgList1 = imgList1.filter(<span class="function">(<span class="params">_,index</span>)=&gt;</span>!deleteIndexList.includes(index))</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<ol start="12">
<li>Array random disorder</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Randomly select one of all elements after the current element to exchange with the current element</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shuffle</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> randomIndex = i + <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (arr.length - i));</span><br><span class="line">        [arr[i], arr[randomIndex]] = [arr[randomIndex], arr[i]]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate a new array, randomly take an element from the original array and put it into the new array</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shuffle2</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> _arr = []</span><br><span class="line">    <span class="keyword">while</span> (arr.length) &#123;</span><br><span class="line">        <span class="keyword">let</span> randomIndex = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * (arr.length))</span><br><span class="line">        _arr.push(arr.splice(randomIndex, <span class="number">1</span>)[<span class="number">0</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _arr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="13">
<li>Singleton 单例模式</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">proxy</span>(<span class="params">func</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> instance;</span><br><span class="line">    <span class="keyword">let</span> handler = &#123;</span><br><span class="line">        construct(target, args) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!instance) &#123;</span><br><span class="line">                <span class="comment">// Create an instance if there is not exist</span></span><br><span class="line">                instance = <span class="built_in">Reflect</span>.construct(func,args)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> instance</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(func, handler)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// example</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> SingletonPerson = proxy(Person)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> SingletonPerson(<span class="string">'zhl'</span>, <span class="number">22</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> SingletonPerson(<span class="string">'cyw'</span>, <span class="number">22</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(person1 === person2) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<ol start="14">
<li>Implement JSON.stringfy</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> isString = <span class="function"><span class="params">value</span> =&gt;</span> <span class="keyword">typeof</span> value === <span class="string">'string'</span>;</span><br><span class="line"><span class="keyword">const</span> isSymbol = <span class="function"><span class="params">value</span> =&gt;</span> <span class="keyword">typeof</span> value === <span class="string">'symbol'</span></span><br><span class="line"><span class="keyword">const</span> isUndefined = <span class="function"><span class="params">value</span> =&gt;</span> <span class="keyword">typeof</span> value === <span class="string">'undefined'</span></span><br><span class="line"><span class="keyword">const</span> isDate = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="built_in">Object</span>.prototype.toString.call(obj) === <span class="string">'[object Date]'</span></span><br><span class="line"><span class="keyword">const</span> isFunction = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="built_in">Object</span>.prototype.toString.call(obj) === <span class="string">'[object Function]'</span>;</span><br><span class="line"><span class="keyword">const</span> isComplexDataType = <span class="function"><span class="params">value</span> =&gt;</span> (<span class="keyword">typeof</span> value === <span class="string">'object'</span> || <span class="keyword">typeof</span> value === <span class="string">'function'</span>) &amp;&amp; value !== <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">const</span> isValidBasicDataType = <span class="function"><span class="params">value</span> =&gt;</span> value !== <span class="literal">undefined</span> &amp;&amp; !isSymbol(value); </span><br><span class="line"><span class="keyword">const</span> isValidObj = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="built_in">Array</span>.isArray(obj) || <span class="built_in">Object</span>.prototype.toString.call(obj) === <span class="string">'[object Object]'</span>;</span><br><span class="line"><span class="keyword">const</span> isInfinity = <span class="function"><span class="params">value</span> =&gt;</span> value === <span class="literal">Infinity</span> || value === -<span class="literal">Infinity</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Symbol,undefined,function in array will become null</span></span><br><span class="line"><span class="comment">// Infinity,NaN will also become null</span></span><br><span class="line"><span class="keyword">const</span> processSpecialValueInArray = <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    isSymbol(value) || isFunction(value) || isUndefined(value) || isInfinity(value) || <span class="built_in">isNaN</span>(value) ? <span class="literal">null</span> : value;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Handling property values according to JSON specification</span></span><br><span class="line"><span class="keyword">const</span> processValue = <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isInfinity(value) || <span class="built_in">isNaN</span>(value)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (isString(value)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`"<span class="subst">$&#123;value&#125;</span>"`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">&#125;;<span class="comment">// obj.loop = obj</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> jsonStringify = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Closure + WeakMap prevent circular references</span></span><br><span class="line">    <span class="keyword">let</span> wp = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//It is the function in the closure that recursively calls jsonstrify, not the jsonstrify function declared by const</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">jsonStringify</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (wp.get(obj)) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Converting circular structure to JSON'</span>);</span><br><span class="line">        <span class="keyword">let</span> res = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isComplexDataType(obj)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (obj.toJSON) <span class="keyword">return</span> obj.toJSON; </span><br><span class="line">            <span class="keyword">if</span> (!isValidObj(obj)) &#123; </span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            wp.set(obj, obj);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(obj)) &#123;</span><br><span class="line">                res += <span class="string">"["</span>;</span><br><span class="line">                <span class="keyword">let</span> temp = [];</span><br><span class="line">                obj.forEach(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">                    temp.push(</span><br><span class="line">                        isComplexDataType(value) &amp;&amp; !isFunction(value) ?</span><br><span class="line">                            jsonStringify(value) :</span><br><span class="line">                            <span class="string">`<span class="subst">$&#123;processSpecialValueInArray(value, <span class="literal">true</span>)&#125;</span>`</span></span><br><span class="line">                    )</span><br><span class="line">                &#125;);</span><br><span class="line">                res += <span class="string">`<span class="subst">$&#123;temp.join(<span class="string">','</span>)&#125;</span>]`</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res += <span class="string">"&#123;"</span>;</span><br><span class="line">                <span class="keyword">let</span> temp = [];</span><br><span class="line">                <span class="built_in">Object</span>.keys(obj).forEach(<span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (isComplexDataType(obj[key])) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (isValidObj(obj[key])) &#123;</span><br><span class="line">                            temp.push(<span class="string">`"<span class="subst">$&#123;key&#125;</span>":<span class="subst">$&#123;jsonStringify(obj[key])&#125;</span>`</span>)</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDate(obj[key])) &#123; </span><br><span class="line">                            temp.push(<span class="string">`"<span class="subst">$&#123;key&#125;</span>":"<span class="subst">$&#123;obj[key].toISOString()&#125;</span>"`</span>)</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isFunction(obj[key])) &#123; </span><br><span class="line">                            temp.push(<span class="string">`"<span class="subst">$&#123;key&#125;</span>":&#123;&#125;`</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isValidBasicDataType(obj[key])) &#123;</span><br><span class="line">                        temp.push(<span class="string">`"<span class="subst">$&#123;key&#125;</span>":<span class="subst">$&#123;processValue(obj[key])&#125;</span>`</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                res += <span class="string">`<span class="subst">$&#123;temp.join(<span class="string">','</span>)&#125;</span>&#125;`</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isSymbol(obj)) &#123; </span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> obj</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    &#125;&#125;)();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// example</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s = <span class="built_in">Symbol</span>(<span class="string">'s'</span>)</span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    str: <span class="string">"123"</span>,</span><br><span class="line">    arr: [<span class="number">1</span>, &#123;<span class="attr">e</span>: <span class="number">1</span>&#125;, s, () =&gt; &#123;</span><br><span class="line">    &#125;, <span class="literal">undefined</span>,<span class="literal">Infinity</span>,<span class="literal">NaN</span>],</span><br><span class="line">    obj: &#123;<span class="attr">a</span>: <span class="number">1</span>&#125;,</span><br><span class="line">    <span class="literal">Infinity</span>: -<span class="literal">Infinity</span>,</span><br><span class="line">    nan: <span class="literal">NaN</span>,</span><br><span class="line">    undef: <span class="literal">undefined</span>,</span><br><span class="line">    symbol: s,</span><br><span class="line">    date: <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">    reg: <span class="regexp">/123/g</span>,</span><br><span class="line">    func: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">    dom: <span class="built_in">document</span>.querySelector(<span class="string">'body'</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(jsonStringify(obj));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(obj));</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/01/06/Timing-breakdown-phases-explained/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/Timing-breakdown-phases-explained/" itemprop="url">Timing breakdown phases explained</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T16:23:21+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Queueing"><a href="#Queueing" class="headerlink" title="Queueing."></a>Queueing.</h2><p>The browser queues requests when:</p>
<ul>
<li><p>There are higher priority requests. 更高优先级的请求</p>
</li>
<li><p>There are already six TCP connections open for this origin, which is the limit. Applies to HTTP/1.0 and HTTP/1.1 only. 6个HTTP/1.0 和 HTTP/1.1</p>
</li>
<li><p>The browser is briefly allocating space in the disk cache 浏览器分配本地磁盘空间</p>
</li>
</ul>
<h2 id="Stalled"><a href="#Stalled" class="headerlink" title="Stalled."></a>Stalled.</h2><ul>
<li>The request could be stalled for any of the reasons described in Queueing. 被延迟的原因</li>
</ul>
<h2 id="DNS-Lookup"><a href="#DNS-Lookup" class="headerlink" title="DNS Lookup."></a>DNS Lookup.</h2><ul>
<li>The browser is resolving the request’s IP address. DNS解析时间</li>
</ul>
<h2 id="Proxy-negotiation"><a href="#Proxy-negotiation" class="headerlink" title="Proxy negotiation."></a>Proxy negotiation.</h2><ul>
<li>The browser is negotiating the request with a proxy server. 浏览器将请求发送代理服务器</li>
</ul>
<h2 id="Request-sent"><a href="#Request-sent" class="headerlink" title="Request sent."></a>Request sent.</h2><ul>
<li>The request is being sent. 请求被发送</li>
</ul>
<h2 id="ServiceWorker-Preparation"><a href="#ServiceWorker-Preparation" class="headerlink" title="ServiceWorker Preparation."></a>ServiceWorker Preparation.</h2><ul>
<li>The browser is starting up the service worker. 浏览器正在启动服务程序</li>
</ul>
<h2 id="Request-to-ServiceWorker"><a href="#Request-to-ServiceWorker" class="headerlink" title="Request to ServiceWorker."></a>Request to ServiceWorker.</h2><ul>
<li>The request is being sent to the service worker. 请求发送给服务程序</li>
</ul>
<h2 id="Waiting-TTFB"><a href="#Waiting-TTFB" class="headerlink" title="Waiting (TTFB)."></a>Waiting (TTFB).</h2><ul>
<li>The browser is waiting for the first byte of a response.  接收到第一个字节</li>
<li>TTFB stands for Time To First Byte.</li>
<li>This timing includes 1 round trip of latency and the time the server took to prepare the response. 一个来回延迟</li>
</ul>
<h2 id="Content-Download"><a href="#Content-Download" class="headerlink" title="Content Download."></a>Content Download.</h2><ul>
<li>The browser is receiving the response. 浏览器接受数据时间</li>
</ul>
<h2 id="Receiving-Push"><a href="#Receiving-Push" class="headerlink" title="Receiving Push."></a>Receiving Push.</h2><ul>
<li>The browser is receiving data for this response via HTTP/2 Server Push. 通过http2push方式接受的数据</li>
</ul>
<h2 id="Reading-Push"><a href="#Reading-Push" class="headerlink" title="Reading Push."></a>Reading Push.</h2><p>The browser is reading the local data previously received.  读取本地数据</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/01/06/dragimage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/dragimage/" itemprop="url">dragimage</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T08:53:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  #drop-region &#123;</span><br><span class="line">	background-color: #fff;</span><br><span class="line">	border-radius:<span class="number">20</span>px;</span><br><span class="line">	box-shadow:<span class="number">0</span> <span class="number">0</span> <span class="number">35</span>px rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.05</span>);</span><br><span class="line">	width:<span class="number">400</span>px;</span><br><span class="line">	padding:<span class="number">60</span>px <span class="number">40</span>px;</span><br><span class="line">	text-align: center;</span><br><span class="line">	cursor:pointer;</span><br><span class="line">	transition:<span class="number">.3</span>s;</span><br><span class="line">&#125;</span><br><span class="line">#drop-region:hover &#123;</span><br><span class="line">	box-shadow:<span class="number">0</span> <span class="number">0</span> <span class="number">45</span>px rgba(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#image-preview &#123;</span><br><span class="line">	margin-top:<span class="number">20</span>px;</span><br><span class="line">&#125;</span><br><span class="line">#image-preview .image-view &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">	position:relative;</span><br><span class="line">	margin-right: <span class="number">13</span>px;</span><br><span class="line">	margin-bottom: <span class="number">13</span>px;</span><br><span class="line">&#125;</span><br><span class="line">#image-preview .image-view img &#123;</span><br><span class="line">    max-width: <span class="number">100</span>px;</span><br><span class="line">    max-height: <span class="number">100</span>px;</span><br><span class="line">&#125;</span><br><span class="line">#image-preview .overlay &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    width: <span class="number">100</span>%;</span><br><span class="line">    height: <span class="number">100</span>%;</span><br><span class="line">    top: <span class="number">0</span>;</span><br><span class="line">    right: <span class="number">0</span>;</span><br><span class="line">    z-index: <span class="number">2</span>;</span><br><span class="line">    background: rgba(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp">&lt;body style="padding:100px;background-color:#fafafa;font-family: 'Segoe UI', sans-serif;"&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;div id="drop-region"&gt;</span></span><br><span class="line"><span class="regexp">	&lt;div class="drop-message"&gt;</span></span><br><span class="line"><span class="regexp">		Drag &amp; Drop images or click to upload</span></span><br><span class="line"><span class="regexp">	&lt;/</span>div&gt;</span><br><span class="line">	&lt;div id=<span class="string">"image-preview"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">let dropRegion = document.getElementById("drop-region"), /</span><span class="regexp">/ where files are dropped + file selector is opened</span></span><br><span class="line"><span class="regexp">	imagePreviewRegion = document.getElementById("image-preview"); 	/</span><span class="regexp">/ where images are previewed</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ open file selector when clicked on the drop region</span></span><br><span class="line"><span class="regexp">let fakeInput = document.createElement("input");</span></span><br><span class="line"><span class="regexp">fakeInput.type = "file";</span></span><br><span class="line"><span class="regexp">fakeInput.accept = "image/</span>*<span class="string">";</span></span><br><span class="line"><span class="string">fakeInput.multiple = true;</span></span><br><span class="line"><span class="string">dropRegion.addEventListener('click', function() &#123;</span></span><br><span class="line"><span class="string">	fakeInput.click();</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">fakeInput.addEventListener("</span>change<span class="string">", function() &#123;</span></span><br><span class="line"><span class="string">	let files = fakeInput.files;</span></span><br><span class="line"><span class="string">	handleFiles(files);</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">function preventDefault(e) &#123;</span></span><br><span class="line"><span class="string">	e.preventDefault();</span></span><br><span class="line"><span class="string">  	e.stopPropagation();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">dropRegion.addEventListener('dragenter', preventDefault, false)</span></span><br><span class="line"><span class="string">dropRegion.addEventListener('dragleave', preventDefault, false)</span></span><br><span class="line"><span class="string">dropRegion.addEventListener('dragover', preventDefault, false)</span></span><br><span class="line"><span class="string">dropRegion.addEventListener('drop', preventDefault, false)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">function handleDrop(e) &#123;</span></span><br><span class="line"><span class="string">	let dt = e.dataTransfer,</span></span><br><span class="line"><span class="string">		files = dt.files;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	if (files.length) &#123;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		handleFiles(files);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	&#125; else &#123;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		// check for img</span></span><br><span class="line"><span class="string">		let html = dt.getData('text/html'),</span></span><br><span class="line"><span class="string">	        match = html &amp;&amp; /\bsrc="</span>?([^<span class="string">"\s]+)"</span>?\s*<span class="regexp">/.exec(html),</span></span><br><span class="line"><span class="regexp">	        url = match &amp;&amp; match[1];</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">	    if (url) &#123;</span></span><br><span class="line"><span class="regexp">	        uploadImageFromURL(url);</span></span><br><span class="line"><span class="regexp">	        return;</span></span><br><span class="line"><span class="regexp">	    &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">	function uploadImageFromURL(url) &#123;</span></span><br><span class="line"><span class="regexp">		var img = new Image;</span></span><br><span class="line"><span class="regexp">        var c = document.createElement("canvas");</span></span><br><span class="line"><span class="regexp">        var ctx = c.getContext("2d");</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        img.onload = function() &#123;</span></span><br><span class="line"><span class="regexp">            c.width = this.naturalWidth;     /</span><span class="regexp">/ update canvas size to match image</span></span><br><span class="line"><span class="regexp">            c.height = this.naturalHeight;</span></span><br><span class="line"><span class="regexp">            ctx.drawImage(this, 0, 0);       /</span><span class="regexp">/ draw in image</span></span><br><span class="line"><span class="regexp">            c.toBlob(function(blob) &#123;        /</span><span class="regexp">/ get content as PNG blob</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">            	/</span><span class="regexp">/ call our main function</span></span><br><span class="line"><span class="regexp">                handleFiles( [blob] );</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">            &#125;, "image/</span>png<span class="string">");</span></span><br><span class="line"><span class="string">        &#125;;</span></span><br><span class="line"><span class="string">        img.onerror = function() &#123;</span></span><br><span class="line"><span class="string">            alert("</span><span class="built_in">Error</span> <span class="keyword">in</span> uploading<span class="string">");</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        img.crossOrigin = "</span><span class="string">";              // if from different origin</span></span><br><span class="line"><span class="string">        img.src = url;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">dropRegion.addEventListener('drop', handleDrop, false);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">function handleFiles(files) &#123;</span></span><br><span class="line"><span class="string">	for (var i = 0, len = files.length; i &lt; len; i++) &#123;</span></span><br><span class="line"><span class="string">		if (validateImage(files[i]))</span></span><br><span class="line"><span class="string">			previewAnduploadImage(files[i]);</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">function validateImage(image) &#123;</span></span><br><span class="line"><span class="string">	// check the type</span></span><br><span class="line"><span class="string">	var validTypes = ['image/jpeg', 'image/png', 'image/gif'];</span></span><br><span class="line"><span class="string">	if (validTypes.indexOf( image.type ) === -1) &#123;</span></span><br><span class="line"><span class="string">		alert("</span>Invalid File Type<span class="string">");</span></span><br><span class="line"><span class="string">		return false;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	// check the size</span></span><br><span class="line"><span class="string">	var maxSizeInBytes = 10 * 10e6; // 10MB</span></span><br><span class="line"><span class="string">	if (image.size &gt; maxSizeInBytes) &#123;</span></span><br><span class="line"><span class="string">		alert("</span>File too large<span class="string">");</span></span><br><span class="line"><span class="string">		return false;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	return true;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">function previewAnduploadImage(image) &#123;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	// container</span></span><br><span class="line"><span class="string">	var imgView = document.createElement("</span>div<span class="string">");</span></span><br><span class="line"><span class="string">	imgView.className = "</span>image-view<span class="string">";</span></span><br><span class="line"><span class="string">	imagePreviewRegion.appendChild(imgView);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	// previewing image</span></span><br><span class="line"><span class="string">	var img = document.createElement("</span>img<span class="string">");</span></span><br><span class="line"><span class="string">	imgView.appendChild(img);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	// progress overlay</span></span><br><span class="line"><span class="string">	var overlay = document.createElement("</span>div<span class="string">");</span></span><br><span class="line"><span class="string">	overlay.className = "</span>overlay<span class="string">";</span></span><br><span class="line"><span class="string">	imgView.appendChild(overlay);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	// read the image...</span></span><br><span class="line"><span class="string">	var reader = new FileReader();</span></span><br><span class="line"><span class="string">	reader.onload = function(e) &#123;</span></span><br><span class="line"><span class="string">		img.src = e.target.result;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">	reader.readAsDataURL(image);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	// create FormData</span></span><br><span class="line"><span class="string">	var formData = new FormData();</span></span><br><span class="line"><span class="string">	formData.append('image', image);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	// upload the image</span></span><br><span class="line"><span class="string">	var uploadLocation = 'https://api.imgbb.com/1/upload';</span></span><br><span class="line"><span class="string">	formData.append('key', 'bb63bee9d9846c8d5b7947bcdb4b3573');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	var ajax = new XMLHttpRequest();</span></span><br><span class="line"><span class="string">	ajax.open("</span>POST<span class="string">", uploadLocation, true);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	ajax.onreadystatechange = function(e) &#123;</span></span><br><span class="line"><span class="string">		if (ajax.readyState === 4) &#123;</span></span><br><span class="line"><span class="string">			if (ajax.status === 200) &#123;</span></span><br><span class="line"><span class="string">				// done!</span></span><br><span class="line"><span class="string">			&#125; else &#123;</span></span><br><span class="line"><span class="string">				// error!</span></span><br><span class="line"><span class="string">			&#125;</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	ajax.upload.onprogress = function(e) &#123;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		// change progress</span></span><br><span class="line"><span class="string">		// (reduce the width of overlay)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		var perc = (e.loaded / e.total * 100) || 100,</span></span><br><span class="line"><span class="string">			width = 100 - perc;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		overlay.style.width = width;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	ajax.send(formData);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">killsos.ql@gmail.com</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">130</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">killsos.ql@gmail.com</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
