<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="keywords" content="javascript 前端">
<meta property="og:type" content="website">
<meta property="og:title" content="killsos">
<meta property="og:url" content="http://jsonload.com/page/6/index.html">
<meta property="og:site_name" content="killsos">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="killsos">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://jsonload.com/page/6/">





  <title>killsos</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">killsos</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人情似水分高下 世事如云任卷舒</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/05/08/frontEnd-perform-parameter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/08/frontEnd-perform-parameter/" itemprop="url">frontEnd perform parameter</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-08T08:53:53+08:00">
                2020-05-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="FP"><a href="#FP" class="headerlink" title="FP"></a>FP</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FP，全称 First Paint，翻译为首次绘制,是时间线上的第一个时间点</span><br><span class="line"></span><br><span class="line">它代表网页的第一个像素渲染到屏幕上所用时间</span><br><span class="line"></span><br><span class="line">也就是页面在屏幕上首次发生视觉变化的时间</span><br><span class="line"></span><br><span class="line">performance.getEntriesByType(&apos;paint&apos;)</span><br><span class="line"></span><br><span class="line">function getFPTime()&#123;</span><br><span class="line">    const timings = performance.getEntriesByType(&apos;paint&apos;)[0];</span><br><span class="line">    return timings ? Math.round(timings.startTime) : null</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="FCP"><a href="#FCP" class="headerlink" title="FCP"></a>FCP</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">FCP，全称 First Contentful Paint，翻译为首次内容绘制，顾名思义，它代表浏览器第一次向屏幕绘内容。</span><br><span class="line"></span><br><span class="line">注意：只有首次绘制文本、图片（包含背景图）、非白色的canvas或SVG时才被算作 FCP</span><br><span class="line"></span><br><span class="line">通过performance.getEntriesByType(&apos;paint’)，取第二个pain的时间</span><br><span class="line">或者通过Mutation Observer观察到首次节点变动的时间</span><br><span class="line"></span><br><span class="line">const domEntries = []</span><br><span class="line">const observer = new MutationObserver((mutationsList)=&gt;&#123;</span><br><span class="line">    for(var mutation of mutationsList) &#123;</span><br><span class="line">        if (mutation.type == &apos;childList&apos;) &#123;</span><br><span class="line">            console.log(&apos;A child node has been added or removed.&apos;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (mutation.type == &apos;addedNodes&apos;) &#123;</span><br><span class="line">            //TODO新增了节点，做处理，计算此时的可见性/位置/出现时间等信息，然后 push 进数组</span><br><span class="line">            domEntries.push(mutation)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function getFPTime()&#123;</span><br><span class="line">    const timings = performance.getEntriesByType(&apos;paint&apos;);</span><br><span class="line">    if(timings.length &gt; 1)return timings[1]</span><br><span class="line">    return timings ? Math.round(timings.startTime) : null</span><br><span class="line">    //伪代码,算 DOM 变化时的最小那个时间，即节点首次变动的时间</span><br><span class="line">    return Math.round(domEntries.length ? Math.min(...domEntries.map(entry =&gt; entry.time)) : 0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FP与FCP这两个指标之间的主要区别是：</span><br><span class="line"></span><br><span class="line">FP是当浏览器开始绘制内容到屏幕上的时候，只要在视觉上开始发生变化，无论是什么内容触发的视觉变化，在这一刻，这个时间点，叫做FP。</span><br><span class="line"></span><br><span class="line">相比之下，FCP指的是浏览器首次绘制来自DOM的内容。例如：文本，图片，SVG，canvas元素等，这个时间点叫FCP。</span><br><span class="line"></span><br><span class="line">FP和FCP可能是相同的时间，也可能是先FP后FCP</span><br></pre></td></tr></table></figure>
<h2 id="MutationObserver"><a href="#MutationObserver" class="headerlink" title="MutationObserver"></a>MutationObserver</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">MutationObserver接口提供了监视对DOM树所做更改的能力</span><br><span class="line"></span><br><span class="line">它被设计为旧的Mutation Events功能的替代品，该功能是DOM3 Events规范的一部分</span><br><span class="line"></span><br><span class="line">MutationObserver()</span><br><span class="line">创建并返回一个新的 MutationObserver 它会在指定的DOM发生变化时被调用</span><br></pre></td></tr></table></figure>
<h2 id="FMP"><a href="#FMP" class="headerlink" title="FMP"></a>FMP</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FMP，全称 First Meaningful Paint，翻译为首次有意义的绘制</span><br><span class="line">是页面主要内容出现在屏幕上的时间, 这是用户感知加载体验的主要指标</span><br><span class="line">目前尚无标准化的定义, 因为很难以通用的方式去确定各种类型页面的关键内容</span><br><span class="line"></span><br><span class="line">目前没有统一逻辑，阿里有个标准为最高可见增量元素，采用深度优先遍历方法</span><br><span class="line">详细可见：https://zhuanlan.zhihu.com/p/44933789</span><br></pre></td></tr></table></figure>
<h2 id="FID"><a href="#FID" class="headerlink" title="FID"></a>FID</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">FID，全称 First Input Delay，翻译为首次输入延迟</span><br><span class="line">是测量用户首次与您的站点交互时的时间（即当他们单击链接/点击按钮/使用自定义的JavaScript驱动控件时）</span><br><span class="line">到浏览器实际能够回应这种互动的时间</span><br><span class="line"></span><br><span class="line">方式一，通过performanceObserver(目前支持性为88.78%)观察类型为first-input的entry，获得其startTime/duration等数即可</span><br><span class="line"></span><br><span class="line">方式二，初始化时为特定事件类型(click/touch/keydown)绑定通用统计逻辑事件</span><br><span class="line">开始调用时从event.timeStamp取开始处理的时间(这个时间就是首次输入延迟时间)</span><br><span class="line">在事件处理中注册requestIdleCallback事件回调onIdleCallback</span><br><span class="line">当onIdleCallback被执行时，当前时间减开始的event.timeStamp即为duration时间</span><br><span class="line"></span><br><span class="line">// 方式一</span><br><span class="line">function getFIDTime()&#123;</span><br><span class="line">    const timings = performance.getEntriesByType(&apos;first-input&apos;)[0];</span><br><span class="line">    return timings ? timings : null</span><br><span class="line">&#125;</span><br><span class="line">// 方式二，以下代码仅代表思路</span><br><span class="line"></span><br><span class="line">[&apos;click&apos;,&apos;touch&apos;,&apos;keydown&apos;].forEach(eventType =&gt; &#123;</span><br><span class="line">    window.addEventListener(eventType, eventHandle);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function eventHandle(e) &#123;</span><br><span class="line">    const eventTime = e.timeStamp;</span><br><span class="line">    window.requestIdleCallback(onIdleCallback.bind(this, eventTime, e));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function onIdleCallback(eventTime, e) &#123;</span><br><span class="line">    const now = window.performance.now();</span><br><span class="line">    const duration = now - eventTime;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        duration: Math.round(duration),</span><br><span class="line">        timestamp: Math.round(eventTime)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [&apos;click&apos;,&apos;touch&apos;,&apos;keydown&apos;].forEach(eventType =&gt; &#123;</span><br><span class="line">        window.removeEventListener(eventType, eventHandle);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="TTI"><a href="#TTI" class="headerlink" title="TTI"></a>TTI</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TTI，全称 Time To Interactive，翻译为可交互时间，指的是应用在视觉上都已渲染出了，完全可以响应用户的输入了</span><br><span class="line">是衡量应用加载所需时间并能够快速响应用户交互的指标</span><br><span class="line"></span><br><span class="line">统计方式一：谷歌实验室写的npm包，tti-polyfill</span><br></pre></td></tr></table></figure>
<h2 id="FCI"><a href="#FCI" class="headerlink" title="FCI"></a>FCI</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FCI，全称 First CPU Idle，翻译为首次CPU空闲时间代表着一个网页已经满足了最小程度的与用户发生交互行为的时刻</span><br><span class="line">当我们打开一个网页，我们并不需要等到一个网页完全加载好了</span><br><span class="line">每一个元素都已经完成了渲染，然后再去与网页进行交互行为</span><br><span class="line"></span><br><span class="line">网页满足了我们基本的交互的时间点是衡量网页性能的一个重要指标</span><br><span class="line"></span><br><span class="line">FCI为在FMP之后，首次在一定窗口时间内没有长任务发生的那一时刻，并且如果这个时间点早于DOMContentLoaded时间</span><br><span class="line">那么FCI的时间为DOMContentLoaded时间，窗口时间的计算函数</span><br><span class="line">可以根据Lighthouse提供的计算公式 N = f(t) = 4 * e^(-0.045 * t) + 1 进行自定义设计</span><br></pre></td></tr></table></figure>
<h2 id="FPS"><a href="#FPS" class="headerlink" title="FPS"></a>FPS</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">FPS，全称 Frames Per Second，翻译为每秒帧率，表示的是每秒钟画面更新次数，当今大多数设备的屏幕刷新率都是60次/秒</span><br><span class="line"></span><br><span class="line">帧率能够达到 50 ～ 60 FPS 的动画将会相当流畅，让人倍感舒适；</span><br><span class="line">帧率在 30 ～ 50 FPS 之间的动画，因各人敏感程度不同，舒适度因人而异；</span><br><span class="line">帧率在 30 FPS 以下的动画，让人感觉到明显的卡顿和不适感；</span><br><span class="line">帧率波动很大的动画，亦会使人感觉到卡顿</span><br><span class="line"></span><br><span class="line">利用requestAnimationFrame,循环调用，当now大于lastTime+1S时，计算FPS</span><br><span class="line"></span><br><span class="line">若小于某个阀值则可以认为当前帧率较差，若连续小于多个阀值，则停止统计，当前页面处于卡顿状态，进入卡顿处理逻辑</span><br></pre></td></tr></table></figure>
<h2 id="Blink-内核早期架构"><a href="#Blink-内核早期架构" class="headerlink" title="Blink 内核早期架构"></a>Blink 内核早期架构</h2><p><img src="../images/render-irender-image.jpg" alt="渲染"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">以 Chrome 浏览器内核 Blink 渲染页面为例</span><br><span class="line">对早期的 Chrome 浏览器而言，每个页面 Tab 对应一个独立的 renderer 进程</span><br><span class="line">Renderer 进程中包含了主线程和合成线程</span><br><span class="line"></span><br><span class="line">主线程主要负责：</span><br><span class="line"></span><br><span class="line">Javascript 的计算与执行</span><br><span class="line">CSS 样式计算</span><br><span class="line">Layout 计算</span><br><span class="line">将页面元素绘制成位图（paint），也就是光栅化（Raster）</span><br><span class="line">将位图给合成线程</span><br><span class="line">合成线程则主要负责：</span><br><span class="line"></span><br><span class="line">将位图(GraphicsLayer 层)以纹理(texture)的形式上传给 GPU</span><br><span class="line">计算页面的可见部分和即将可见部分（滚动）</span><br><span class="line">CSS 动画处理</span><br><span class="line">通知 GPU 绘制位图到屏幕上</span><br><span class="line"></span><br><span class="line">JS 动画与 CSS 动画的细微区别</span><br><span class="line"></span><br><span class="line">对于 JS 动画而言，它们运行时的帧率即是主线程和合成线程加起来消耗的时间</span><br><span class="line">对于流畅动画而言，我们希望它们每一帧的耗时保持在 16.67ms 之内;</span><br><span class="line"></span><br><span class="line">而对于 CSS 动画而言，由于其流程不受主线程的影响，所以希望能得到合成线程的消耗的时间</span><br><span class="line">而合成线程的绘制频率也反映了滚动和 CSS 动画的流程性。</span><br><span class="line"></span><br><span class="line">上面主要想得出的一个结论是。如果我们能够知道主线程和合成线程每一帧消耗的时间</span><br><span class="line">那么我们就能大致得出对应的 Web 动画的帧率</span><br><span class="line">那么上面说到的 Frame Timing API 是否可以帮助我们拿到这个时间点呢</span><br><span class="line"></span><br><span class="line">所以 JS动画 性能不如 CSS动画</span><br></pre></td></tr></table></figure>
<h2 id="Frame-Timing-API"><a href="#Frame-Timing-API" class="headerlink" title="Frame Timing API"></a>Frame Timing API</h2><p><img src="../images/Web-Performance-Timing-API.png" alt="性能"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">Frame Timing API 是 Web Performance Timing API 标准中的其中一位</span><br><span class="line"></span><br><span class="line">获取 Render 主线程和合成线程的记录，每条记录包含的信息</span><br><span class="line"></span><br><span class="line">var rendererEvents = window.performance.getEntriesByType(&quot;renderer&quot;);</span><br><span class="line">var compositeThreadEvents = window.performance.getEntriesByType(&quot;composite&quot;);</span><br><span class="line"></span><br><span class="line">或</span><br><span class="line"></span><br><span class="line">var observer = new PerformanceObserver(function(list) &#123;</span><br><span class="line">    var perfEntries = list.getEntries();</span><br><span class="line">    for (var i = 0; i &lt; perfEntries.length; i++) &#123;</span><br><span class="line">        console.log(&quot;frame: &quot;, perfEntries[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// subscribe to Frame Timing</span><br><span class="line">observer.observe(&#123;entryTypes: [&apos;frame&apos;]&#125;);</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  sourceFrameNumber: 120,</span><br><span class="line">  startTime: 1342.549374253</span><br><span class="line">  cpuTime: 6.454313323</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">window.requestAnimationFrame(callback);</span><br><span class="line"></span><br><span class="line">告诉浏览器您希望执行动画并请求浏览器调用指定的函数在下一次重绘之前更新动画。</span><br><span class="line"></span><br><span class="line">当你准备好更新屏幕画面时你就应用此方法。这会要求你的动画函数在浏览器下次重绘前执行</span><br><span class="line">回调的次数常是每秒 60 次，大多数浏览器通常匹配 W3C 所建议的刷新率</span><br><span class="line"></span><br><span class="line">使用 requestAnimationFrame 计算 FPS 原理</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var rAF = function () &#123;</span><br><span class="line">    return (</span><br><span class="line">        window.requestAnimationFrame ||</span><br><span class="line">        window.webkitRequestAnimationFrame ||</span><br><span class="line">        function (callback) &#123;</span><br><span class="line">            window.setTimeout(callback, 1000 / 60);</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">var frame = 0;</span><br><span class="line">var allFrameCount = 0;</span><br><span class="line">var lastTime = Date.now();</span><br><span class="line">var lastFameTime = Date.now();</span><br><span class="line"></span><br><span class="line">var loop = function () &#123;</span><br><span class="line">    var now = Date.now();</span><br><span class="line">    var fs = (now - lastFameTime);</span><br><span class="line">    var fps = Math.round(1000 / fs);</span><br><span class="line"></span><br><span class="line">    lastFameTime = now;</span><br><span class="line">    // 不置 0，在动画的开头及结尾记录此值的差值算出 FPS</span><br><span class="line">    allFrameCount++;</span><br><span class="line">    frame++;</span><br><span class="line"></span><br><span class="line">    if (now &gt; 1000 + lastTime) &#123;</span><br><span class="line">        var fps = Math.round((frame * 1000) / (now - lastTime));</span><br><span class="line">        console.log(`$&#123;new Date()&#125; 1S内 FPS：`, fps);</span><br><span class="line">        frame = 0;</span><br><span class="line">        lastTime = now;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    rAF(loop);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">loop();</span><br></pre></td></tr></table></figure>
<h2 id="设备信息"><a href="#设备信息" class="headerlink" title="设备信息"></a>设备信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">window.navigator.userAgent中可以获取用户设备信息</span><br><span class="line"></span><br><span class="line">window.navigator.connection中可以获取设备网络信息</span><br><span class="line"></span><br><span class="line">window.devicePixelRatio中可以获取设备像素比</span><br></pre></td></tr></table></figure>
<h2 id="上报策略"><a href="#上报策略" class="headerlink" title="上报策略"></a>上报策略</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">pv/uv     监听各种页面切换的情况；SPA页面，可以监听hashChange</span><br><span class="line"></span><br><span class="line">PV(page view)，即页面浏览量，或点击量；用户每1次对网站中的每个网页访问均被记录1次</span><br><span class="line">用户对同一页面的多次访问，访问量累计</span><br><span class="line"></span><br><span class="line">UV（独立访客）即Unique Visitor，访问您网站的一台电脑客户端为一个访客</span><br><span class="line"></span><br><span class="line">CV Content Views，内容播放数</span><br><span class="line"></span><br><span class="line">一个统计周期内，视频被打开，且视频正片内容（除广告）被成功播放的次数</span><br><span class="line"></span><br><span class="line">IP（独立IP）1天之内（00:00~24:00），访问网站的不重复的IP数</span><br><span class="line">拥有特定唯一IP的计算机访问网站的次数，因为这种统计方式比较容易实现，具有较高的真实性</span><br><span class="line"></span><br><span class="line">VV（video view，视频播放量）一个统计周期内，视频被打开的次数</span><br><span class="line"></span><br><span class="line">性能数据/设备信息/网络状况</span><br><span class="line"></span><br><span class="line">  在页面离开前上报 beforeUnload/visibilitychange/pagehide…+sendBeancon/Ajax</span><br><span class="line"></span><br><span class="line">  beforeUnload  事件</span><br><span class="line"></span><br><span class="line">  visibilitychange 事件  浏览器标签页被隐藏或显示的时候会触发</span><br><span class="line"></span><br><span class="line">  pagehide  pageshow 事件</span><br><span class="line"></span><br><span class="line">  navigator.sendBeacon() 方法  可用于通过HTTP将少量数据异步传输到Web服务器</span><br><span class="line">  sendBeacon() 方法会使用户代理在有机会时异步地向服务器发送数据，同时不会延迟页面的卸载或影响下一导航的载入性能</span><br><span class="line">  这就解决了提交分析数据时的所有的问题：数据可靠，传输异步并且不会影响下一页面的加载。此外，代码实际上还要比其他技术简单许多</span><br><span class="line"></span><br><span class="line">  Ajax</span><br><span class="line"></span><br><span class="line">  img 标签+切片+压缩</span><br></pre></td></tr></table></figure>
<h2 id="错误信息"><a href="#错误信息" class="headerlink" title="错误信息"></a>错误信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1. 使用window.onerror捕获JS运行时错误 有堆栈信息</span><br><span class="line"></span><br><span class="line">2. window.addEventListener(&apos;error&apos;)捕获资源加载错误。因为它也能捕获js运行时错误，为避免重复上报js运行时错误，此时只有event.srcElement inatanceof HTMLScriptElement或HTMLLinkElement或HTMLImageElement时才上报</span><br><span class="line"></span><br><span class="line">3. window.addEventListener(&apos;unhandledrejection&apos;)捕获未处理的promise reject错误</span><br><span class="line"></span><br><span class="line">4. 重写console.error捕获console.error错误</span><br><span class="line"></span><br><span class="line">5. 在跨域脚本上配置crossorigin=&quot;anonymous&quot;捕获跨域脚本错误</span><br><span class="line"></span><br><span class="line">6. 重写window.XMLHttpRequest和window.fetch捕获请求错误</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/05/08/facebook-css-trick/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/08/facebook-css-trick/" itemprop="url">facebook css trick</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-08T08:14:42+08:00">
                2020-05-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="头像使用SVG"><a href="#头像使用SVG" class="headerlink" title="头像使用SVG"></a>头像使用SVG</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg role="none" style="height: 36px; width: 36px;"&gt;</span><br><span class="line">  &lt;mask id="avatar"&gt;</span><br><span class="line">    &lt;circle cx="18" cy="18" fill="white" r="18"&gt;&lt;/circle&gt;</span><br><span class="line">  &lt;/mask&gt;</span><br><span class="line">  &lt;g mask="url(#avatar)"&gt;</span><br><span class="line">    &lt;image x="0" y="0" height="100%" preserveAspectRatio="xMidYMid slice" width="100%" xlink:href="avatar.jpg" style="height: 36px; width: 36px;"&gt;&lt;/image&gt;</span><br><span class="line">    &lt;circle cx="18" cy="18" r="18"&gt;&lt;/circle&gt;</span><br><span class="line">  &lt;/g&gt;</span><br><span class="line">&lt;/svg&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">circle</span>,</span><br><span class="line"><span class="selector-tag">rect</span> &#123;</span><br><span class="line">  <span class="attribute">stroke-width</span>: <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">stroke</span>: <span class="built_in">rgba</span>(0, 0, 0, 0.1);</span><br><span class="line">  <span class="attribute">fill</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;svg role="none" style="height: 36px; width: 36px;"&gt;</span><br><span class="line">  &lt;mask id="avatar"&gt;</span><br><span class="line">    &lt;rect cy="18" fill="white" height="36" rx="8" ry="8" width="36" x="0" y="0"&gt;&lt;/rect&gt;</span><br><span class="line">  &lt;/mask&gt;</span><br><span class="line">  &lt;g mask="url(#avatar)"&gt;</span><br><span class="line">    &lt;image x="0" y="0" height="100%" preserveAspectRatio="xMidYMid slice" width="100%" xlink:href="avatar.jpg" style="height: 36px; width: 36px;"&gt;&lt;/image&gt;</span><br><span class="line">    &lt;rect cy="18" fill="white" height="36" rx="8" ry="8" width="36" x="0" y="0"&gt;&lt;/rect&gt;</span><br><span class="line">  &lt;/g&gt;</span><br><span class="line">&lt;/svg&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div class="avatar-wrapper&gt;</span><br><span class="line">  &lt;img class="avatar" width="40" height="40" src="avatar.jpg" width="40" alt=""&gt;</span><br><span class="line">  &lt;div class="avatar-outline"&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.avatar-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.avatar</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.avatar-outline</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="built_in">0001pxrgba</span>(0, 0, 0, 0.1);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="使用div间隔代替空白"><a href="#使用div间隔代替空白" class="headerlink" title="使用div间隔代替空白"></a>使用div间隔代替空白</h2><h2 id="使用CSS过滤器"><a href="#使用CSS过滤器" class="headerlink" title="使用CSS过滤器"></a>使用CSS过滤器</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-class">.icon</span> &#123;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">invert</span>(39%) <span class="built_in">sepia</span>(57%) <span class="built_in">saturate</span>(200%) <span class="built_in">saturate</span>(200%) <span class="built_in">saturate</span>(200%) <span class="built_in">saturate</span>(200%) <span class="built_in">saturate</span>(200%) <span class="built_in">saturate</span>(147.75%) <span class="built_in">hue-rotate</span>(202deg) <span class="built_in">brightness</span>(97%) <span class="built_in">contrast</span>(96%)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">filter</span>属性</span><br><span class="line"></span><br><span class="line">Doc https:\//www.w3.org/TR/filter-effects-1/</span><br></pre></td></tr></table></figure>
<h2 id="为阴影使用图像"><a href="#为阴影使用图像" class="headerlink" title="为阴影使用图像"></a>为阴影使用图像</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用图片的原因是为了性能。在浏览器中，像这样的浮动Header上的框阴影会杀死滚动性能</span><br></pre></td></tr></table></figure>
<h2 id="广泛使用CSS变量"><a href="#广泛使用CSS变量" class="headerlink" title="广泛使用CSS变量"></a>广泛使用CSS变量</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-pseudo">:root</span> 元素中添加了320多个变量</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="comment">/* Light模式变量 */</span></span><br><span class="line">  <span class="attribute">-fds-active-icon</span>:  <span class="number">#3578E5</span>;</span><br><span class="line">  <span class="attribute">--fds-attachment-footer-background</span>:  <span class="number">#F2F3F5</span>;</span><br><span class="line">  --fds-blue-05:  #ECF3FF;</span><br><span class="line">  <span class="selector-tag">--fds-blue-30</span>:  <span class="selector-id">#AAC9FF</span>;</span><br><span class="line">  <span class="selector-tag">--fds-blue-40</span>:  <span class="selector-id">#77A7FF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.__fb-dark-mode</span><span class="selector-pseudo">:root</span>, <span class="selector-class">.__fb-dark-mode</span> &#123;</span><br><span class="line">  <span class="comment">/* 覆盖light变量 */</span></span><br><span class="line">  <span class="attribute">--fds-active-icon</span>:  black;</span><br><span class="line">  <span class="attribute">--fds-attachment-footer-background</span>:  black;</span><br><span class="line">  --fds-blue-05:  black;</span><br><span class="line">  <span class="selector-tag">--fds-blue-30</span>:  <span class="selector-tag">black</span>;</span><br><span class="line">  <span class="selector-tag">--fds-blue-40</span>:  <span class="selector-tag">black</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">带有前缀<span class="selector-tag">--</span>的属性名，比如<span class="selector-tag">--example--name</span>，表示的是带有值的自定义属性，其可以通过 <span class="selector-tag">var</span> 函数在全文档范围内复用的</span><br><span class="line"></span><br><span class="line">// 声明</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">--somekeyword</span>: <span class="selector-tag">left</span>;</span><br><span class="line"><span class="selector-tag">--somecolor</span>: <span class="selector-id">#0000ff</span>;</span><br><span class="line"><span class="selector-tag">--somecomplexvalue</span>: 3<span class="selector-tag">px</span> 6<span class="selector-tag">px</span> <span class="selector-tag">rgb</span>(20, 32, 54);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attribute">--first-color</span>: <span class="number">#488cff</span>;</span><br><span class="line">  <span class="attribute">--second-color</span>: <span class="number">#ffff8c</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#firstParagraph</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--first-color);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--second-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#secondParagraph</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--second-color);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--first-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">  <span class="attribute">--first-color</span>: <span class="number">#48ff32</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#thirdParagraph</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--first-color);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--second-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="行截断（截断多行文本）"><a href="#行截断（截断多行文本）" class="headerlink" title="行截断（截断多行文本）"></a>行截断（截断多行文本）</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">  <span class="attribute">-webkit-box-orient</span>: vertical;</span><br><span class="line">  <span class="attribute">-webkit-line-clamp</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="使用inset属性"><a href="#使用inset属性" class="headerlink" title="使用inset属性"></a>使用inset属性</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 上下左右 */</span></span><br><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">  <span class="attribute">inset</span>: <span class="number">4px</span>0;</span><br><span class="line">  <span class="comment">/* 这相当于: top: 4px, bottom: 4px, left: 0, right: 0 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="dir-auto和CSS逻辑属性"><a href="#dir-auto和CSS逻辑属性" class="headerlink" title="dir =auto和CSS逻辑属性"></a>dir =auto和CSS逻辑属性</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div dir=&quot;auto&quot; style=&quot;text-align: start;&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h2 id="多个框阴影"><a href="#多个框阴影" class="headerlink" title="多个框阴影"></a>多个框阴影</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">012px28px0rgba</span>(0, 0, 0, 0.2), <span class="built_in">02px4px0rgba</span>(0, 0, 0, 0.1), inset <span class="built_in">0001pxrgba</span>(255, 255, 255, 0.5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Flexbox网格的空元素"><a href="#Flexbox网格的空元素" class="headerlink" title="Flexbox网格的空元素"></a>Flexbox网格的空元素</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrapper"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"photo.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"photo.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"photo.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"photo.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"empty"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"empty"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"empty"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"empty"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/05/07/javascript-Ramda/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/07/javascript-Ramda/" itemprop="url">javascript Ramda </a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-07T16:30:14+08:00">
                2020-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Ramda-philosophy"><a href="#Ramda-philosophy" class="headerlink" title="Ramda philosophy"></a>Ramda philosophy</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">要一个专门为函数式编程风格设计的库</span><br><span class="line">该库使创建功能性流水线变得容易</span><br><span class="line">而该流水线从不改变用户数据</span><br><span class="line"></span><br><span class="line">不变性 和 无副作用功能  是其设计理念的核心</span><br><span class="line"></span><br><span class="line">自动柯里化</span><br><span class="line"></span><br><span class="line">https://ramdajs.com/</span><br><span class="line"></span><br><span class="line">https://ramda.cn/</span><br></pre></td></tr></table></figure>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">npm install ramda</span><br><span class="line"></span><br><span class="line">const R = require(&apos;ramda&apos;)</span><br><span class="line"></span><br><span class="line">Partial Builds</span><br><span class="line"></span><br><span class="line">npm run --silent partial-build compose reduce filter &gt; dist/ramda.custom.js</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import * as R from &apos;ramda&apos;</span><br><span class="line">const &#123;identity&#125; = R</span><br><span class="line">R.map(identity, [1, 2, 3])</span><br><span class="line"></span><br><span class="line">import identity from &apos;ramda/src/identity&apos;</span><br><span class="line">identity()</span><br><span class="line"></span><br><span class="line">Webpack + Babel - use babel-plugin-ramda to automatically cherry pick methods</span><br><span class="line">Webpack only - use UglifyJS plugin for treeshaking along with the ModuleConcatenationPlugin</span><br><span class="line">Rollup - does a fine job properly treeshaking, no special work needed</span><br><span class="line"></span><br><span class="line">支持Typescript flow</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://ramda.cn/docs/</span><br><span class="line"></span><br><span class="line">https://gcanti.github.io/fp-ts/</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/05/06/frontEnd-monitor-system/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/06/frontEnd-monitor-system/" itemprop="url">frontEnd monitor system</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-06T16:37:13+08:00">
                2020-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="监控体系"><a href="#监控体系" class="headerlink" title="监控体系"></a>监控体系</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">监控分为 一个c端  一个node端</span><br><span class="line"></span><br><span class="line">整体的监控，我们需要采集的数据分为 4 类，即：</span><br><span class="line"></span><br><span class="line">JS 的异常错误；</span><br><span class="line"></span><br><span class="line">资源测速；</span><br><span class="line"></span><br><span class="line">接口的成功率、失败率；</span><br><span class="line"></span><br><span class="line">性能</span><br></pre></td></tr></table></figure>
<ol>
<li><p>异常收集   badjs</p>
</li>
<li><p>性能监控</p>
</li>
<li><p>日志上报</p>
</li>
<li><p>智能告警</p>
</li>
</ol>
<h4 id="1-异常收集"><a href="#1-异常收集" class="headerlink" title="1. 异常收集"></a>1. 异常收集</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">badjs</span><br><span class="line"></span><br><span class="line">无侵入上报</span><br><span class="line"></span><br><span class="line">异常监控  window.onError  unhandleunhandledRejection</span><br><span class="line"></span><br><span class="line">资源监控  window.addEventaddEventListener(&apos;error&apos;)</span><br><span class="line"></span><br><span class="line">window.onError 是一个标准的错误捕获接口，它可以拿到对应的这种 JS 错误</span><br><span class="line"></span><br><span class="line">windows.addEventLisenter（&apos;error&apos;）也可以捕获到错误，但是它拿到的 JS 报错堆栈往往是不完整的</span><br><span class="line"></span><br><span class="line">同时 window.onError 无法获取到资源加载失败的一个情况，必须使用 window.addEventLisenter（&apos;error&apos;）来捕获资源加载失败的情况</span><br><span class="line"></span><br><span class="line">前端异常最多三种</span><br><span class="line"></span><br><span class="line">  xxx is undefined      lint规避</span><br><span class="line"></span><br><span class="line">  script error</span><br><span class="line"></span><br><span class="line">  syntax error</span><br><span class="line"></span><br><span class="line">  为什么会存在 CDN 被劫持的情况呢？</span><br><span class="line"></span><br><span class="line">大家知道 CDN 实际上是主栈要推到各个 CDN 栈上去的。虽然在我们的页面上面是走 HTTPS，</span><br><span class="line">但是从主栈把资源推到各个 CDN 上的时候，为了追求速度是不会去走 HTTPS 的，而是走 HTTP。</span><br><span class="line">实这就给了一些运营商可趁之机，在这个阶段就把 CDN 上的资源做了一个篡改，导致资源上了 HTTPS 还是被劫持</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">很早就加了一个 SRI 的方案，做防劫持的处理。简单讲一下，比如 SRI 会在 Script 标签上面有一个指纹，</span><br><span class="line">当你通过构建工具生成一个 JS 文件的加密后的一个指纹，然后在服务器下载下来的文件上面，</span><br><span class="line">也会对那个文件做一个指纹，然后再和这个标签上面的文件做指纹的比对。</span><br><span class="line">如果发现不一样，就会认为这个文件被篡改了，是被劫持的。</span><br><span class="line"></span><br><span class="line">当然防劫持的目的达到了，但同时也带来了新的问题——白屏。因为浏览器认为资源不可信，</span><br><span class="line">就不会去执行 JS 了，不会执行这些 JS 就不会去做任何异步尝试，</span><br><span class="line">就说 JS 最终还是被当作加载失败来处理了</span><br><span class="line"></span><br><span class="line">知道加个跨域头就可以解决。但其实往往加了跨域头，发现还是有大量的 Script Error</span><br><span class="line">Script Error 主要原因 客户端调用javascript代码报错</span><br><span class="line">解决方案  客户端添加trycatch 对回调函数统一保护</span><br><span class="line"></span><br><span class="line">防止 Script Error 总结</span><br><span class="line">通过 patch  方法 。</span><br><span class="line"></span><br><span class="line">客户端所有调用的 JS 方法需要做保护。</span><br><span class="line"></span><br><span class="line">客户端也需要添加缓存头 。</span><br></pre></td></tr></table></figure>
<h4 id="2-性能监控"><a href="#2-性能监控" class="headerlink" title="2. 性能监控"></a>2. 性能监控</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">performance</span><br></pre></td></tr></table></figure>
<h4 id="3-日志上报"><a href="#3-日志上报" class="headerlink" title="3. 日志上报"></a>3. 日志上报</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">上报一般都是用 new Image 来发送，因为我们会对上报的请求做一个合并，请求长度太大会导致请求失败</span><br><span class="line"></span><br><span class="line">最直接的解决办法是用 xhr 走 post 请求的方式来发送</span><br><span class="line"></span><br><span class="line">navigator.sendBeacon(url, data);</span><br><span class="line">用于通过HTTP将少量数据异步传输到Web服务器</span><br><span class="line"></span><br><span class="line">data 参数是将要发送的 ArrayBufferView 或 Blob, DOMString 或者 FormData 类型</span><br><span class="line"></span><br><span class="line">当用户代理成功把数据加入传输队列时，sendBeacon() 方法将会返回 true，否则返回 false</span><br><span class="line"></span><br><span class="line">这个方法主要用于满足统计和诊断代码的需要</span><br><span class="line">这些代码通常尝试在卸载（unload）文档之前向web服务器发送数据</span><br><span class="line"></span><br><span class="line">window.addEventListener(&apos;unload&apos;, logData, false);</span><br><span class="line"></span><br><span class="line">function logData() &#123;</span><br><span class="line">    navigator.sendBeacon(&quot;/log&quot;, analyticsData);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.requestIdleCallback()方法将在浏览器的空闲时段内调用的函数排队</span><br><span class="line"></span><br><span class="line">这使开发者能够在主事件循环上执行后台和低优先级工作，而不会影响延迟关键事件，如动画和输入响应</span><br><span class="line"></span><br><span class="line">函数一般会按先进先调用的顺序执行，然而，如果回调函数指定了执行超时时间timeout，则有可能为了在超时前执行函数而打乱执行顺序</span><br><span class="line"></span><br><span class="line">xhr请求 ---&gt;  header注入sessionID 和 traceID</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/04/07/Es2020-features/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/07/Es2020-features/" itemprop="url">Es2020 features</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-07T10:24:32+08:00">
                2020-04-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="class-instance-fields"><a href="#class-instance-fields" class="headerlink" title="class instance fields"></a>class instance fields</h2><ol>
<li>Private Fields in Classes  类实例私有属性</li>
</ol>
<p>prefix #</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</span><br><span class="line">  #x = 0;</span><br><span class="line">  increment() &#123;</span><br><span class="line">    this.#x++;</span><br><span class="line">  &#125;</span><br><span class="line">  decrement() &#123;</span><br><span class="line">    this.#x--;</span><br><span class="line">  &#125;</span><br><span class="line">  getNum()&#123;</span><br><span class="line">    return this.#x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> c = <span class="keyword">new</span> Counter();</span><br><span class="line">c.increment();</span><br><span class="line">c.increment();</span><br><span class="line">c.decrement();</span><br><span class="line"><span class="built_in">console</span>.log(c.getNum());</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>private instance class fields initializers 类实例私有属性初始化</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  #x = 42;</span><br><span class="line">  x()&#123;</span><br><span class="line">    return this.#x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x() === <span class="number">42</span>;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>类实例公有属性</li>
</ol>
<p>无需constructor</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  x = <span class="string">'x'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x === <span class="string">'x'</span>;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>computed instance class fields 类实例计算属性</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  [<span class="string">'x'</span>] = <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x === <span class="number">42</span>;</span><br></pre></td></tr></table></figure>
<h2 id="static-class-fields"><a href="#static-class-fields" class="headerlink" title="static class fields"></a>static class fields</h2><p>js中分为动态属性 和 静态属性</p>
<p>静态属性 就是  类属性</p>
<p>动态属性 就是  实例属性</p>
<ol>
<li>公共静态类属性</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> x = <span class="string">'x'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> C.x === <span class="string">'x'</span>;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>私有静态类属性</li>
</ol>
<p>prefix #</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  static #x = 42;</span><br><span class="line">  x()&#123;</span><br><span class="line">    return C.#x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x() === <span class="number">42</span>;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>静态类计算属性</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> [<span class="string">'x'</span>] = <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> C.x === <span class="number">42</span>;</span><br></pre></td></tr></table></figure>
<h2 id="类方法-与-类原型方法"><a href="#类方法-与-类原型方法" class="headerlink" title="类方法 与 类原型方法"></a>类方法 与 类原型方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">  getName () &#123;</span><br><span class="line">  &#125; <span class="comment">// 定义在Student.prototype上</span></span><br><span class="line"></span><br><span class="line">  getAge = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 定义在类Student实例属性上 不在原型上</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Optional-Chaining-Operator"><a href="#Optional-Chaining-Operator" class="headerlink" title="Optional Chaining Operator ?."></a>Optional Chaining Operator ?.</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj?.prop1?.prop2?.prop3?.prop4?.prop5);</span><br></pre></td></tr></table></figure>
<h2 id="Nullish-Coalescing-Operator"><a href="#Nullish-Coalescing-Operator" class="headerlink" title="Nullish Coalescing Operator ??"></a>Nullish Coalescing Operator ??</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> y = x || <span class="number">500</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> y = x ?? <span class="number">500</span>;</span><br></pre></td></tr></table></figure>
<h2 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h2><p>形参个数 arguments.callee.length</p>
<p>实参个数 argumetns.length     </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> (<span class="params">a = <span class="number">1</span>, b = <span class="number">2</span></span>) </span>&#123; <span class="keyword">return</span> a === <span class="number">3</span> &amp;&amp; b === <span class="number">2</span>; &#125;(<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用unundefined</span></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> (<span class="params">a = <span class="number">1</span>, b = <span class="number">2</span></span>) </span>&#123; <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">3</span>; &#125;(<span class="literal">undefined</span>, <span class="number">3</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认参数引用previous参数</span></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> (<span class="params">a, b = a</span>) </span>&#123; <span class="keyword">return</span> b === <span class="number">5</span>; &#125;(<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> (<span class="params">a = <span class="string">"baz"</span>, b = <span class="string">"qux"</span>, c = <span class="string">"quux"</span></span>) </span>&#123;</span><br><span class="line">  a = <span class="string">"corge"</span>;</span><br><span class="line">  <span class="comment">// The arguments object is not mapped to the parameters, even outside of strict mode.</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">arguments</span>.length === <span class="number">2</span></span><br><span class="line">    &amp;&amp; <span class="built_in">arguments</span>[<span class="number">0</span>] === <span class="string">"foo"</span></span><br><span class="line">    &amp;&amp; <span class="built_in">arguments</span>[<span class="number">1</span>] === <span class="string">"bar"</span>;</span><br><span class="line">&#125;(<span class="string">"foo"</span>, <span class="string">"bar"</span>));</span><br><span class="line"></span><br><span class="line">存在 临时死区</span><br><span class="line"></span><br><span class="line">separate scope</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span>(<span class="params">a=function(</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> b === <span class="string">'undefined'</span>;</span><br><span class="line">&#125;)&#123;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> a();</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">a=function(</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> b === <span class="string">'undefined'</span>;</span><br><span class="line">  &#125;)&#123;</span><br><span class="line">    <span class="keyword">var</span> b = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> a();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(bar()) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// new Function() support</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"a = 1"</span>, <span class="string">"b = 2"</span>,</span><br><span class="line">  <span class="string">"return a === 3 &amp;&amp; b === 2;"</span></span><br><span class="line">)(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<h2 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">类数组 <span class="keyword">typeof</span> 是</span><br><span class="line"></span><br><span class="line"><span class="built_in">arguments</span>.callee</span><br><span class="line">指向当前执行的函数</span><br><span class="line"></span><br><span class="line"><span class="built_in">arguments</span>.caller</span><br><span class="line">指向调用当前函数的函数</span><br><span class="line"></span><br><span class="line"><span class="built_in">arguments</span>.length</span><br><span class="line">指向传递给当前函数的实参数量</span><br><span class="line"></span><br><span class="line"><span class="built_in">arguments</span>[@@iterator]</span><br><span class="line">返回一个新的<span class="built_in">Array</span>迭代器对象，该对象包含参数中每个索引的值</span><br><span class="line"></span><br><span class="line">现在在严格模式下，<span class="built_in">arguments</span>对象已与过往不同。argumetns</span><br><span class="line"></span><br><span class="line"><span class="built_in">arguments</span>[@@iterator]不再与函数的实际形参之间共享，同时caller属性也被移除</span><br></pre></td></tr></table></figure>
<h2 id="rest-parameters"><a href="#rest-parameters" class="headerlink" title="rest parameters"></a>rest parameters</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> (<span class="params">foo, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> args <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; args + <span class="string">""</span> === <span class="string">"bar,baz"</span>;</span><br><span class="line">&#125;(<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. function 'length' property</span></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">a, ...b</span>)</span>&#123;&#125;.length === <span class="number">1</span> &amp;&amp; <span class="function"><span class="keyword">function</span>(<span class="params">...c</span>)</span>&#123;&#125;.length === <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. rguments object interaction</span></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> (<span class="params">foo, ...args</span>) </span>&#123;</span><br><span class="line">  foo = <span class="string">"qux"</span>;</span><br><span class="line">  <span class="comment">// The arguments object is not mapped to the</span></span><br><span class="line">  <span class="comment">// parameters, even outside of strict mode.</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">arguments</span>.length === <span class="number">3</span></span><br><span class="line">    &amp;&amp; <span class="built_in">arguments</span>[<span class="number">0</span>] === <span class="string">"foo"</span></span><br><span class="line">    &amp;&amp; <span class="built_in">arguments</span>[<span class="number">1</span>] === <span class="string">"bar"</span></span><br><span class="line">    &amp;&amp; <span class="built_in">arguments</span>[<span class="number">2</span>] === <span class="string">"baz"</span>;</span><br><span class="line">&#125;(<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// new Function() support</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"a"</span>, <span class="string">"...b"</span>,</span><br><span class="line">  <span class="string">"return b instanceof Array &amp;&amp; a+b === 'foobar,baz';"</span></span><br><span class="line">)(<span class="string">'foo'</span>,<span class="string">'bar'</span>,<span class="string">'baz'</span>);</span><br></pre></td></tr></table></figure>
<h2 id="spread-for-iterator-object"><a href="#spread-for-iterator-object" class="headerlink" title="spread for iterator object"></a>spread for iterator object</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. with arrays, in function calls</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Math</span>.max(...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]) === <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. with arrays, in array literals</span></span><br><span class="line"><span class="keyword">return</span> [...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]][<span class="number">2</span>] === <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. with sparse arrays, in function calls</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="built_in">Array</span>(...[,,]);</span><br><span class="line"><span class="keyword">return</span> <span class="string">"0"</span> <span class="keyword">in</span> a &amp;&amp; <span class="string">"1"</span> <span class="keyword">in</span> a &amp;&amp; <span class="string">''</span> + a[<span class="number">0</span>] + a[<span class="number">1</span>] === <span class="string">"undefinedundefined"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. with sparse arrays, in array literals</span></span><br><span class="line"><span class="keyword">var</span> a = [...[,,]];</span><br><span class="line"><span class="keyword">return</span> <span class="string">"0"</span> <span class="keyword">in</span> a &amp;&amp; <span class="string">"1"</span> <span class="keyword">in</span> a &amp;&amp; <span class="string">''</span> + a[<span class="number">0</span>] + a[<span class="number">1</span>] === <span class="string">"undefinedundefined"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. with strings, in function calls</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Math</span>.max(...<span class="string">"1234"</span>) === <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. with strings, in array literals</span></span><br><span class="line"><span class="keyword">return</span> [<span class="string">"a"</span>, ...<span class="string">"bcd"</span>, <span class="string">"e"</span>][<span class="number">3</span>] === <span class="string">"d"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. with astral plane strings, in function calls</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Array</span>(...<span class="string">"𠮷𠮶"</span>)[<span class="number">0</span>] === <span class="string">"𠮷"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8. with astral plane strings, in array literals</span></span><br><span class="line"><span class="keyword">return</span> [...<span class="string">"𠮷𠮶"</span>][<span class="number">0</span>] === <span class="string">"𠮷"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 9. with generator instances, in calls</span></span><br><span class="line"><span class="comment">// ... 会自动调用next函数</span></span><br><span class="line"><span class="keyword">var</span> iterable = (<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123; <span class="keyword">yield</span> <span class="number">1</span>; <span class="keyword">yield</span> <span class="number">2</span>; <span class="keyword">yield</span> <span class="number">3</span>; &#125;());</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Math</span>.max(...iterable) === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 10. with generator instances, in arrays</span></span><br><span class="line"><span class="comment">// ... 会自动调用next函数</span></span><br><span class="line"><span class="keyword">var</span> iterable = (<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123; <span class="keyword">yield</span> <span class="string">"b"</span>; <span class="keyword">yield</span> <span class="string">"c"</span>; <span class="keyword">yield</span> <span class="string">"d"</span>; &#125;());</span><br><span class="line"><span class="keyword">return</span> [<span class="string">"a"</span>, ...iterable, <span class="string">"e"</span>][<span class="number">3</span>] === <span class="string">"d"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 11. with generic iterables, in calls</span></span><br><span class="line"><span class="keyword">var</span> iterable = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Math</span>.max(...iterable) === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 12. with generic iterables, in arrays</span></span><br><span class="line"><span class="keyword">var</span> iterable = global.__createIterableObject([<span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>]);</span><br><span class="line"><span class="keyword">return</span> [<span class="string">"a"</span>, ...iterable, <span class="string">"e"</span>][<span class="number">3</span>] === <span class="string">"d"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 13. with instances of iterables, in calls</span></span><br><span class="line"><span class="keyword">var</span> iterable = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Math</span>.max(...Object.create(iterable)) === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 14. with instances of iterables, in arrays</span></span><br><span class="line"><span class="keyword">var</span> iterable = global.__createIterableObject([<span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>]);</span><br><span class="line"><span class="keyword">return</span> [<span class="string">"a"</span>, ...Object.create(iterable), <span class="string">"e"</span>][<span class="number">3</span>] === <span class="string">"d"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 15. spreading non-iterables is a runtime error</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="built_in">Math</span>.max(..<span class="number">.2</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.max(...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]) === <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// spread 对 generator ItIterableObject 可以</span></span><br></pre></td></tr></table></figure>
<h2 id="object-literal-extensions"><a href="#object-literal-extensions" class="headerlink" title="object literal extensions"></a>object literal extensions</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. computed properties</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="string">'y'</span>;</span><br><span class="line"><span class="keyword">return</span> (&#123; [x]: <span class="number">1</span> &#125;).y === <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">7</span>, b = <span class="number">8</span>, c = &#123;a,b&#125;;</span><br><span class="line"><span class="keyword">return</span> c.a === <span class="number">7</span> &amp;&amp; c.b === <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (&#123; y() &#123; <span class="keyword">return</span> <span class="number">2</span>; &#125; &#125;).y() === <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (&#123; <span class="string">"foo bar"</span>() &#123; <span class="keyword">return</span> <span class="number">4</span>; &#125; &#125;)[<span class="string">"foo bar"</span>]() === <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = <span class="string">'y'</span>;</span><br><span class="line"><span class="keyword">return</span> (&#123; [x]()&#123; <span class="keyword">return</span> <span class="number">1</span> &#125; &#125;).y() === <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = <span class="string">'y'</span>,</span><br><span class="line">    valueSet,</span><br><span class="line">    obj = &#123;</span><br><span class="line">      <span class="keyword">get</span> [x] () &#123; <span class="keyword">return</span> <span class="number">1</span> &#125;,</span><br><span class="line">      <span class="keyword">set</span> [x] (value) &#123; valueSet = value &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">obj.y = <span class="string">'foo'</span>;</span><br><span class="line"><span class="keyword">return</span> obj.y === <span class="number">1</span> &amp;&amp; valueSet === <span class="string">'foo'</span>;</span><br></pre></td></tr></table></figure>
<h2 id="for-of"><a href="#for-of" class="headerlink" title="for..of"></a>for..of</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 数组</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">5</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> arr)</span><br><span class="line">  <span class="keyword">return</span> item === <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. spare arrays</span></span><br><span class="line"><span class="keyword">var</span> arr = [,,];</span><br><span class="line"><span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> arr)</span><br><span class="line">  count += (item === <span class="literal">undefined</span>);</span><br><span class="line"><span class="keyword">return</span> count === <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 字符串</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> <span class="string">"foo"</span>)</span><br><span class="line">  str += item;</span><br><span class="line"><span class="keyword">return</span> str === <span class="string">"foo"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. astral plane strings</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> <span class="string">"𠮷𠮶"</span>)</span><br><span class="line">  str += item + <span class="string">" "</span>;</span><br><span class="line"><span class="keyword">return</span> str === <span class="string">"𠮷 𠮶 "</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. generator instances</span></span><br><span class="line"><span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> iterable = (<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123; <span class="keyword">yield</span> <span class="number">1</span>; <span class="keyword">yield</span> <span class="number">2</span>; <span class="keyword">yield</span> <span class="number">3</span>; &#125;());</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> iterable) &#123;</span><br><span class="line">  result += item;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result === <span class="string">"123"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. generic iterables</span></span><br><span class="line"><span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> iterable = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> iterable) &#123;</span><br><span class="line">  result += item;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result === <span class="string">"123"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. instances of generic iterables</span></span><br><span class="line"><span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">var</span> iterable = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">of</span> <span class="built_in">Object</span>.create(iterable)) &#123;</span><br><span class="line">  result += item;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> result === <span class="string">"123"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8. iterator closing, break</span></span><br><span class="line"><span class="keyword">var</span> closed = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> iter = __createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], &#123;</span><br><span class="line">  <span class="string">'return'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; closed = <span class="literal">true</span>; <span class="keyword">return</span> &#123;&#125;; &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> it <span class="keyword">of</span> iter) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">return</span> closed;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 9. iterator closing, throw</span></span><br><span class="line"><span class="keyword">var</span> closed = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> iter = __createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], &#123;</span><br><span class="line">  <span class="string">'return'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; closed = <span class="literal">true</span>; <span class="keyword">return</span> &#123;&#125;; &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> it <span class="keyword">of</span> iter) <span class="keyword">throw</span> <span class="number">0</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> closed;</span><br></pre></td></tr></table></figure>
<h2 id="octal-and-binary-literals"><a href="#octal-and-binary-literals" class="headerlink" title="octal and binary literals"></a>octal and binary literals</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. octal literals 0o开头</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0o10</span> === <span class="number">8</span> &amp;&amp; <span class="number">0O10</span> === <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. binary literals 0b开头</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0b10</span> === <span class="number">2</span> &amp;&amp; <span class="number">0B10</span> === <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. octal supported by Number()</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Number</span>(<span class="string">'0o1'</span>) === <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. binary supported by Number()</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Number</span>(<span class="string">'0b1'</span>) === <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h2 id="template-literals"><a href="#template-literals" class="headerlink" title="template literals"></a>template literals</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. basic functionality</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">"ba"</span>, b = <span class="string">"QUX"</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="string">`foo bar</span></span><br><span class="line"><span class="string"><span class="subst">$&#123;a + <span class="string">"z"</span>&#125;</span> <span class="subst">$&#123;b.toLowerCase()&#125;</span>`</span> === <span class="string">"foo bar\nbaz qux"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. toString conversion</span></span><br><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  toString: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">"foo"</span>; &#125;,</span><br><span class="line">  valueOf: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">"bar"</span>; &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;a&#125;</span>`</span> === <span class="string">"foo"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. tagged template literals</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> called = <span class="literal">false</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">parts, a, b</span>) </span>&#123;</span><br><span class="line">  called = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> parts <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp;</span><br><span class="line">    parts[<span class="number">0</span>]     === <span class="string">"foo"</span>      &amp;&amp;</span><br><span class="line">    parts[<span class="number">1</span>]     === <span class="string">"bar\n"</span>    &amp;&amp;</span><br><span class="line">    parts.raw[<span class="number">0</span>] === <span class="string">"foo"</span>      &amp;&amp;</span><br><span class="line">    parts.raw[<span class="number">1</span>] === <span class="string">"bar\\n"</span>   &amp;&amp;</span><br><span class="line">    a === <span class="number">123</span>                   &amp;&amp;</span><br><span class="line">    b === <span class="number">456</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> fn <span class="string">`foo<span class="subst">$&#123;<span class="number">123</span>&#125;</span>bar\n<span class="subst">$&#123;<span class="number">456</span>&#125;</span>`</span> &amp;&amp; called;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. passed array is frozen</span></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span>(<span class="params">parts</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.isFrozen(parts) &amp;&amp; <span class="built_in">Object</span>.isFrozen(parts.raw);</span><br><span class="line">&#125;) <span class="string">`foo<span class="subst">$&#123;<span class="number">0</span>&#125;</span>bar<span class="subst">$&#123;<span class="number">0</span>&#125;</span>baz`</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. line break normalisation</span></span><br><span class="line"><span class="keyword">var</span> cr   = <span class="built_in">eval</span>(<span class="string">"`x"</span> + <span class="built_in">String</span>.fromCharCode(<span class="number">13</span>)    + <span class="string">"y`"</span>);</span><br><span class="line"><span class="keyword">var</span> lf   = <span class="built_in">eval</span>(<span class="string">"`x"</span> + <span class="built_in">String</span>.fromCharCode(<span class="number">10</span>)    + <span class="string">"y`"</span>);</span><br><span class="line"><span class="keyword">var</span> crlf = <span class="built_in">eval</span>(<span class="string">"`x"</span> + <span class="built_in">String</span>.fromCharCode(<span class="number">13</span>,<span class="number">10</span>) + <span class="string">"y`"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> cr.length === <span class="number">3</span> &amp;&amp; lf.length === <span class="number">3</span> &amp;&amp; crlf.length === <span class="number">3</span></span><br><span class="line">  &amp;&amp; cr[<span class="number">1</span>] === lf[<span class="number">1</span>] &amp;&amp; lf[<span class="number">1</span>] === crlf[<span class="number">1</span>] &amp;&amp; crlf[<span class="number">1</span>] === <span class="string">'\n'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. TemplateStrings call site caching</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strings</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getStrings</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> strings<span class="string">`foo`</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> original = getStrings();</span><br><span class="line"><span class="keyword">var</span> other = strings<span class="string">`foo`</span>;</span><br><span class="line"><span class="keyword">return</span> original === getStrings() &amp;&amp; original !== other;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. TemplateStrings permanent caching</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strings</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getStrings</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> strings<span class="string">`foo`</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> original = getStrings();</span><br><span class="line"><span class="keyword">var</span> newed = <span class="keyword">new</span> getStrings();</span><br><span class="line"><span class="keyword">return</span> original === getStrings() &amp;&amp; original === newed;</span><br></pre></td></tr></table></figure>
<h2 id="RegExp-y-and-u-flags"><a href="#RegExp-y-and-u-flags" class="headerlink" title="RegExp_y_and_u_flags"></a>RegExp_y_and_u_flags</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. y</span></span><br><span class="line">sticky 的值是 <span class="built_in">Boolean</span> ，并在“y”标志使用时为真; 否则为假。<span class="string">"y"</span> 标志指示</span><br><span class="line">仅从正则表达式的 lastIndex 属性表示的索引处为目标字符串匹配</span><br><span class="line">并且不会尝试从后续索引匹配</span><br></pre></td></tr></table></figure>
<h2 id="destructuring-delarations"><a href="#destructuring-delarations" class="headerlink" title="destructuring delarations"></a>destructuring delarations</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. arrays</span></span><br><span class="line"><span class="keyword">var</span> [a, , [b], c] = [<span class="number">5</span>, <span class="literal">null</span>, [<span class="number">6</span>]];</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">5</span> &amp;&amp; b === <span class="number">6</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. sparse arrays</span></span><br><span class="line"><span class="keyword">var</span> [a, , b] = [,,,];</span><br><span class="line"><span class="keyword">return</span> a === <span class="literal">undefined</span> &amp;&amp; b === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [a, b, c] = <span class="string">"ab"</span>;</span><br><span class="line"><span class="keyword">return</span> a === <span class="string">"a"</span> &amp;&amp; b === <span class="string">"b"</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [c] = <span class="string">"𠮷𠮶"</span>;</span><br><span class="line"><span class="keyword">return</span> c === <span class="string">"𠮷"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// generator</span></span><br><span class="line"><span class="keyword">var</span> [a, b, c] = (<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123; <span class="keyword">yield</span> <span class="number">1</span>; <span class="keyword">yield</span> <span class="number">2</span>; &#125;());</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IterableObject</span></span><br><span class="line"><span class="keyword">var</span> [a, b, c] = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>]);</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [a, b, c] = <span class="built_in">Object</span>.create(global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>]));</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> closed = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> iter = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], &#123;</span><br><span class="line">  <span class="string">'return'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; closed = <span class="literal">true</span>; <span class="keyword">return</span> &#123;&#125;; &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> [a, b] = iter;</span><br><span class="line"><span class="keyword">return</span> closed;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [a,] = [<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;c, <span class="attr">x</span>:d, e&#125; = &#123;<span class="attr">c</span>:<span class="number">7</span>, <span class="attr">x</span>:<span class="number">8</span>&#125;;</span><br><span class="line"><span class="keyword">return</span> c === <span class="number">7</span> &amp;&amp; d === <span class="number">8</span> &amp;&amp; e === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自动装包和拆包</span></span><br><span class="line"><span class="keyword">var</span> &#123;toFixed&#125; = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> &#123;slice&#125; = <span class="string">''</span>;</span><br><span class="line"><span class="keyword">return</span> toFixed === <span class="built_in">Number</span>.prototype.toFixed</span><br><span class="line">  &amp;&amp; slice === <span class="built_in">String</span>.prototype.slice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;a,&#125; = &#123;<span class="attr">a</span>:<span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> &#123;a&#125; = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!(e <span class="keyword">instanceof</span> <span class="built_in">TypeError</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> &#123;b&#125; = <span class="literal">undefined</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!(e <span class="keyword">instanceof</span> <span class="built_in">TypeError</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> qux = <span class="string">"corge"</span>;</span><br><span class="line"><span class="keyword">var</span> &#123; [qux]: grault &#125; = &#123; <span class="attr">corge</span>: <span class="string">"garply"</span> &#125;;</span><br><span class="line"><span class="keyword">return</span> grault === <span class="string">"garply"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [a,b] = [<span class="number">5</span>,<span class="number">6</span>], &#123;c,d&#125; = &#123;<span class="attr">c</span>:<span class="number">7</span>,<span class="attr">d</span>:<span class="number">8</span>&#125;;</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">5</span> &amp;&amp; b === <span class="number">6</span> &amp;&amp; c === <span class="number">7</span> &amp;&amp; d === <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [e, &#123;<span class="attr">x</span>:f, g&#125;] = [<span class="number">9</span>, &#123;<span class="attr">x</span>:<span class="number">10</span>&#125;];</span><br><span class="line"><span class="keyword">var</span> &#123;h, <span class="attr">x</span>:[i]&#125; = &#123;<span class="attr">h</span>:<span class="number">11</span>, <span class="attr">x</span>:[<span class="number">12</span>]&#125;;</span><br><span class="line"><span class="keyword">return</span> e === <span class="number">9</span> &amp;&amp; f === <span class="number">10</span> &amp;&amp; g === <span class="literal">undefined</span></span><br><span class="line">  &amp;&amp; h === <span class="number">11</span> &amp;&amp; i === <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> [i, j, k] <span class="keyword">in</span> &#123; <span class="attr">qux</span>: <span class="number">1</span> &#125;) &#123;</span><br><span class="line">  <span class="keyword">return</span> i === <span class="string">"q"</span> &amp;&amp; j === <span class="string">"u"</span> &amp;&amp; k === <span class="string">"x"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> [i, j, k] <span class="keyword">of</span> [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]]) &#123;</span><br><span class="line">  <span class="keyword">return</span> i === <span class="number">1</span> &amp;&amp; j === <span class="number">2</span> &amp;&amp; k === <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line">&#125; <span class="keyword">catch</span>([i,j]) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> &#123; <span class="attr">k</span>: <span class="number">3</span>, <span class="attr">l</span>: <span class="number">4</span> &#125;;</span><br><span class="line">  &#125; <span class="keyword">catch</span>(&#123;k, l&#125;) &#123;</span><br><span class="line">    <span class="keyword">return</span> i === <span class="number">1</span> &amp;&amp; j === <span class="number">2</span> &amp;&amp; k === <span class="number">3</span> &amp;&amp; l === <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [a, ...b] = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> [c, ...d] = [<span class="number">6</span>];</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">3</span> &amp;&amp; b <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; (b + <span class="string">""</span>) === <span class="string">"4,5"</span> &amp;&amp;</span><br><span class="line">   c === <span class="number">6</span> &amp;&amp; d <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; d.length === <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;a = <span class="number">1</span>, b = <span class="number">0</span>, <span class="attr">z</span>:c = <span class="number">3</span>&#125; = &#123;<span class="attr">b</span>:<span class="number">2</span>, <span class="attr">z</span>:<span class="literal">undefined</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> [d = <span class="number">0</span>, e = <span class="number">5</span>, f = <span class="number">6</span>] = [<span class="number">4</span>,,<span class="literal">undefined</span>];</span><br><span class="line">   <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="number">3</span></span><br><span class="line">     &amp;&amp; d === <span class="number">4</span> &amp;&amp; e === <span class="number">5</span> &amp;&amp; f === <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;a, b = <span class="number">2</span>&#125; = &#123;<span class="attr">a</span>:<span class="number">1</span>&#125;;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"> <span class="built_in">eval</span>(<span class="string">"let &#123;c = c&#125; = &#123;&#125;;"</span>);</span><br><span class="line"> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e)&#123;&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"> <span class="built_in">eval</span>(<span class="string">"let &#123;c = d, d&#125; = &#123;d:1&#125;;"</span>);</span><br><span class="line"> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e)&#123;&#125;</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<h2 id="destructuring-assignment"><a href="#destructuring-assignment" class="headerlink" title="destructuring assignment"></a>destructuring assignment</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c;</span><br><span class="line">[a, , [b], c] = [<span class="number">5</span>, <span class="literal">null</span>, [<span class="number">6</span>]];</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">5</span> &amp;&amp; b === <span class="number">6</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a, b;</span><br><span class="line">[a, , b] = [,,,];</span><br><span class="line"><span class="keyword">return</span> a === <span class="literal">undefined</span> &amp;&amp; b === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c;</span><br><span class="line">[a, b, c] = <span class="string">"ab"</span>;</span><br><span class="line"><span class="keyword">return</span> a === <span class="string">"a"</span> &amp;&amp; b === <span class="string">"b"</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c;</span><br><span class="line">[c] = <span class="string">"𠮷𠮶"</span>;</span><br><span class="line"><span class="keyword">return</span> c === <span class="string">"𠮷"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c;</span><br><span class="line">[a, b, c] = (<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123; <span class="keyword">yield</span> <span class="number">1</span>; <span class="keyword">yield</span> <span class="number">2</span>; &#125;());</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c;</span><br><span class="line">[a, b, c] = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>]);</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c;</span><br><span class="line">[a, b, c] = <span class="built_in">Object</span>.create(global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>]));</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> closed = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> iter = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], &#123;</span><br><span class="line">  <span class="string">'return'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; closed = <span class="literal">true</span>; <span class="keyword">return</span> &#123;&#125;; &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> a,b;</span><br><span class="line">[a, b] = iter;</span><br><span class="line"><span class="keyword">return</span> closed;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a, b, iterable = [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line"><span class="keyword">return</span> ([a, b] = iterable) === iterable; <span class="comment">// [1, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c,d;</span><br><span class="line">[a,b] = [c,d] = [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="number">1</span> &amp;&amp; d === <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a;</span><br><span class="line">[a,] = [<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c,d,e;</span><br><span class="line">(&#123;c, <span class="attr">x</span>:d, e&#125; = &#123;<span class="attr">c</span>:<span class="number">7</span>, <span class="attr">x</span>:<span class="number">8</span>&#125;);</span><br><span class="line"><span class="keyword">return</span> c === <span class="number">7</span> &amp;&amp; d === <span class="number">8</span> &amp;&amp; e === <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> toFixed, slice;</span><br><span class="line">(&#123;toFixed&#125; = <span class="number">2</span>);</span><br><span class="line">(&#123;slice&#125; = <span class="string">''</span>);</span><br><span class="line"><span class="keyword">return</span> toFixed === <span class="built_in">Number</span>.prototype.toFixed</span><br><span class="line">  &amp;&amp; slice === <span class="built_in">String</span>.prototype.slice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a;</span><br><span class="line">(&#123;a,&#125; = &#123;<span class="attr">a</span>:<span class="number">1</span>&#125;);</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a, b, obj = &#123; <span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">return</span> (&#123;a,b&#125; = obj) === obj;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a, b;</span><br><span class="line">(&#123;a,b&#125; = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="built_in">eval</span>(<span class="string">"(&#123;a,b&#125;) = &#123;a:3,b:4&#125;;"</span>); <span class="comment">// syntax error</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c,d;</span><br><span class="line">(&#123;a,b&#125; = &#123;c,d&#125; = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>,<span class="attr">c</span>:<span class="number">3</span>,<span class="attr">d</span>:<span class="number">4</span>&#125;);</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="number">3</span> &amp;&amp; d === <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  (&#123;a&#125; = <span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!(e <span class="keyword">instanceof</span> <span class="built_in">TypeError</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  (&#123;b&#125; = <span class="literal">undefined</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!(e <span class="keyword">instanceof</span> <span class="built_in">TypeError</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> grault, qux = <span class="string">"corge"</span>;</span><br><span class="line">(&#123; [qux]: grault &#125; = &#123; <span class="attr">corge</span>: <span class="string">"garply"</span> &#125;);</span><br><span class="line"><span class="keyword">return</span> grault === <span class="string">"garply"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> e,f,g,h,i;</span><br><span class="line">[e, &#123;<span class="attr">x</span>:f, g&#125;] = [<span class="number">9</span>, &#123;<span class="attr">x</span>:<span class="number">10</span>&#125;];</span><br><span class="line">(&#123;h, <span class="attr">x</span>:[i]&#125; = &#123;<span class="attr">h</span>:<span class="number">11</span>, <span class="attr">x</span>:[<span class="number">12</span>]&#125;);</span><br><span class="line"><span class="keyword">return</span> e === <span class="number">9</span> &amp;&amp; f === <span class="number">10</span> &amp;&amp; g === <span class="literal">undefined</span></span><br><span class="line">  &amp;&amp; h === <span class="number">11</span> &amp;&amp; i === <span class="number">12</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c,d;</span><br><span class="line">[a, ...b] = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">[c, ...d] = [<span class="number">6</span>];</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">3</span> &amp;&amp; b <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; (b + <span class="string">""</span>) === <span class="string">"4,5"</span> &amp;&amp;</span><br><span class="line">   c === <span class="number">6</span> &amp;&amp; d <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; d.length === <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], first, last;</span><br><span class="line">[first, ...[a[<span class="number">2</span>], last]] = a;</span><br><span class="line"><span class="keyword">return</span> first === <span class="number">1</span> &amp;&amp; last === <span class="number">3</span> &amp;&amp; (a + <span class="string">""</span>) === <span class="string">"1,2,2"</span>;</span><br><span class="line"></span><br><span class="line">[] = [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line">(&#123;&#125; = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a,b,c,d,e,f;</span><br><span class="line">(&#123;a = <span class="number">1</span>, b = <span class="number">0</span>, <span class="attr">z</span>:c = <span class="number">3</span>&#125; = &#123;<span class="attr">b</span>:<span class="number">2</span>, <span class="attr">z</span>:<span class="literal">undefined</span>&#125;);</span><br><span class="line">[d = <span class="number">0</span>, e = <span class="number">5</span>, f = <span class="number">6</span>] = [<span class="number">4</span>,,<span class="literal">undefined</span>];</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="number">3</span></span><br><span class="line">  &amp;&amp; d === <span class="number">4</span> &amp;&amp; e === <span class="number">5</span> &amp;&amp; f === <span class="number">6</span>;</span><br></pre></td></tr></table></figure>
<h2 id="destructuring-parameters"><a href="#destructuring-parameters" class="headerlink" title="destructuring parameters"></a>destructuring parameters</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[a, , [b], c]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">5</span> &amp;&amp; b === <span class="number">6</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line">&#125;([<span class="number">5</span>, <span class="literal">null</span>, [<span class="number">6</span>]]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[a, , b]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="literal">undefined</span> &amp;&amp; b === <span class="literal">undefined</span>;</span><br><span class="line">&#125;([,,,]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[a, b, c]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="string">"a"</span> &amp;&amp; b === <span class="string">"b"</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line">&#125;(<span class="string">"ab"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[c]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> c === <span class="string">"𠮷"</span>;</span><br><span class="line">&#125;(<span class="string">"𠮷𠮶"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[a, b, c]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line">&#125;(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123; <span class="keyword">yield</span> <span class="number">1</span>; <span class="keyword">yield</span> <span class="number">2</span>; &#125;());</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[a, b, c]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line">&#125;(global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>]));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[a, b, c]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="literal">undefined</span>;</span><br><span class="line">&#125;(<span class="built_in">Object</span>.create(global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>])));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> closed = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> iter = global.__createIterableObject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], &#123;</span><br><span class="line">  <span class="string">'return'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; closed = <span class="literal">true</span>; <span class="keyword">return</span> &#123;&#125;; &#125;</span><br><span class="line">&#125;);</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">[a,b]</span>) </span>&#123;&#125;(iter));</span><br><span class="line"><span class="keyword">return</span> closed;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[a,]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span>;</span><br><span class="line">&#125;([<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">&#123;c, x:d, e&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> c === <span class="number">7</span> &amp;&amp; d === <span class="number">8</span> &amp;&amp; e === <span class="literal">undefined</span>;</span><br><span class="line">&#125;(&#123;<span class="attr">c</span>:<span class="number">7</span>, <span class="attr">x</span>:<span class="number">8</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">&#123;toFixed&#125;, &#123;slice&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> toFixed === <span class="built_in">Number</span>.prototype.toFixed</span><br><span class="line">    &amp;&amp; slice === <span class="built_in">String</span>.prototype.slice;</span><br><span class="line">&#125;(<span class="number">2</span>,<span class="string">''</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">&#123;a,&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span>;</span><br><span class="line">&#125;(&#123;<span class="attr">a</span>:<span class="number">1</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解构时候 null undefined 报错</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params">&#123;a&#125;</span>)</span>&#123;&#125;(<span class="literal">null</span>));</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params">&#123;b&#125;</span>)</span>&#123;&#125;(<span class="literal">undefined</span>));</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> qux = <span class="string">"corge"</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">&#123; [qux]: grault &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> grault === <span class="string">"garply"</span>;</span><br><span class="line">&#125;(&#123; <span class="attr">corge</span>: <span class="string">"garply"</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[e, &#123;x:f, g&#125;], &#123;h, x:[i]&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> e === <span class="number">9</span> &amp;&amp; f === <span class="number">10</span> &amp;&amp; g === <span class="literal">undefined</span></span><br><span class="line">    &amp;&amp; h === <span class="number">11</span> &amp;&amp; i === <span class="number">12</span>;</span><br><span class="line">&#125;([<span class="number">9</span>, &#123;<span class="attr">x</span>:<span class="number">10</span>&#125;],&#123;<span class="attr">h</span>:<span class="number">11</span>, <span class="attr">x</span>:[<span class="number">12</span>]&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span>(<span class="params">&#123;a, x:b, y:e&#125;, [c, d]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">arguments</span>[<span class="number">0</span>].a === <span class="number">1</span> &amp;&amp; <span class="built_in">arguments</span>[<span class="number">0</span>].x === <span class="number">2</span></span><br><span class="line">    &amp;&amp; !(<span class="string">"y"</span> <span class="keyword">in</span> <span class="built_in">arguments</span>[<span class="number">0</span>]) &amp;&amp; <span class="built_in">arguments</span>[<span class="number">1</span>] + <span class="string">''</span> === <span class="string">"3,4"</span>;</span><br><span class="line">&#125;(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">x</span>:<span class="number">2</span>&#125;, [<span class="number">3</span>, <span class="number">4</span>]));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"&#123;a, x:b, y:e&#125;"</span>,<span class="string">"[c, d]"</span>,</span><br><span class="line">  <span class="string">"return a === 1 &amp;&amp; b === 2 &amp;&amp; c === 3 &amp;&amp; "</span></span><br><span class="line">  + <span class="string">"d === 4 &amp;&amp; e === undefined;"</span></span><br><span class="line">)(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">x</span>:<span class="number">2</span>&#125;, [<span class="number">3</span>, <span class="number">4</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">&#123;a, b&#125;, [c, d]</span>)</span>&#123;&#125;.length === <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[a, ...b], [c, ...d]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">3</span> &amp;&amp; b <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; (b + <span class="string">""</span>) === <span class="string">"4,5"</span> &amp;&amp;</span><br><span class="line">     c === <span class="number">6</span> &amp;&amp; d <span class="keyword">instanceof</span> <span class="built_in">Array</span> &amp;&amp; d.length === <span class="number">0</span>;</span><br><span class="line">&#125;([<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">[],&#123;&#125;</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">arguments</span>[<span class="number">0</span>] + <span class="string">''</span> === <span class="string">"3,4"</span> &amp;&amp; <span class="built_in">arguments</span>[<span class="number">1</span>].x === <span class="string">"foo"</span>;</span><br><span class="line">&#125;([<span class="number">3</span>,<span class="number">4</span>],&#123;<span class="attr">x</span>:<span class="string">"foo"</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span>(<span class="params">&#123;a = <span class="number">1</span>, b = <span class="number">0</span>, c = <span class="number">3</span>, x:d = <span class="number">0</span>, y:e = <span class="number">5</span>&#125;,</span></span></span><br><span class="line"><span class="function"><span class="params">    [f = <span class="number">6</span>, g = <span class="number">0</span>, h = <span class="number">8</span>]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="number">3</span> &amp;&amp; d === <span class="number">4</span> &amp;&amp;</span><br><span class="line">    e === <span class="number">5</span> &amp;&amp; f === <span class="number">6</span> &amp;&amp; g === <span class="number">7</span> &amp;&amp; h === <span class="number">8</span>;</span><br><span class="line">&#125;(&#123;<span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="literal">undefined</span>, <span class="attr">x</span>:<span class="number">4</span>&#125;,[, <span class="number">7</span>, <span class="literal">undefined</span>]));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// defaults, separate scope</span></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    &#123;a=function(</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">typeof</span> b === <span class="string">'undefined'</span>;</span><br><span class="line">  &#125;&#125;</span><br><span class="line">)&#123;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> a();</span><br><span class="line">&#125;</span><br><span class="line">(&#123;&#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 转为</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> b === <span class="string">'undefined'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params">&#123;a: a&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> a();</span><br><span class="line">&#125;(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"&#123;a = 1, b = 0, c = 3, x:d = 0, y:e = 5&#125;"</span>,</span><br><span class="line">  <span class="string">"return a === 1 &amp;&amp; b === 2 &amp;&amp; c === 3 &amp;&amp; d === 4 &amp;&amp; e === 5;"</span></span><br><span class="line">)(&#123;<span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="literal">undefined</span>, <span class="attr">x</span>:<span class="number">4</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function">(<span class="params">(a, &#123;b: x = <span class="number">0</span>, c: y = <span class="number">3</span>&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; x === <span class="number">2</span> &amp;&amp; y === <span class="number">3</span>;</span><br><span class="line">&#125;)(<span class="number">1</span>, &#123;<span class="attr">b</span>: <span class="number">2</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function">(<span class="params">(a, &#123;b = <span class="number">0</span>, c = <span class="number">3</span>&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; b === <span class="number">2</span> &amp;&amp; c === <span class="number">3</span>;</span><br><span class="line">&#125;)(<span class="number">1</span>, &#123;<span class="attr">b</span>: <span class="number">2</span>&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Unicode-code-point-escapes"><a href="#Unicode-code-point-escapes" class="headerlink" title="Unicode code point escapes"></a>Unicode code point escapes</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="string">'\u&#123;1d306&#125;'</span> == <span class="string">'\ud834\udf06'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> \u&#123;<span class="number">102</span>C0&#125; = &#123; \u&#123;<span class="number">102</span>C0&#125; : <span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">return</span> \u&#123;<span class="number">102</span>C0&#125;[<span class="string">'\ud800\udec0'</span>] === <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<h2 id="new-target"><a href="#new-target" class="headerlink" title="new.target"></a>new.target</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> passed = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">new</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  passed = (<span class="keyword">new</span>.target === f);</span><br><span class="line">&#125;();</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  passed &amp;= (<span class="keyword">new</span>.target === <span class="literal">undefined</span>);</span><br><span class="line">&#125;());</span><br><span class="line"><span class="keyword">return</span> passed;</span><br></pre></td></tr></table></figure>
<h2 id="const"><a href="#const" class="headerlink" title="const"></a>const</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. 块级作用域</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. cannot be in statements</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bar = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="built_in">Function</span>(<span class="string">"if(true) const baz = 1;"</span>)();</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 重复定义报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. for forin forof</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. temporal dead zone</span></span><br></pre></td></tr></table></figure>
<h2 id="let"><a href="#let" class="headerlink" title="let"></a>let</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. 块级作用域</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. cannot be in statements</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bar = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="built_in">Function</span>(<span class="string">"if(true) let baz = 1;"</span>)();</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. for/for-in loop iteration scope</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> scopes = [];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">  scopes.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> i; &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> passed = (scopes[<span class="number">0</span>]() === <span class="number">0</span> &amp;&amp; scopes[<span class="number">1</span>]() === <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">scopes = [];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i <span class="keyword">in</span> &#123; <span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">1</span> &#125;) &#123;</span><br><span class="line">  scopes.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> i; &#125;);</span><br><span class="line">&#125;</span><br><span class="line">passed &amp;= (scopes[<span class="number">0</span>]() === <span class="string">"a"</span> &amp;&amp; scopes[<span class="number">1</span>]() === <span class="string">"b"</span>);</span><br><span class="line"><span class="keyword">return</span> passed;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. for forin</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. for-in loop binding shadowing parameter</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="built_in">Function</span>(<span class="string">"function f(e) &#123; for (let e in &#123;&#125;) e &#125;"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. temporal dead zone</span></span><br></pre></td></tr></table></figure>
<h3 id="block-level-function-declaration"><a href="#block-level-function-declaration" class="headerlink" title="block-level function declaration"></a>block-level function declaration</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">if</span> (f() !== <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (f() !== <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span> (f() !== <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (f() !== <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<h2 id="arrow-function"><a href="#arrow-function" class="headerlink" title="arrow function"></a>arrow function</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 词法this</span></span><br><span class="line"><span class="comment">// 2. call apply cannot</span></span><br><span class="line"><span class="comment">// 3. bind error</span></span><br><span class="line"><span class="comment">// 4. lexical arguments</span></span><br><span class="line"><span class="keyword">var</span> f = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="function"><span class="params">z</span> =&gt;</span> <span class="built_in">arguments</span>[<span class="number">0</span>]; &#125;(<span class="number">5</span>));</span><br><span class="line"><span class="keyword">return</span> f(<span class="number">6</span>) === <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. no "prototype" property</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. lexical "super" binding in constructor</span></span><br><span class="line"><span class="keyword">var</span> received;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> (arg) &#123;</span><br><span class="line">    received = arg;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="keyword">var</span> callSuper = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">super</span>(<span class="string">'foo'</span>);</span><br><span class="line">    callSuper();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C <span class="keyword">instanceof</span> C &amp;&amp; received === <span class="string">'foo'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. lexical "super" binding in methods</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  qux() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"quux"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  baz() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">x</span> =&gt;</span> <span class="keyword">super</span>.qux();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arrow = <span class="keyword">new</span> C().baz();</span><br><span class="line"><span class="keyword">return</span> arrow() === <span class="string">"quux"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8. lexical "new.target" binding</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">C</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">x</span> =&gt;</span> <span class="keyword">new</span>.target;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C()() === C &amp;&amp; C()() === <span class="literal">undefined</span>;</span><br></pre></td></tr></table></figure>
<h2 id="class"><a href="#class" class="headerlink" title="class"></a>class</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. block-scoped</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> c1 = C;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;&#125;</span><br><span class="line">  <span class="keyword">var</span> c2 = C;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> C === c1;</span><br><span class="line"></span><br><span class="line"><span class="comment">// string-keyed methods</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="string">"foo bar"</span>() &#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> C.prototype[<span class="string">"foo bar"</span>] === <span class="string">"function"</span></span><br><span class="line">  &amp;&amp; <span class="keyword">new</span> C()[<span class="string">"foo bar"</span>]() === <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// computed prototype methods</span></span><br><span class="line"> <span class="keyword">var</span> foo = <span class="string">"method"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  [foo]() &#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> C.prototype.method === <span class="string">"function"</span></span><br><span class="line">  &amp;&amp; <span class="keyword">new</span> C().method() === <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可选分号</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  ;</span><br><span class="line">  method() &#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;;</span><br><span class="line">  method2() &#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;</span><br><span class="line">  method3() &#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> C.prototype.method === <span class="string">"function"</span></span><br><span class="line">  &amp;&amp; <span class="keyword">typeof</span> C.prototype.method2 === <span class="string">"function"</span></span><br><span class="line">  &amp;&amp; <span class="keyword">typeof</span> C.prototype.method3 === <span class="string">"function"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// static method</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> method() &#123; <span class="keyword">return</span> <span class="number">3</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> C.method === <span class="string">"function"</span></span><br><span class="line">  &amp;&amp; C.method() === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="string">"method"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> [foo]() &#123; <span class="keyword">return</span> <span class="number">3</span>; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> C.method === <span class="string">"function"</span></span><br><span class="line">    &amp;&amp; C.method() === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// computed static methods</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="string">"method"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> [foo]() &#123; <span class="keyword">return</span> <span class="number">3</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> C.method === <span class="string">"function"</span></span><br><span class="line">  &amp;&amp; C.method() === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// accessor properties</span></span><br><span class="line">  <span class="keyword">var</span> baz = <span class="literal">false</span>;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">get</span> foo() &#123; <span class="keyword">return</span> <span class="string">"foo"</span>; &#125;</span><br><span class="line">    <span class="keyword">set</span> bar(x) &#123; baz = x; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">new</span> C().bar = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> C().foo === <span class="string">"foo"</span> &amp;&amp; baz;</span><br><span class="line"></span><br><span class="line"><span class="comment">// computed accessor properties</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> garply = <span class="string">"foo"</span>, grault = <span class="string">"bar"</span>, baz = <span class="literal">false</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">get</span> [garply]() &#123; <span class="keyword">return</span> <span class="string">"foo"</span>; &#125;</span><br><span class="line">  <span class="keyword">set</span> [grault](x) &#123; baz = x; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> C().bar = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().foo === <span class="string">"foo"</span> &amp;&amp; baz;</span><br><span class="line"></span><br><span class="line"><span class="comment">// computed accessor properites</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> baz = <span class="literal">false</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> foo() &#123; <span class="keyword">return</span> <span class="string">"foo"</span>; &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">set</span> bar(x) &#123; baz = x; &#125;</span><br><span class="line">&#125;</span><br><span class="line">C.bar = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> C.foo === <span class="string">"foo"</span> &amp;&amp; baz;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Computed static accessor properties</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> garply = <span class="string">"foo"</span>, grault = <span class="string">"bar"</span>, baz = <span class="literal">false</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> [garply]() &#123; <span class="keyword">return</span> <span class="string">"foo"</span>; &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">set</span> [grault](x) &#123; baz = x; &#125;</span><br><span class="line">&#125;</span><br><span class="line">C.bar = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">return</span> C.foo === <span class="string">"foo"</span> &amp;&amp; baz;</span><br><span class="line"></span><br><span class="line"><span class="comment">// class name is lexically scoped</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  method() &#123; <span class="keyword">return</span> <span class="keyword">typeof</span> C === <span class="string">"function"</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> M = C.prototype.method;</span><br><span class="line">C = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">return</span> C === <span class="literal">undefined</span> &amp;&amp; M();</span><br><span class="line"></span><br><span class="line"><span class="comment">// computed names, temporal dead zone</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> B = <span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    [C]()&#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// methods aren't enumerable</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  foo() &#123;&#125;</span><br><span class="line">  <span class="keyword">static</span> bar() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> !C.prototype.propertyIsEnumerable(<span class="string">"foo"</span>) &amp;&amp; !C.propertyIsEnumerable(<span class="string">"bar"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// implicit strict mode</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> method() &#123; <span class="keyword">return</span> <span class="keyword">this</span> === <span class="literal">undefined</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> (<span class="number">0</span>,C.method)();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// constructor requires new</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  C();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// extends</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C() <span class="keyword">instanceof</span> B</span><br><span class="line">  &amp;&amp; B.isPrototypeOf(C);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extends expression</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> B;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> (<span class="title">B</span> </span>= <span class="class"><span class="keyword">class</span> </span>&#123;&#125;) &#123;&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C() <span class="keyword">instanceof</span> B</span><br><span class="line">  &amp;&amp; B.isPrototypeOf(C);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extends null</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">null</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123; <span class="keyword">return</span> <span class="built_in">Object</span>.create(<span class="literal">null</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Function</span>.prototype.isPrototypeOf(C)</span><br><span class="line">  &amp;&amp; <span class="built_in">Object</span>.getPrototypeOf(C.prototype) === <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// new.target</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> passed = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">new</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  passed = <span class="keyword">new</span>.target === f;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    passed &amp;= <span class="keyword">new</span>.target === B;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"><span class="keyword">new</span> B();</span><br><span class="line"><span class="keyword">return</span> passed;</span><br></pre></td></tr></table></figure>
<h2 id="super"><a href="#super" class="headerlink" title="super"></a>super</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// statement in constructors</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> passed = <span class="literal">false</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(a) &#123; passed = (a === <span class="string">"barbaz"</span>); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(a) &#123; <span class="keyword">super</span>(<span class="string">"bar"</span> + a); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> C(<span class="string">"baz"</span>);</span><br><span class="line"><span class="keyword">return</span> passed;</span><br><span class="line"></span><br><span class="line"><span class="comment">// expression in constructors</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(a) &#123; <span class="keyword">return</span> [<span class="string">"foo"</span> + a]; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(a) &#123; <span class="keyword">return</span> <span class="keyword">super</span>(<span class="string">"bar"</span> + a); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C(<span class="string">"baz"</span>)[<span class="number">0</span>] === <span class="string">"foobarbaz"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in methods, property access</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;&#125;</span><br><span class="line">B.prototype.qux = <span class="string">"foo"</span>;</span><br><span class="line">B.prototype.corge = <span class="string">"baz"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  quux(a) &#123; <span class="keyword">return</span> <span class="keyword">super</span>.qux + a + <span class="keyword">super</span>[<span class="string">"corge"</span>]; &#125;</span><br><span class="line">&#125;</span><br><span class="line">C.prototype.qux = <span class="string">"garply"</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().quux(<span class="string">"bar"</span>) === <span class="string">"foobarbaz"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in methods, method calls</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  qux(a) &#123; <span class="keyword">return</span> <span class="string">"foo"</span> + a; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  qux(a) &#123; <span class="keyword">return</span> <span class="keyword">super</span>.qux(<span class="string">"bar"</span> + a); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().qux(<span class="string">"baz"</span>) === <span class="string">"foobarbaz"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// method calls use correct "this" binding</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  qux(a) &#123; <span class="keyword">return</span> <span class="keyword">this</span>.foo + a; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  qux(a) &#123; <span class="keyword">return</span> <span class="keyword">super</span>.qux(<span class="string">"bar"</span> + a); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> C();</span><br><span class="line">obj.foo = <span class="string">"foo"</span>;</span><br><span class="line"><span class="keyword">return</span> obj.qux(<span class="string">"baz"</span>) === <span class="string">"foobarbaz"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// constructor calls use correct "new.target" binding</span></span><br><span class="line"><span class="keyword">var</span> passed;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123; passed = (<span class="keyword">new</span>.target === C); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123; <span class="keyword">super</span>(); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> C();</span><br><span class="line"><span class="keyword">return</span> passed;</span><br><span class="line"></span><br><span class="line"><span class="comment">// is statically bound</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  qux() &#123; <span class="keyword">return</span> <span class="string">"bar"</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  qux() &#123; <span class="keyword">return</span> <span class="keyword">super</span>.qux() + <span class="keyword">this</span>.corge; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  qux: C.prototype.qux,</span><br><span class="line">  corge: <span class="string">"ley"</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">return</span> obj.qux() === <span class="string">"barley"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// super() invokes the correct constructor</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// checks that super() is *not* a synonym of super.constructor()</span></span><br><span class="line"><span class="keyword">var</span> passed;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        passed = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">B.prototype.constructor = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    passed = <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">B</span> </span>&#123; &#125;;</span><br><span class="line"><span class="keyword">new</span> C;</span><br><span class="line"><span class="keyword">return</span> passed;</span><br></pre></td></tr></table></figure>
<h2 id="Object-static-method"><a href="#Object-static-method" class="headerlink" title="Object static method"></a>Object static method</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.assign</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.is</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertySymbols</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.setPrototypeOf</span><br></pre></td></tr></table></figure>
<h2 id="function-name-property"><a href="#function-name-property" class="headerlink" title="function name property"></a>function name property</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">return</span> foo.name === <span class="string">'foo'</span> &amp;&amp;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).name === <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;&#125;).name === <span class="string">'foo'</span> &amp;&amp; (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).name === <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">new</span> <span class="built_in">Function</span>).name === <span class="string">"anonymous"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">return</span> foo.bind(&#123;&#125;).name === <span class="string">"bound foo"</span> &amp;&amp; (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).bind(&#123;&#125;).name === <span class="string">"bound "</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">return</span> foo.name === <span class="string">"foo"</span> &amp;&amp; bar.name === <span class="string">"baz"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123; <span class="attr">foo</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;, <span class="attr">bar</span>: <span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>)</span>&#123;&#125;&#125;;</span><br><span class="line">o.qux = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">return</span> o.foo.name === <span class="string">"foo"</span> &amp;&amp;</span><br><span class="line">       o.bar.name === <span class="string">"baz"</span> &amp;&amp;</span><br><span class="line">       o.qux.name === <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123; <span class="keyword">get</span> foo()&#123;&#125;, <span class="keyword">set</span> foo(x)&#123;&#125; &#125;;</span><br><span class="line"><span class="keyword">var</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(o, <span class="string">"foo"</span>);</span><br><span class="line"><span class="keyword">return</span> descriptor.get.name === <span class="string">"get foo"</span> &amp;&amp;</span><br><span class="line">       descriptor.set.name === <span class="string">"set foo"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123; foo()&#123;&#125; &#125;;</span><br><span class="line"><span class="keyword">return</span> o.foo.name === <span class="string">"foo"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f = <span class="string">"foo"</span>;</span><br><span class="line"><span class="keyword">return</span> (&#123;f() &#123; <span class="keyword">return</span> f; &#125;&#125;).f() === <span class="string">"foo"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sym1 = <span class="built_in">Symbol</span>(<span class="string">"foo"</span>);</span><br><span class="line"><span class="keyword">var</span> sym2 = <span class="built_in">Symbol</span>();</span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  [sym1]: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">  [sym2]: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> o[sym1].name === <span class="string">"[foo]"</span> &amp;&amp;</span><br><span class="line">       o[sym2].name === <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">foo</span> </span>&#123;&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">bar</span> </span>&#123; <span class="keyword">static</span> name() &#123;&#125; &#125;;</span><br><span class="line"><span class="keyword">return</span> foo.name === <span class="string">"foo"</span> &amp;&amp;</span><br><span class="line"><span class="keyword">typeof</span> bar.name === <span class="string">"function"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">foo</span> </span>&#123;&#125;.name === <span class="string">"foo"</span> &amp;&amp;</span><br><span class="line">  <span class="keyword">typeof</span> <span class="class"><span class="keyword">class</span> <span class="title">bar</span> </span>&#123; <span class="keyword">static</span> name() &#123;&#125; &#125;.name === <span class="string">"function"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="class"><span class="keyword">class</span> </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> bar = <span class="class"><span class="keyword">class</span> <span class="title">baz</span> </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> qux = <span class="class"><span class="keyword">class</span> </span>&#123; <span class="keyword">static</span> name() &#123;&#125; &#125;;</span><br><span class="line">  <span class="keyword">return</span> foo.name === <span class="string">"foo"</span> &amp;&amp;</span><br><span class="line">         bar.name === <span class="string">"baz"</span> &amp;&amp;</span><br><span class="line">         <span class="keyword">typeof</span> qux.name === <span class="string">"function"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123; foo()&#123;&#125; &#125;;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">new</span> C).foo.name === <span class="string">"foo"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123; <span class="keyword">static</span> foo()&#123;&#125; &#125;;</span><br><span class="line"><span class="keyword">return</span> C.foo.name === <span class="string">"foo"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// isn't writable isn't configurable</span></span><br><span class="line"><span class="keyword">var</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="string">"name"</span>);</span><br><span class="line"><span class="keyword">return</span> descriptor.enumerable   === <span class="literal">false</span> &amp;&amp;</span><br><span class="line">       descriptor.writable     === <span class="literal">false</span> &amp;&amp;</span><br><span class="line">       descriptor.configurable === <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<h2 id="String-static-method"><a href="#String-static-method" class="headerlink" title="String static method"></a>String static method</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">String</span>.raw()</span><br><span class="line"><span class="comment">// 是用来获取一个模板字符串的原始字符串的</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>.fromCodePoint()</span><br><span class="line"><span class="comment">// 使用指定的代码点序列创建的字符串</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>.fromCharCode()</span><br><span class="line"><span class="comment">// 返回由指定的UTF-16代码单元序列创建的字符串</span></span><br></pre></td></tr></table></figure>
<h2 id="String-prototype-methods"><a href="#String-prototype-methods" class="headerlink" title="String prototype methods"></a>String prototype methods</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// codePointAt 返回 一个 Unicode 编码点值的非负整数</span></span><br><span class="line"></span><br><span class="line">str.codePointAt(pos)</span><br><span class="line"></span><br><span class="line"><span class="string">'ABC'</span>.codePointAt(<span class="number">1</span>);          <span class="comment">// 66</span></span><br><span class="line"><span class="string">'\uD800\uDC00'</span>.codePointAt(<span class="number">0</span>); <span class="comment">// 65536</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// normalize  不常用</span></span><br><span class="line"></span><br><span class="line">repeat</span><br><span class="line"></span><br><span class="line">startsWith</span><br><span class="line"></span><br><span class="line">endsWith</span><br><span class="line"></span><br><span class="line">includes  </span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>.prototype[<span class="built_in">Symbol</span>.iterator]</span><br><span class="line"></span><br><span class="line"><span class="comment">// String iterator prototype chain</span></span><br></pre></td></tr></table></figure>
<h2 id="Array-methods"><a href="#Array-methods" class="headerlink" title="Array methods"></a>Array methods</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.from() <span class="comment">// 1. array-like  2. generator instance 3. generic iterator</span></span><br><span class="line"><span class="comment">// Array.from() 方法从一个类似数组或可迭代对象创建一个新的，浅拷贝的数组实例</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.of()</span><br><span class="line"><span class="comment">// Array.of() 方法创建一个具有可变数量参数的新数组实例，而不考虑参数的数量或类型</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.of(<span class="number">7</span>);       <span class="comment">// [7]</span></span><br><span class="line"><span class="built_in">Array</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>(<span class="number">7</span>);          <span class="comment">// [ , , , , , , ]</span></span><br><span class="line"><span class="built_in">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);    <span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>[<span class="built_in">Symbol</span>.species]</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> prop = <span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="built_in">Array</span>, <span class="built_in">Symbol</span>.species);</span><br><span class="line"><span class="keyword">return</span> <span class="string">'get'</span> <span class="keyword">in</span> prop &amp;&amp; <span class="built_in">Array</span>[<span class="built_in">Symbol</span>.species] === <span class="built_in">Array</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">copyWithIn</span><br><span class="line"><span class="comment">// copyWithin() 方法浅复制数组的一部分到同一数组中的另一个位置，并返回它，不会改变原数组的长度</span></span><br><span class="line"><span class="comment">// arr.copyWithin(targetPos[, start[, end]]) 包括 end 这个位置的元素</span></span><br><span class="line"></span><br><span class="line">find</span><br><span class="line"></span><br><span class="line">findIndex</span><br><span class="line"></span><br><span class="line">fill</span><br><span class="line"></span><br><span class="line">keys</span><br><span class="line"></span><br><span class="line">values</span><br><span class="line"></span><br><span class="line">entries</span><br><span class="line"></span><br><span class="line">includes</span><br></pre></td></tr></table></figure>
<h2 id="Number-methods"><a href="#Number-methods" class="headerlink" title="Number methods"></a>Number methods</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">isFinite</span></span><br><span class="line"></span><br><span class="line">isInteger</span><br><span class="line"></span><br><span class="line">isSafeInteger</span><br><span class="line"></span><br><span class="line">inNaN</span><br></pre></td></tr></table></figure>
<h2 id="2016"><a href="#2016" class="headerlink" title="2016"></a>2016</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.includes((valueToFind[, fromIndex])</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// generator function cannot be use with new</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// generator function</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> * <span class="title">generator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> * (<span class="function"><span class="keyword">function</span> * (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'foo'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">yield</span> <span class="string">'bar'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> iter = generator();</span><br><span class="line">iter.next();</span><br><span class="line"><span class="keyword">return</span> iter[<span class="string">'throw'</span>]().value === <span class="string">'bar'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// nest rest destructuring declaration</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> [x, ...[y, ...z]] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">return</span> x === <span class="number">1</span> &amp;&amp; y === <span class="number">2</span> &amp;&amp; z + <span class="string">''</span> === <span class="string">'3,4'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// nest rest destructuring parameter</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">[x, ...[y, ...z]]</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x === <span class="number">1</span> &amp;&amp; y === <span class="number">2</span> &amp;&amp; z + <span class="string">''</span> === <span class="string">'3,4'</span>;</span><br><span class="line">&#125;([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Proxy "enumerate" handler removed</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> passed = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">enumerate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">passed = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> proxy); <span class="comment">// Should not throw, nor execute the 'enumerate' method.</span></span><br><span class="line"><span class="keyword">return</span> passed;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Proxy internal calls, Array.prototype.includes</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Array.prototype.includes -&gt; Get -&gt; [[Get]]</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">get</span> = [];</span><br><span class="line">var p = new Proxy(&#123;length: <span class="number">3</span>, <span class="number">0</span>: <span class="string">''</span>, <span class="number">1</span>: <span class="string">''</span>, <span class="number">2</span>: <span class="string">''</span>, <span class="number">3</span>: <span class="string">''</span>&#125;, &#123; <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">o, k</span>) </span>&#123; <span class="keyword">get</span>.push(k); return o[k]; &#125;&#125;);</span><br><span class="line">Array.prototype.includes.call(p, &#123;&#125;);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">get</span> + '' !== "length,0,1,2") return;</span><br><span class="line"></span><br><span class="line"><span class="keyword">get</span> = [];</span><br><span class="line">p = new Proxy(&#123;length: <span class="number">4</span>, <span class="number">0</span>: <span class="literal">NaN</span>, <span class="number">1</span>: <span class="string">''</span>, <span class="number">2</span>: <span class="literal">NaN</span>, <span class="number">3</span>: <span class="string">''</span>&#125;, &#123; <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">o, k</span>) </span>&#123; <span class="keyword">get</span>.push(k); return o[k]; &#125;&#125;);</span><br><span class="line">Array.prototype.includes.call(p, NaN, 1);</span><br><span class="line">return (<span class="keyword">get</span> + '' === "length,1,2");</span><br></pre></td></tr></table></figure>
<h2 id="2017"><a href="#2017" class="headerlink" title="2017"></a>2017</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Object static method</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.values()</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.entries()</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptors()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Object.getOwnPropertyDescriptors doesn't provide undefined descriptors</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>.prototype.padStart</span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>.prototype.padEnd</span><br><span class="line"></span><br><span class="line"><span class="comment">// traling commas in function syntax</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"> a, b, </span>)</span>&#123;&#125; === <span class="string">'function'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Math</span>.min(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,) === <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// async function</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. return</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"foo"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = a();</span><br><span class="line"><span class="keyword">if</span> (!(p <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">"foo"</span>) &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. throw</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="string">"foo"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = a();</span><br><span class="line"><span class="keyword">if</span> (!(p <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">p.catch(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">"foo"</span>) &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. no line break between async and function</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">try</span> &#123; <span class="built_in">Function</span>(<span class="string">"async\n function a()&#123;&#125;"</span>)(); &#125; <span class="keyword">catch</span>(e) &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. no "prototype" property  </span></span><br><span class="line"><span class="comment">// async函数没有原型属性 原因</span></span><br><span class="line"><span class="comment">// async函数不能作为构造函数用来通过new返回一个对象 只会函数调用方式返回一个Promise</span></span><br><span class="line"><span class="comment">// 所以没有prototype属性</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line"><span class="keyword">return</span> !a.hasOwnProperty(<span class="string">"prototype"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(a.hasOwnProperty(<span class="string">"prototype"</span>)) <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(a.prototype) <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// AsyncFunction 构造函数用来创建新的 异步函数 对象，JavaScript 中每个异步函数都是  AsyncFunction 的对象。</span></span><br><span class="line"><span class="comment">// AsyncFunction 并不是一个全局对象，需要通过下面的方法来获取：</span></span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).constructor</span><br><span class="line"><span class="comment">// 使用 AsyncFunction 构造函数创建的异步函数 并不会在当前上下文中创建闭包，其作用域始终是全局的。</span></span><br><span class="line"><span class="comment">// 因此运行的时候只能访问它们自己的本地变量和全局变量，但不能访问构造函数被调用的那个作用域中的变量。</span></span><br><span class="line"><span class="comment">// 这是它与 eval 不同的地方。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// correct prototype chain</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> asyncFunctionProto = <span class="built_in">Object</span>.getPrototypeOf(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line"><span class="keyword">return</span> asyncFunctionProto !== <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;.prototype</span><br><span class="line">  &amp;&amp; <span class="built_in">Object</span>.getPrototypeOf(asyncFunctionProto) === <span class="built_in">Function</span>.prototype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> asyncFunctionProto = <span class="built_in">Object</span>.getPrototypeOf(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(asyncFunctionProto) <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(asyncFunctionProto !== <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;.prototype) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(asyncFunctionProto) === <span class="built_in">Function</span>.prototype) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve();</span><br><span class="line">  <span class="keyword">var</span> a1 = <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123; setTimeout(resolve,<span class="number">800</span>,<span class="string">"foo"</span>); &#125;);</span><br><span class="line">  <span class="keyword">var</span> a2 = <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123; setTimeout(resolve,<span class="number">800</span>,<span class="string">"bar"</span>); &#125;);</span><br><span class="line">  <span class="keyword">if</span> (a1 + a2 === <span class="string">"foobar"</span>) &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">// rejection</span></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve();</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a1 = <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">_, reject</span>) </span>&#123; setTimeout(reject,<span class="number">800</span>,<span class="string">"foo"</span>); &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (e === <span class="string">"foo"</span>) &#123;</span><br><span class="line">      asyncTestPassed();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">// must await a value</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123; <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(); &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; <span class="built_in">Function</span>(<span class="string">"(async function a()&#123; await; &#125;())"</span>)(); &#125; <span class="keyword">catch</span>(e) &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// an await non-Promise values</span></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve();</span><br><span class="line">  <span class="keyword">var</span> e = <span class="keyword">await</span> <span class="string">"foo"</span>;</span><br><span class="line">  <span class="keyword">if</span> (e === <span class="string">"foo"</span>) &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;());</span><br><span class="line"></span><br><span class="line"><span class="comment">// cannot await in parameters</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123; <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(); &#125;</span><br><span class="line"><span class="keyword">try</span> &#123; <span class="built_in">Function</span>(<span class="string">"(async function a(b = await Promise.resolve())&#123;&#125;())"</span>)(); &#125; <span class="keyword">catch</span>(e) &#123; <span class="keyword">return</span> <span class="literal">true</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// async methods, object literals</span></span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  <span class="keyword">async</span> a()&#123; <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="string">"foo"</span>); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = o.a();</span><br><span class="line"><span class="keyword">if</span> (!(p <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">"foo"</span>) &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// async methods, class</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">async</span> a()&#123; <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="string">"foo"</span>); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> C().a();</span><br><span class="line"><span class="keyword">if</span> (!(p <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">"foo"</span>) &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// async arrow functions in methods, classes</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  callback();</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  a()&#123;</span><br><span class="line">    doSomething(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="number">1</span>;</span><br><span class="line">      asyncTestPassed();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> C().a();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// async arrow functions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">async</span> () =&gt; <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="string">"foo"</span>);</span><br><span class="line"><span class="keyword">var</span> p = a();</span><br><span class="line"><span class="keyword">if</span> (!(p <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">"foo"</span>) &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// async function prototype, Symbol.toStringTag</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Object</span>.getPrototypeOf(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;&#125;)[<span class="built_in">Symbol</span>.toStringTag] === <span class="string">"AsyncFunction"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// async function constructor</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;&#125;.constructor(<span class="string">"return 'foo';"</span>);</span><br><span class="line"><span class="keyword">var</span> p = a();</span><br><span class="line"><span class="keyword">if</span> (!(p <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">"foo"</span>) &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;&#125;.constructor(<span class="string">"return 'foo';"</span>);</span><br><span class="line"><span class="keyword">var</span> p = a();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(p <span class="keyword">instanceof</span> <span class="built_in">Promise</span>) <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">"foo"</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">123</span>) <span class="comment">// 123</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// arguments.caller removed</span></span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="meta">  'use strict'</span>;</span><br><span class="line">  <span class="keyword">return</span> !<span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="built_in">arguments</span>,<span class="string">'caller'</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h2 id="2018"><a href="#2018" class="headerlink" title="2018"></a>2018</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// object rest/spread properties</span></span><br><span class="line"><span class="keyword">var</span> &#123;a, ...rest&#125; = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>&#125;;</span><br><span class="line"><span class="keyword">return</span> a === <span class="number">1</span> &amp;&amp; rest.a === <span class="keyword">void</span> <span class="literal">undefined</span> &amp;&amp; rest.b === <span class="number">2</span> &amp;&amp; rest.c === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> spread = &#123;<span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> O = &#123;<span class="attr">a</span>: <span class="number">1</span>, ...spread&#125;;</span><br><span class="line"><span class="keyword">return</span> O !== spread &amp;&amp; (O.a + O.b + O.c) === <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// finally</span></span><br><span class="line"><span class="built_in">Promise</span>.prototype.finally</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">const</span> regex = <span class="regexp">/foo.bar/</span>s;</span><br><span class="line"><span class="keyword">return</span> regex.test(<span class="string">'foo\nbar'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>*<span class="title">generator</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iterator = generator();</span><br><span class="line">iterator.next().then(<span class="function"><span class="keyword">function</span>(<span class="params">step</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(iterator[<span class="built_in">Symbol</span>.asyncIterator]() === iterator &amp;&amp; step.done === <span class="literal">false</span> &amp;&amp; step.value === <span class="number">42</span>)asyncTestPassed();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// for await of</span></span><br><span class="line"><span class="keyword">var</span> asyncIterable = &#123;&#125;;</span><br><span class="line">asyncIterable[<span class="built_in">Symbol</span>.asyncIterator] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    next: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">switch</span>(++i)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(&#123;<span class="attr">done</span>: <span class="literal">false</span>, <span class="attr">value</span>: <span class="string">'a'</span>&#125;);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(&#123;<span class="attr">done</span>: <span class="literal">false</span>, <span class="attr">value</span>: <span class="string">'b'</span>&#125;);</span><br><span class="line">      &#125; <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(&#123;<span class="attr">done</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">for</span> <span class="keyword">await</span>(<span class="keyword">var</span> value <span class="keyword">of</span> asyncIterable)result += value;</span><br><span class="line">  <span class="keyword">if</span>(result === <span class="string">'ab'</span>)asyncTestPassed();</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">  ownKeys() &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">"a"</span>, <span class="string">"a"</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="built_in">Object</span>.keys(p);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">   <span class="keyword">return</span> e <span class="keyword">instanceof</span> <span class="built_in">TypeError</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<h2 id="2019"><a href="#2019" class="headerlink" title="2019"></a>2019</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. fromEntries entries</span></span><br><span class="line"><span class="comment">// Object.fromEntries() 方法把键值对列表转换为一个对象</span></span><br><span class="line"><span class="keyword">var</span> object = <span class="built_in">Object</span>.fromEntries(<span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">'foo'</span>, <span class="number">42</span>], [<span class="string">'bar'</span>, <span class="number">23</span>]]));</span><br><span class="line"><span class="keyword">return</span> object.foo === <span class="number">42</span> &amp;&amp; object.bar === <span class="number">23</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// String triming</span></span><br><span class="line"><span class="built_in">String</span>.prototype.trimLeft == <span class="built_in">String</span>.prototype.trimStart</span><br><span class="line"></span><br><span class="line"><span class="built_in">String</span>.prototype.trimRight == <span class="built_in">String</span>.prototype.trimEnd</span><br><span class="line"></span><br><span class="line"><span class="comment">// Array flat</span></span><br><span class="line"><span class="keyword">return</span> [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>]]].flat().join(<span class="string">''</span>) === <span class="string">'12345,6'</span>;</span><br><span class="line"><span class="comment">// flat() 方法会按照一个可指定的深度递归遍历数组，并将所有元素与遍历到的子数组中的元素合并为一个新数组返回。</span></span><br><span class="line"><span class="keyword">var</span> newArray = arr.flat([depth])</span><br><span class="line"></span><br><span class="line"><span class="comment">// Array flatMap</span></span><br><span class="line"><span class="comment">// flatMap() 方法首先使用映射函数映射每个元素，然后将结果压缩成一个新数组</span></span><br><span class="line"><span class="comment">// 它与 map 连着深度值为1的 flat 几乎相同，但 flatMap 通常在合并成一种方法的效率稍微高一些</span></span><br><span class="line"><span class="keyword">return</span> [&#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;, &#123;<span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span>&#125;].flatMap(<span class="function"><span class="keyword">function</span> (<span class="params">it</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [it.a, it.b];</span><br><span class="line">&#125;).join(<span class="string">''</span>) === <span class="string">'1234'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// optional catch binding</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> &#123; <span class="comment">// not error</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// try catch await</span></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="built_in">Promise</span>.reject();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> &#123;</span><br><span class="line">    asyncTestPassed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">// yield</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">yield</span>;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> it = foo();</span><br><span class="line">it.next();</span><br><span class="line"><span class="keyword">return</span> it.next().value;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Symbol.prototype.description</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Symbol</span>(<span class="string">'foo'</span>).description === <span class="string">'foo'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// empty description</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Symbol</span>(<span class="string">''</span>).description === <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// undefined description</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Symbol</span>.prototype.hasOwnProperty(<span class="string">'description'</span>)</span><br><span class="line">  &amp;&amp; <span class="built_in">Symbol</span>().description === <span class="keyword">void</span> <span class="literal">undefined</span>;</span><br></pre></td></tr></table></figure>
<h2 id="2020"><a href="#2020" class="headerlink" title="2020"></a>2020</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// String.prototype.matchAll</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Bigint</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise.allSettled</span></span><br><span class="line"><span class="built_in">Promise</span>.allSettled([</span><br><span class="line">  <span class="built_in">Promise</span>.resolve(<span class="number">1</span>),</span><br><span class="line">  <span class="built_in">Promise</span>.reject(<span class="number">2</span>),</span><br><span class="line">  <span class="built_in">Promise</span>.resolve(<span class="number">3</span>)</span><br><span class="line">]).then(<span class="function"><span class="params">it</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    it.length === <span class="number">3</span> &amp;&amp;</span><br><span class="line">    it[<span class="number">0</span>].status === <span class="string">'fulfilled'</span> &amp;&amp; it[<span class="number">0</span>].value === <span class="number">1</span> &amp;&amp;</span><br><span class="line">    it[<span class="number">1</span>].status === <span class="string">'rejected'</span> &amp;&amp; it[<span class="number">1</span>].reason === <span class="number">2</span> &amp;&amp;</span><br><span class="line">    it[<span class="number">2</span>].status === <span class="string">'fulfilled'</span> &amp;&amp; it[<span class="number">2</span>].value === <span class="number">3</span></span><br><span class="line">  ) asyncTestPassed();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// globalThis</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. "globalThis" global property is global object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> actualGlobal = <span class="built_in">Function</span>(<span class="string">'return this'</span>)();</span><br><span class="line">actualGlobal.__system_global_test__ = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> globalThis === <span class="string">'object'</span></span><br><span class="line">&amp;&amp; globalThis</span><br><span class="line">&amp;&amp; globalThis === actualGlobal</span><br><span class="line">&amp;&amp; !globalThis.lacksGlobalThis</span><br><span class="line">&amp;&amp; globalThis.__system_global_test__ === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Optional Chaining ?.</span></span><br><span class="line"><span class="keyword">var</span> foo = &#123; <span class="attr">baz</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> bar = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">return</span> foo?.baz === <span class="number">42</span> &amp;&amp; bar?.baz === <span class="keyword">void</span> <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = &#123; <span class="attr">baz</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> bar = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">return</span> foo?.[<span class="string">'baz'</span>] === <span class="number">42</span> &amp;&amp; bar?.[<span class="string">'baz'</span>] === <span class="keyword">void</span> <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = &#123; <span class="attr">baz</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.value; &#125;, <span class="attr">value</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> bar = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">return</span> foo?.baz() === <span class="number">42</span> &amp;&amp; bar?.baz() === <span class="keyword">void</span> <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = &#123; <span class="attr">baz</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">42</span>; &#125; &#125;;</span><br><span class="line"><span class="keyword">var</span> bar = &#123;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">42</span>; &#125;;</span><br><span class="line"><span class="keyword">var</span> n;</span><br><span class="line"><span class="keyword">return</span> foo.baz?.() === <span class="number">42</span> &amp;&amp; bar.baz?.() === <span class="keyword">void</span> <span class="literal">undefined</span> &amp;&amp; baz?.() === <span class="number">42</span> &amp;&amp; n?.() === <span class="keyword">void</span> <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// nullish coalescing operator (??)</span></span><br><span class="line"><span class="comment">// coalesce v 联合</span></span><br><span class="line"><span class="keyword">return</span> (<span class="literal">null</span> ?? <span class="number">42</span>) === <span class="number">42</span> &amp;&amp;</span><br><span class="line">  (<span class="literal">undefined</span> ?? <span class="number">42</span>) === <span class="number">42</span> &amp;&amp;</span><br><span class="line">  (<span class="literal">false</span> ?? <span class="number">42</span>) === <span class="literal">false</span> &amp;&amp;</span><br><span class="line">  (<span class="string">''</span> ?? <span class="number">42</span>) === <span class="string">''</span> &amp;&amp;</span><br><span class="line">  (<span class="number">0</span> ?? <span class="number">42</span>) === <span class="number">0</span> &amp;&amp;</span><br><span class="line">  <span class="built_in">isNaN</span>(<span class="literal">NaN</span> ?? <span class="number">42</span>);</span><br></pre></td></tr></table></figure>
<h2 id="next"><a href="#next" class="headerlink" title="next"></a>next</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 1. public instance class field</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  x = <span class="string">'x'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x === <span class="string">'x'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. private instance class field  #</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  #x;</span><br><span class="line">  <span class="keyword">constructor</span>(x)&#123;</span><br><span class="line">    this.#x = x;</span><br><span class="line">  &#125;</span><br><span class="line">  x()&#123;</span><br><span class="line">    return this.#x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C(<span class="number">42</span>).x() === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// private instance class fields initializers</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  #x = 42;</span><br><span class="line">  x()&#123;</span><br><span class="line">    return this.#x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x() === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// computed instance class fields</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  [<span class="string">'x'</span>] = <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// static class fields</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> x = <span class="string">'x'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> C.x === <span class="string">'x'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  static #x = 42;</span><br><span class="line">  x()&#123;</span><br><span class="line">    return C.#x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x() === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> [<span class="string">'x'</span>] = <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> C.x === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// private  class method</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  #x() &#123; return 42; &#125; // 实例方法</span><br><span class="line">  x() &#123;</span><br><span class="line">    return this.#x(); // 原型方法</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x() === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  static #x() &#123; return 42; &#125;</span><br><span class="line">  x() &#123;</span><br><span class="line">    return C.#x();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x() === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> y = <span class="literal">false</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">get</span> #x() &#123; <span class="keyword">return</span> <span class="number">42</span>; &#125;</span><br><span class="line">  <span class="keyword">set</span> #x(x) &#123; y = x; &#125;</span><br><span class="line">  x() &#123;</span><br><span class="line">    this.#x = true;</span><br><span class="line">    return this.#x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x() === <span class="number">42</span> &amp;&amp; y;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> y = <span class="literal">false</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> #x() &#123; <span class="keyword">return</span> <span class="number">42</span>; &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">set</span> #x(x) &#123; y = x; &#125;</span><br><span class="line">  x() &#123;</span><br><span class="line">    C.#x = true;</span><br><span class="line">    return C.#x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> C().x() === <span class="number">42</span> &amp;&amp; y;</span><br><span class="line"></span><br><span class="line"><span class="comment">// numeric separators</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>_000_000<span class="number">.000</span>_001 === <span class="number">1000000.000001</span> &amp;&amp;</span><br><span class="line">  <span class="number">0b1010</span>_0001_1000_0101 === <span class="number">0b1010000110000101</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// String.prototype.replaceAll</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise.any</span></span><br><span class="line"><span class="built_in">Promise</span>.any([</span><br><span class="line">  <span class="built_in">Promise</span>.resolve(<span class="number">1</span>),</span><br><span class="line">  <span class="built_in">Promise</span>.reject(<span class="number">2</span>),</span><br><span class="line">  <span class="built_in">Promise</span>.resolve(<span class="number">3</span>)</span><br><span class="line">]).then(<span class="function"><span class="params">it</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (it === <span class="number">1</span>) asyncTestPassed();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// class decorators</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  @nonconf</span><br><span class="line">  <span class="keyword">get</span> B() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nonconf</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</span><br><span class="line">  descriptor.configurable = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">return</span> descriptor;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Object</span>.getOwnPropertyDescriptor(A.prototype, <span class="string">"B"</span>).configurable === <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// throw expressions</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// logical</span></span><br><span class="line"><span class="keyword">var</span> a, b;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  a = <span class="number">19</span> || <span class="keyword">throw</span> <span class="number">77</span>;</span><br><span class="line">  b = <span class="number">88</span> &amp;&amp; <span class="keyword">throw</span> <span class="number">23</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + e === <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// parameter initializers</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span> (<span class="params">arg = throw <span class="number">42</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (fn(<span class="number">21</span>) !== <span class="number">21</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  fn();</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="keyword">return</span> e === <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// arrow function bodies</span></span><br><span class="line"><span class="keyword">var</span> fn = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">throw</span> <span class="number">42</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  fn();</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="keyword">return</span> e === <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="literal">true</span> ? <span class="number">42</span> : <span class="keyword">throw</span> <span class="number">21</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="literal">false</span> ? <span class="number">42</span> : <span class="keyword">throw</span> <span class="number">21</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="keyword">return</span> e === <span class="number">21</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set</span></span><br><span class="line"><span class="comment">// 交集</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">set</span> = new Set([1, 2, 3]).intersection(new Set([2, 3, 4]));</span><br><span class="line">return <span class="keyword">set</span>.size === 2</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(2)</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(3);</span><br><span class="line"></span><br><span class="line">// 合集</span><br><span class="line">var <span class="keyword">set</span> = new Set([1, 2]).union(new Set([2, 3]));</span><br><span class="line">return <span class="keyword">set</span>.size === 3</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(1)</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(2)</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(3);</span><br><span class="line"></span><br><span class="line">// 差集</span><br><span class="line">var <span class="keyword">set</span> = new Set([1, 2, 3]).difference(new Set([3, 4]));</span><br><span class="line">return <span class="keyword">set</span>.size === 2</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(1)</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(2);</span><br><span class="line"></span><br><span class="line">// 对称差集</span><br><span class="line">var <span class="keyword">set</span> = new Set([1, 2]).symmetricDifference(new Set([2, 3]));</span><br><span class="line">return <span class="keyword">set</span>.size === 2</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(1)</span><br><span class="line">  &amp;&amp; <span class="keyword">set</span>.has(3);</span><br><span class="line"></span><br><span class="line">// 不交集</span><br><span class="line">return new Set([1, 2, 3]).isDisjointFrom([4, 5, 6]);</span><br><span class="line"></span><br><span class="line">// 子集</span><br><span class="line">return new Set([1, 2, 3]).isSubsetOf([5, 4, 3, 2, 1]);</span><br><span class="line"></span><br><span class="line">// 超集</span><br><span class="line">return new Set([5, 4, 3, 2, 1]).isSupersetOf([1, 2, 3]);</span><br><span class="line"></span><br><span class="line">Map.prototype.upsert</span><br><span class="line">const map = new Map([['a', 1]]);</span><br><span class="line">if (map.upsert('a', it =&gt; 2, () =&gt; 3) !== 2) return false;</span><br><span class="line">if (map.upsert('b', it =&gt; 2, () =&gt; 3) !== 3) return false;</span><br><span class="line">return Array.from(map).join() === 'a,2,b,3';</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const a = &#123;&#125;, b = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>([[a, <span class="number">1</span>]]);</span><br><span class="line"><span class="keyword">if</span> (map.upsert(a, it =&gt; <span class="number">2</span>, () =&gt; <span class="number">3</span>) !== <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (map.upsert(b, it =&gt; <span class="number">2</span>, () =&gt; <span class="number">3</span>) !== <span class="number">3</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> map.get(a) === <span class="number">2</span> &amp;&amp; map.get(b) === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> !<span class="built_in">Array</span>.isTemplateObject([])</span><br><span class="line">  &amp;&amp; <span class="built_in">Array</span>.isTemplateObject((<span class="function"><span class="params">it</span> =&gt;</span> it)<span class="string">`a&#123;1&#125;c`</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// do</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> x = <span class="number">23</span>;</span><br><span class="line">  x + <span class="number">19</span>;</span><br><span class="line">&#125; === <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pipeline Operator |&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doubleSay</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str + <span class="string">', '</span> + str;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">capitalize</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str[<span class="number">0</span>].toUpperCase() + str.slice(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = <span class="string">'hello'</span></span><br><span class="line">  |&gt; doubleSay</span><br><span class="line">  |&gt; capitalize</span><br><span class="line">  |&gt; <span class="function"><span class="params">_</span> =&gt;</span> _ + <span class="string">'!'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> result === <span class="string">'Hello, hello!'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// partial application syntax</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = f(<span class="string">'a'</span>, ?);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'b'</span>) === <span class="string">'ab'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = f(?, <span class="string">'b'</span>);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'a'</span>) === <span class="string">'ab'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = f(?, <span class="string">'b'</span>, ?);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'a'</span>, <span class="string">'c'</span>) === <span class="string">'abc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = f(<span class="string">'a'</span>, ...);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'b'</span>, <span class="string">'c'</span>) === <span class="string">'abc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = f(..., <span class="string">'c'</span>);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'a'</span>, <span class="string">'b'</span>) === <span class="string">'abc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b, c, d, e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c + d + e;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = f(..., <span class="string">'c'</span>, ...);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'a'</span>, <span class="string">'b'</span>) === <span class="string">'abcab'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b, c, d</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = f(?, <span class="string">'b'</span>, ...);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>) === <span class="string">'abcd'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = f(?, <span class="string">'b'</span>);</span><br><span class="line">f = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'a'</span>) === <span class="string">'ab'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> p = o.f(?, <span class="string">'b'</span>);</span><br><span class="line">o = &#123; <span class="attr">x</span>: <span class="string">'c'</span>, <span class="attr">f</span>: <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + <span class="keyword">this</span>.x;</span><br><span class="line">&#125; &#125;;</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'a'</span>) === <span class="string">'abc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + (<span class="keyword">this</span> === o);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = &#123; <span class="attr">f</span>: f(?, <span class="string">'b'</span>) &#125;;</span><br><span class="line"><span class="keyword">return</span> o.f(<span class="string">'a'</span>) === <span class="string">'abfalse'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.x = a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> F(?, <span class="string">'b'</span>);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'a'</span>).x === <span class="string">'ab'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.x = a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> F(<span class="string">'a'</span>, ...);</span><br><span class="line"><span class="keyword">return</span> p(<span class="string">'b'</span>, <span class="string">'c'</span>).x === <span class="string">'abc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// bind (::) operator</span></span><br><span class="line"><span class="comment">// binary form</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.garply += <span class="string">"foo"</span>; <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">garply</span>: <span class="string">"bar"</span> &#125;;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> obj::foo === <span class="string">"function"</span> &amp;&amp; obj::foo().garply === <span class="string">"barfoo"</span>;</span><br><span class="line"><span class="comment">// unary form</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">garply</span>: <span class="string">"bar"</span>, <span class="attr">foo</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">this</span>.garply += <span class="string">"foo"</span>; <span class="keyword">return</span> <span class="keyword">this</span>; &#125; &#125;;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">typeof</span> ::obj.foo === <span class="string">"function"</span> &amp;&amp; ::obj.foo().garply === <span class="string">"barfoo"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// function.callee 当前执行函数</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="function"><span class="params">_</span> =&gt;</span> <span class="function"><span class="keyword">function</span>.<span class="title">callee</span> === <span class="title">f</span>;</span></span><br><span class="line"><span class="function"><span class="title">return</span> <span class="title">f</span>(<span class="params"></span>);</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="title">function</span>.<span class="title">count</span> 实参个数</span></span><br><span class="line"><span class="function"><span class="title">return</span> (<span class="params">\_ =&gt; function.count</span>)(<span class="params"><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span>) === 3;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="title">function</span>.<span class="title">arguments</span> 实参数组</span></span><br><span class="line"><span class="function"><span class="title">var</span> <span class="title">arr</span> =  (<span class="params">_ =&gt; function.arguments</span>)(<span class="params"><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span>);</span></span><br><span class="line"><span class="function"><span class="title">return</span> <span class="title">Array</span>.<span class="title">isArray</span>(<span class="params">arr</span>)</span></span><br><span class="line"><span class="function">  &amp;&amp; <span class="title">arr</span>.<span class="title">length</span> === 3</span></span><br><span class="line">  &amp;&amp; arr[0] === 1</span><br><span class="line">  &amp;&amp; arr[<span class="number">1</span>] === <span class="number">2</span></span><br><span class="line">  &amp;&amp; arr[<span class="number">2</span>] === <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 形参</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'形参个数'</span>, f.length)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// function expression decorators</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inverse</span>(<span class="params">f</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !f.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> (@inverse <span class="function"><span class="keyword">function</span>(<span class="params">it</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> it % <span class="number">2</span>;</span><br><span class="line">&#125;)(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="string">"foo"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">continue</span> f(n - <span class="number">1</span>);</span><br><span class="line">&#125;(<span class="number">1e6</span>)) === <span class="string">"foo"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="string">"foo"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">continue</span> g(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="string">"bar"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">continue</span> f(n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> f(<span class="number">1e6</span>) === <span class="string">"foo"</span> &amp;&amp; f(<span class="number">1e6</span>+<span class="number">1</span>) === <span class="string">"bar"</span>;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/04/03/Cool-New-Features-Released-with-TypeScript-3-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/03/Cool-New-Features-Released-with-TypeScript-3-6/" itemprop="url">Cool New Features Released with TypeScript 3.6</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-03T10:25:41+08:00">
                2020-04-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Stricter-Type-Check-for-Generators"><a href="#Stricter-Type-Check-for-Generators" class="headerlink" title="Stricter Type Check for Generators"></a>Stricter Type Check for Generators</h2><h2 id="More-Accurate-Array-Spread"><a href="#More-Accurate-Array-Spread" class="headerlink" title="More Accurate Array Spread"></a>More Accurate Array Spread</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[...Array(<span class="number">3</span>)]</span><br></pre></td></tr></table></figure>
<h2 id="Raise-Error-with-Bad-Promise-Code"><a href="#Raise-Error-with-Bad-Promise-Code" class="headerlink" title="Raise Error with Bad Promise Code"></a>Raise Error with Bad Promise Code</h2><h2 id="Unicode-Character-Identifiers"><a href="#Unicode-Character-Identifiers" class="headerlink" title="Unicode Character Identifiers"></a>Unicode Character Identifiers</h2><h2 id="get-and-set-Accessors-Are-Allowed-in-Declare-Statements"><a href="#get-and-set-Accessors-Are-Allowed-in-Declare-Statements" class="headerlink" title="get and set Accessors Are Allowed in Declare Statements"></a>get and set Accessors Are Allowed in Declare Statements</h2><h2 id="Merging-Class-and-Constructor-Function-Declare-Statements"><a href="#Merging-Class-and-Constructor-Function-Declare-Statements" class="headerlink" title="Merging Class and Constructor Function Declare Statements"></a>Merging Class and Constructor Function Declare Statements</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">export</span> declare <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name: string</span>): <span class="title">Person</span>;</span></span><br><span class="line"><span class="function"><span class="title">export</span> <span class="title">declare</span> <span class="title">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    name: string;</span><br><span class="line">    age: number;</span><br><span class="line">    <span class="keyword">constructor</span>(name: string, age: number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/04/01/Clean-Code-Applied-to-JavaScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/01/Clean-Code-Applied-to-JavaScript/" itemprop="url">Clean Code Applied to JavaScript</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-01T10:13:41+08:00">
                2020-04-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-start"><a href="#1-start" class="headerlink" title="1. start"></a>1. start</h2><ol>
<li><p>Code smell and refactoring 代码风格与重构</p>
</li>
<li><p>technical debt 技术债务</p>
</li>
<li><p>可读性</p>
<p> 代码格式</p>
</li>
<li><p>develop in English</p>
</li>
<li><p>团队风格</p>
<p>   空格或Tab</p>
<p>   函数名称后是否空格</p>
<p>   分号</p>
<p>   编辑器 EditorConfig</p>
<p>   eslint</p>
<p>   代码格式工具 Prettier</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">root = <span class="literal">true</span></span><br><span class="line">[*]</span><br><span class="line">end_of_line = lf</span><br><span class="line">insert_final_newline = <span class="literal">true</span></span><br><span class="line">[*.&#123;js,py&#125;]</span><br><span class="line">charset = utf<span class="number">-8</span></span><br><span class="line">[*.py]</span><br><span class="line">indent_style = space</span><br><span class="line">indent_size = <span class="number">4</span></span><br><span class="line">[Makefile]</span><br><span class="line">indent_style = tab</span><br><span class="line">[*.js]</span><br><span class="line">indent_style = space</span><br><span class="line">indent_size = <span class="number">2</span></span><br><span class="line">[&#123;package.json,.travis.yml&#125;]</span><br><span class="line">indent_style = space</span><br><span class="line">indent_size = <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h2 id="2-变量"><a href="#2-变量" class="headerlink" title="2 变量"></a>2 变量</h2><ol>
<li><p>Use Intention Revealing Names  见名知意</p>
</li>
<li><p>Use Pronounceable Names</p>
</li>
<li><p>Don’t Use the Variable’s Type in the Name</p>
</li>
<li><p>Use the Same Vocabulary for the Same Variable’s Type</p>
</li>
<li><p>Don’t Add Unneeded Context</p>
</li>
<li><p>Don’t Use Magic Numbers and Strings</p>
</li>
</ol>
<h2 id="3-函数"><a href="#3-函数" class="headerlink" title="3 函数"></a>3 函数</h2><ol>
<li><p>尽量是纯函数 提高复用性</p>
</li>
<li><p>Use Default Arguments Instead of Short Circuiting or Conditionals<br>使用默认参数</p>
</li>
<li><p>Function Arguments (Two or Fewer, Ideally)<br>尽量减少函数参数 如果参数过多 可以对象传参</p>
</li>
<li><p>Avoid Side Effects — Global Variables<br>避免全局变量</p>
</li>
<li><p>Avoid Side Effects — Objects Mutables</p>
</li>
</ol>
<p>通过代码的不同部分使用同一对象修改数据时，可能会出现更多的副作用。  </p>
<p>使我们失去软件开发的许多优势（避免使用此功能）的主要副作用之一是对象的修改。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> addItemToCart = <span class="function">(<span class="params">cart, item</span>) =&gt;</span> &#123;</span><br><span class="line">  cart.push(&#123; item, <span class="attr">date</span>: <span class="built_in">Date</span>.now() &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对原有数据cart没有修改 没有副作用</span></span><br><span class="line"><span class="keyword">const</span> addItemToCart = <span class="function">(<span class="params">cart, item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> […cart, &#123;</span><br><span class="line">    item,</span><br><span class="line">    date: <span class="built_in">Date</span>.now(),</span><br><span class="line">  &#125;];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6. Functions Should Do One Thing 函数单一职责 降耦</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7. Functions Should Only Be One Level of Abstraction</span></span><br><span class="line"><span class="string">设计功能时，我们还必须满足的另一个要求是，每个功能只能有一个抽象级别</span></span><br></pre></td></tr></table></figure>
<p>function parseBetterJSAlternative(code) {<br>  const REGEXES = [<br>    // …<br>  ];</p>
<p> const statements = code.split(‘ ‘);<br> const tokens = [];<br> REGEXES.forEach((REGEX) =&gt; {<br>   statements.forEach((statement) =&gt; {<br>     // …<br>   });<br> });</p>
<p> const ast = [];<br> tokens.forEach((token) =&gt; {<br>   // lex…<br> });</p>
<p> ast.forEach((node) =&gt; {<br>   // parse…<br> });<br>}</p>
<p>// improve</p>
<p>const REGEXES = [ // …];</p>
<p>function tokenize(code) {<br>  const statements = code.split(‘ ‘);<br>  const tokens = [];<br>  REGEXES.forEach((REGEX) =&gt; {<br>    statements.forEach((statement) =&gt; {<br>      tokens.push( /<em> … </em>/ );<br>    });<br>  });<br> return tokens;<br>}</p>
<p>function lexer(tokens) {<br> const ast = [];<br> tokens.forEach((token) =&gt; ast.push( /<em> </em>/ ));<br> return ast;<br>}</p>
<p>function parseBetterJSAlternative(code) {<br> const tokens = tokenize(code);<br> const ast = lexer(tokens);<br> ast.forEach((node) =&gt; // parse…);<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">8. Favor Functional Programming</span><br><span class="line"></span><br><span class="line">纯函数优点</span><br><span class="line"></span><br><span class="line">1.纯函数更容易推论。  </span><br><span class="line"></span><br><span class="line">2.测试更加容易，纯函数非常适合基于属性的测试之类的技术。  </span><br><span class="line"></span><br><span class="line">3.调试更容易。  </span><br><span class="line"></span><br><span class="line">4.程序更安全。  </span><br><span class="line"></span><br><span class="line">5.程序是在较高级别上编写的，因此更易于理解。  </span><br><span class="line"></span><br><span class="line">6.功能签名更有意义。  </span><br><span class="line"></span><br><span class="line">7.并行/并行编程更容易。   </span><br><span class="line"></span><br><span class="line">9. Use Method Chaining 链式调用</span><br><span class="line"></span><br><span class="line">## Comments 注释</span><br><span class="line"></span><br><span class="line">1. Only Comment Things That Have Business Logic Complexity</span><br><span class="line"></span><br><span class="line">仅评论具有业务逻辑复杂性的事物</span><br><span class="line"></span><br><span class="line">2. Don’t Have Journal Comments</span><br><span class="line"></span><br><span class="line">3. Avoid Positional Markers</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## Exceptions</span><br><span class="line">异常是质量软件开发中必不可少的部分，因为我们将控制意外或未实施的情况</span><br><span class="line"></span><br><span class="line">1. Prefer Exceptions to Returning Error Codes</span><br><span class="line"></span><br><span class="line">  1. 不耦合的业务逻辑和错误控制。这是两个需要解决的不同问题，必须加以区分和区别对待。</span><br><span class="line"></span><br><span class="line">  2. 减少代码中的冗长，使其更容易阅读。</span><br><span class="line"></span><br><span class="line">  3. 错误代码的责任已经委托给编程语言，编程语言必须为我们服务，反之亦然</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```javascript</span><br><span class="line">class Laptop &#123;</span><br><span class="line"> sendShutDown() &#123;</span><br><span class="line">   const deviceID = getID(DEVICE_LAPTOP);</span><br><span class="line">   if (deviceID !== DEVICE_STATUS.INVALID) &#123;</span><br><span class="line">     const laptop = DB.findOne(deviceID);</span><br><span class="line">     if (laptop.getStatus() !== DEVICE_SUSPENDED) &#123;</span><br><span class="line">       pauseDevice(deviceID);</span><br><span class="line">       clearDeviceWorkQueue(deviceID);</span><br><span class="line">       closeDevice(deviceID);</span><br><span class="line">     &#125; else &#123;</span><br><span class="line">       logger.log(‘Device suspended. Unable to shut down’);</span><br><span class="line">     &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">     logger.log(‘Invalid handle for: ‘ + DEVICE_LAPTOP.toString());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Clean</span><br><span class="line">/*</span><br><span class="line"> The code is better because the algorithm</span><br><span class="line"> and error handling, are now separated.</span><br><span class="line">*/</span><br><span class="line">class Laptop &#123;</span><br><span class="line">  sendShutDown() &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      tryToShutDown();</span><br><span class="line">    &#125; catch (error) &#123;</span><br><span class="line">      logger.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  tryToShutDown() &#123;</span><br><span class="line">    const deviceID = getID(DEVICE_LAPTOP);</span><br><span class="line">    const laptop = DB.findOne(deviceID);</span><br><span class="line">    pauseDevice(deviceID);</span><br><span class="line">    clearDeviceWorkQueue(deviceID);</span><br><span class="line">    closeDevice(deviceID);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  getID(deviceID) &#123;</span><br><span class="line">    throw new DeviceShutDownError(‘Invalid handle for: ‘ +   deviceID.toString());</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Don’t Ignore Caught Errors</li>
</ol>
<p>2.1. Please don t do the ostrich technique</p>
<p>请不要做鸵鸟技术</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"> functionThatMightThrow();</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line"> <span class="built_in">console</span>.log(error);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"> functionThatMightThrow();</span><br><span class="line">&#125; <span class="keyword">catch</span> (error)&#123;</span><br><span class="line"> <span class="built_in">console</span>.error(error);</span><br><span class="line"> notifyUserOfError(error);</span><br><span class="line"> reportErrorToService(error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Don’t Ignore Rejected Promises</li>
</ol>
<ol start="4">
<li>Exceptions Hierarchy</li>
</ol>
<ol start="5">
<li>Provide Context With Exceptions</li>
</ol>
<h2 id="Avoid-Conditional-Complexity-避免条件的复杂性"><a href="#Avoid-Conditional-Complexity-避免条件的复杂性" class="headerlink" title="Avoid Conditional Complexity 避免条件的复杂性"></a>Avoid Conditional Complexity 避免条件的复杂性</h2><ol>
<li>Don t Use Flags As Function Parameters</li>
</ol>
<p>不要使用标志作为函数参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Dirty</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">book</span>(<span class="params">customer, isPremium</span>) </span>&#123;</span><br><span class="line"> <span class="comment">// …</span></span><br><span class="line"> <span class="keyword">if</span> (isPremium) &#123;</span><br><span class="line">   premiumLogic();</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   regularLogic();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Clean (Declarative way)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bookPremium</span> (<span class="params">customer</span>) </span>&#123;</span><br><span class="line"> premiumLogic();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bookRegular</span> (<span class="params">customer</span>) </span>&#123;</span><br><span class="line"> retularLogic();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Encapsulate Conditionals<br>封装条件</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (platform.state === <span class="string">'fetching'</span> &amp;&amp; isEmpty(cart)) &#123;</span><br><span class="line"> <span class="comment">// …</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showLoading</span>(<span class="params">platform, cart</span>) </span>&#123;</span><br><span class="line"> <span class="keyword">return</span> platform.state === <span class="string">'fetching'</span> &amp;&amp; isEmpty(cart);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (showLoading(platform, cart)) &#123;</span><br><span class="line"> <span class="comment">// …</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Replace Nested Conditionals With Guard Clauses<br>不要使用else语句</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPayAmount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">let</span> result;</span><br><span class="line"> <span class="keyword">if</span> (isDead)&#123;</span><br><span class="line">   result = deadAmount();</span><br><span class="line"> &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="keyword">if</span> (isSeparated)&#123;</span><br><span class="line">     result = separatedAmount();</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (isRetired)&#123;</span><br><span class="line">       result = retiredAmount();</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       result = normalPayAmount();</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// improve</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPayAmount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (isDead) <span class="keyword">return</span> deadAmount();</span><br><span class="line"> <span class="keyword">if</span> (isSeparated) <span class="keyword">return</span> separatedAmount();</span><br><span class="line"> <span class="keyword">if</span> (isRetired) <span class="keyword">return</span> retiredAmount();</span><br><span class="line"> <span class="keyword">return</span> normalPayAmount();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Null-Object Pattern<br>不断检查对象是否为空，并根据此检查是否显示默认操作。 该模式称为空对象模式  </li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line"> sound() &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">'bark'</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">[<span class="string">'dog'</span>, <span class="literal">null</span>].map(<span class="function">(<span class="params">animal</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">if</span>(animal !== <span class="literal">null</span>) &#123;</span><br><span class="line">     sound();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// improve</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line"> sound() &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">'bark'</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NullAnimal</span> </span>&#123;</span><br><span class="line"> sound() &#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAnimal</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> type === <span class="string">'dog'</span> ? <span class="keyword">new</span> Dog() : <span class="keyword">new</span> NullAnimal();</span><br><span class="line">&#125;</span><br><span class="line">[<span class="string">'dog'</span>, <span class="literal">null</span>].map(<span class="function">(<span class="params">animal</span>) =&gt;</span> getAnimal(animal).sound());</span><br><span class="line"><span class="comment">// Returns ["bark", null]</span></span><br></pre></td></tr></table></figure>
<h2 id="Remove-Conditionals-Using-Polymorphism"><a href="#Remove-Conditionals-Using-Polymorphism" class="headerlink" title="Remove Conditionals Using Polymorphism"></a>Remove Conditionals Using Polymorphism</h2><p>使用多态性替换条件语句</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Auto</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Auto.prototype.getProperty = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">   <span class="keyword">case</span> BIKE:</span><br><span class="line">     <span class="keyword">return</span> getBaseProperty();</span><br><span class="line">   <span class="keyword">case</span> CAR:</span><br><span class="line">     <span class="keyword">return</span> getBaseProperty() - getLoadFactor();</span><br><span class="line">   <span class="keyword">case</span> BUS:</span><br><span class="line">     <span class="keyword">return</span> (isNailed) ? <span class="number">0</span> : getBaseProperty(voltage);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Should be unreachable"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// improve</span></span><br><span class="line"></span><br><span class="line">abstract <span class="class"><span class="keyword">class</span> <span class="title">Auto</span> </span>&#123;</span><br><span class="line"> abstract getProperty();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bike</span> <span class="keyword">extends</span> <span class="title">Auto</span> </span>&#123;</span><br><span class="line"> getProperty() &#123;</span><br><span class="line">   <span class="keyword">return</span> getBaseProperty();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">extends</span> <span class="title">Auto</span> </span>&#123;</span><br><span class="line"> getProperty() &#123;</span><br><span class="line">   <span class="keyword">return</span> getBaseProperty() - getLoadFactor();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bus</span> <span class="keyword">extends</span> <span class="title">Auto</span> </span>&#123;</span><br><span class="line"> getProperty() &#123;</span><br><span class="line">   <span class="keyword">return</span> (isNailed) ? <span class="number">0</span> : getBaseProperty(voltage);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Somewhere in client code</span></span><br><span class="line">speed = auto.getProperty();</span><br></pre></td></tr></table></figure>
<h2 id="Remove-Conditionals-Using-the-Strategy-Pattern-Composition-Command-Pattern"><a href="#Remove-Conditionals-Using-the-Strategy-Pattern-Composition-Command-Pattern" class="headerlink" title="Remove Conditionals Using the Strategy Pattern (Composition)/Command Pattern"></a>Remove Conditionals Using the Strategy Pattern (Composition)/Command Pattern</h2><p>使用策略模式（组合）/命令模式替换条件语句</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logMessage</span>(<span class="params">message = <span class="string">"CRITICAL::The system …"</span></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">const</span> parts = message.split(<span class="string">"::"</span>);</span><br><span class="line"> <span class="keyword">const</span> level = parts[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">switch</span> (level) &#123;</span><br><span class="line"> <span class="keyword">case</span> <span class="string">'NOTICE'</span>:</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Notice"</span>)</span><br><span class="line">   <span class="keyword">break</span>;</span><br><span class="line"> <span class="keyword">case</span> <span class="string">'CRITICAL'</span>:</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Critical"</span>);</span><br><span class="line">   <span class="keyword">break</span>;</span><br><span class="line"> <span class="keyword">case</span> <span class="string">'CATASTROPHE'</span>:</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"Castastrophe"</span>);</span><br><span class="line">   <span class="keyword">break</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// improve</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> strategies = &#123;</span><br><span class="line"> criticalStrategy,</span><br><span class="line"> noticeStrategy,</span><br><span class="line"> catastropheStrategy,</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logMessage</span>(<span class="params">message = <span class="string">"CRITICAL::The system …"</span></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">const</span> [level, messageLog] = message.split(<span class="string">"::"</span>);</span><br><span class="line"> <span class="keyword">const</span> strategy = <span class="string">`<span class="subst">$&#123;level.toLowerCase()&#125;</span>Strategy`</span>;</span><br><span class="line"> <span class="keyword">const</span> output = strategies[strategy](messageLog);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">criticalStrategy</span>(<span class="params">param</span>) </span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"Critical: "</span> + param);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">noticeStrategy</span>(<span class="params">param</span>) </span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"Notice: "</span> + param);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">catastropheStrategy</span>(<span class="params">param</span>) </span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">"Catastrophe: "</span> + param);</span><br><span class="line">&#125;</span><br><span class="line">logMessage();</span><br><span class="line">logMessage(<span class="string">"CATASTROPHE:: A big Catastrophe"</span>);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/03/27/What-is-a-Blob/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/27/What-is-a-Blob/" itemprop="url">What is a Blob?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-27T20:19:31+08:00">
                2020-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="What-is-a-Blob"><a href="#What-is-a-Blob" class="headerlink" title="What is a Blob?"></a>What is a Blob?</h2><p>Blob is  <strong>Binary Large Object</strong></p>
<p>Blob不是JavaScript的特殊性。 最初，创建Blob是为了在数据库管理系统中使用。<br>该类型是在1970年代创建的，用于存储太大的音频，图像或视频之类的大文件，无法存储在常规数据库字段中。<br>该术语实际上是指“二进制大对象”。</p>
<p>Blob接口的stream() 方法返回一个ReadableStream对象，读取它将返回包含在Blob中的数据。</p>
<p>在JavaScript中，Blob用于将文件表示为不可变的原始数据<br>在控制台中，我们在上一个示例中创建的Blob如下所示</p>
<p><img src="../images/blob1.png" alt="Blob in console">  </p>
<p>如您所见，Blob具有两个属性：size和type。 大小是数据的大小（以字节为单位）。<br>该类型是应该包含MIME类型的字符串。 创建Blob时我没有给出任何类型，但是我应该做这样的事情：</p>
<p><code>const blob = new Blob([doc.output()], { type: &#39;application/pdf&#39; });</code></p>
<p><img src="../images/blob2.png" alt="Blob in console">  </p>
<p>JavaScript Blobs提供了一些方法来访问它们的内容<br>One of them is the text method that returns a Promise resolving to the content of the Blob as text  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'click'</span>, <span class="keyword">async</span> event =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (event.target.id === <span class="string">'button'</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> doc = <span class="keyword">new</span> jsPDF();</span><br><span class="line">    doc.text(<span class="string">'Hello world!'</span>);</span><br><span class="line">    <span class="keyword">const</span> blob = <span class="keyword">new</span> Blob([doc.output()], &#123; <span class="attr">type</span>: <span class="string">'application/pdf'</span> &#125;);</span><br><span class="line">    <span class="keyword">const</span> blobAsText = <span class="keyword">await</span> blob.text();</span><br><span class="line">    <span class="built_in">console</span>.log(blobAsText);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>还有两种其他方法可让您访问Blob的内容：  </p>
<ol>
<li><p>arrayBuffer，将一个Promise解析返回给ArrayBuffer   </p>
</li>
<li><p>将返回ReadableStream的流  </p>
</li>
</ol>
<h2 id="Manipulate-Blobs"><a href="#Manipulate-Blobs" class="headerlink" title="Manipulate Blobs"></a>Manipulate Blobs</h2><p>我们会通过HTTP请求接收文件。 如果使用fetch API，则需要在主体上使用blob方法从响应中读取Blob  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> download = <span class="function">(<span class="params">fileName, blob</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> element = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">  <span class="keyword">const</span> url = <span class="built_in">window</span>.URL.createObjectURL(blob);</span><br><span class="line">  element.href = url;</span><br><span class="line">  element.download = fileName;</span><br><span class="line">  element.target = <span class="string">'_blank'</span>;</span><br><span class="line">  element.click();</span><br><span class="line">  element.remove();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'click'</span>, <span class="keyword">async</span> event =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (event.target.id === <span class="string">'button'</span>) &#123;</span><br><span class="line">    fetch(<span class="string">'https://whatever/doc.pdf'</span>)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> response.blob())</span><br><span class="line">    .then(<span class="function"><span class="params">blob</span> =&gt;</span> &#123;</span><br><span class="line">      download(<span class="string">'test.pdf'</span>, blob);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>您还可以从另一个Blob创建一个Blob。您只能对原始Blob进行切片，也就是说只返回其字节的一部分。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'click'</span>, <span class="keyword">async</span> event =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (event.target.id === <span class="string">'button'</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> blob = <span class="keyword">new</span> Blob([<span class="string">'some text'</span>], &#123; <span class="attr">type</span>: <span class="string">'application/pdf'</span> &#125;);</span><br><span class="line">    <span class="keyword">const</span> slicedBlob = blob.slice(<span class="number">5</span>, <span class="number">9</span>);</span><br><span class="line">    <span class="keyword">const</span> blobAsText = <span class="keyword">await</span> blob.text();</span><br><span class="line">    <span class="keyword">const</span> slicedBlobAsText = <span class="keyword">await</span> slicedBlob.text();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Original Blob: <span class="subst">$&#123;blobAsText&#125;</span>`</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Sliced Blob: <span class="subst">$&#123;slicedBlobAsText&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>File 接口基于Blob，继承了 blob 的功能并将其扩展使其支持用户系统上的文件</p>
<p>浏览器已经Streams API允许JavaScript以编程方式访问通过网络接收的数据流，并根据开发人员的需要对其进行处理。</p>
<p>Blob四个方法：</p>
<ol>
<li><p>arrayBuffer() 方法返回一个 Promise 对象，包含 blob 中的数据，并在 ArrayBuffer 中以二进制数据的形式呈现</p>
<p>var bufferPromise = blob.arrayBuffer();</p>
<p>blob.arrayBuffer().then(buffer =&gt; \/* 处理 ArrayBuffer 数据的代码……*\/);</p>
<p>var buffer = await blob.arrayBuffer();   </p>
</li>
<li><p>slice() 方法用于创建一个包含源 Blob的指定字节范围内的数据的新 Blob 对象</p>
<p>var blob = instanceOfBlob.slice([start [, end [, contentType]]]};</p>
</li>
</ol>
<ol start="3">
<li><p>text() 方法返回一个 Promise 对象，包含 blob 中的内容，使用 UTF-8 格式编码</p>
</li>
<li><p>stream() 方法返回一个ReadableStream对象，读取它将返回包含在Blob中的数据</p>
</li>
</ol>
<p>本地图片预览方法</p>
<ol>
<li><p>ie6 可以直接显示本本地路径的图片 如： <img src="file://c:/3.jpg">  ~~~网上都说ie7就不支持这种文件系统路径的url，但测试 xp ie8还是可以的</p>
</li>
<li><p>ie8+ alphaImageLoader滤镜方式加载本地路径的图片</p>
</li>
<li><p>chrome, firefox, 用dataUrl  或 createObjectURL方法实现</p>
<p>img.src = window.URL.createObjectURL(obj.files.item(0));</p>
</li>
</ol>
<p>window.URL.createObjectURL</p>
<p>创建一个新的对象URL,该对象URL可以代表某一个指定的File对象或Blob对象</p>
<p>URL.createObjectURL(file)可以得到当前文件的一个内存URL</p>
<p>FileReader.readAsDataURL(file)可以得到一段base64的字符串。<br>URL.createObjectURL(file)可以得到当前文件的一个内存URL。</p>
<p>当不再需要这些 URL 对象时，每个对象必须通过调用 URL.revokeObjectURL() 方法来释放。</p>
<p>FileReader.readAsDataURL(file)的返回值是转化后的超长base64字符串(长度与要解析的文件大小正相关)。<br>URL.createObjectURL(file)的返回值虽然是字符串，但是是一个url地址</p>
<p>FileReader.readAsDataURL(file)依照JS垃圾回收机制自动从内存中清理。<br>URL.createObjectURL(file)存在于当前doucment内，清除方式只有unload()事件或revokeObjectURL()手动清除</p>
<p>FileReader.readAsDataURL(file)通过回调的形式返回，异步执行。<br>URL.createObjectURL(file)直接返回，同步执行。</p>
<p>FileReader.readAsDataURL(file)当多个文件同时处理时，需要每一个文件对应一个新的FileReader对象<br>URL.createObjectURL(file)依次返回无影响。</p>
<p>URL.createObjectURL(file)得到本地内存容器的URL地址，方便预览，多次使用需要注意手动释放内存的问题，性能优秀。<br>FileReader.readAsDataURL(file)胜在直接转为base64格式，可以直接用于业务，无需二次转换格式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Base64 to Blob</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dataURLtoBlob</span>(<span class="params">dataurl</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> arr = dataurl.split(<span class="string">','</span>), mime = arr[<span class="number">0</span>].match(<span class="regexp">/:(.*?);/</span>)[<span class="number">1</span>],</span><br><span class="line">        bstr = atob(arr[<span class="number">1</span>]), n = bstr.length, u8arr = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(n);</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        u8arr[n] = bstr.charCodeAt(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Blob([u8arr], &#123; <span class="attr">type</span>: mime &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">video.addEventListener(<span class="string">'loadeddata'</span>, consoleString.bind(video, <span class="string">'loadeddata'</span>)) <span class="comment">// 当前帧加载完毕</span></span><br><span class="line">video.addEventListener(<span class="string">'loadedmetadata'</span>, consoleString.bind(video, <span class="string">'loadedmetadata'</span>)) <span class="comment">// 视频元数据加载完毕</span></span><br><span class="line">video.addEventListener(<span class="string">'canplay'</span>, consoleString.bind(video, <span class="string">'canplay'</span>)) <span class="comment">// 视频缓冲能够开始播放</span></span><br><span class="line">video.addEventListener(<span class="string">'timeupdate'</span>, consoleString.bind(video, <span class="string">'timeupdate'</span>)) <span class="comment">// 播放位置发生改变时</span></span><br><span class="line">video.addEventListener(<span class="string">'play'</span>, consoleString.bind(video, <span class="string">'play'</span>)) <span class="comment">// 开始播放时</span></span><br><span class="line">video.addEventListener(<span class="string">'waiting'</span>, consoleString.bind(video, <span class="string">'waiting'</span>)) <span class="comment">// 要播放下一帧而需要缓冲时</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">consoleString</span>(<span class="params">string</span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(string)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Blob-a-创建"><a href="#Blob-a-创建" class="headerlink" title="Blob a 创建"></a>Blob a 创建</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downloadFile</span>(<span class="params">fileName, content, blobOptions</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// blobOptions = &#123;</span></span><br><span class="line">        <span class="comment">//     type: 'text/csv',</span></span><br><span class="line">        <span class="comment">//     endings: 'native' // or transparent</span></span><br><span class="line">        <span class="comment">// &#125;;</span></span><br><span class="line">        <span class="keyword">let</span> blobOptions = blobOptions || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> blob = <span class="keyword">new</span> Blob([content], blobOptions);</span><br><span class="line">        <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">        a.innerHTML = fileName;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 指定生成的文件名</span></span><br><span class="line">        a.download = fileName;</span><br><span class="line">        a.href = URL.createObjectURL(blob);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">document</span>.body.appendChild(a);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> evt = <span class="built_in">document</span>.createEvent(<span class="string">"MouseEvents"</span>);</span><br><span class="line">        evt.initEvent(<span class="string">"click"</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        a.dispatchEvent(evt);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">document</span>.body.removeChild(a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span>  blob = <span class="keyword">new</span> Blob( array, options );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">array 是一个由<span class="built_in">ArrayBuffer</span>, ArrayBufferView, Blob, DOMString 等对象构成的 <span class="built_in">Array</span>   </span><br><span class="line">或者其他类似对象的混合体，它将会被放进 Blob   </span><br><span class="line">DOMStrings会被编码为UTF<span class="number">-8</span>   </span><br><span class="line"></span><br><span class="line">options 是一个可选的BlobPropertyBag字典，它可能会指定如下两个属性：</span><br><span class="line"></span><br><span class="line">type，默认值为 <span class="string">""</span>，它代表了将会被放入到blob中的数组内容的MIME类型     </span><br><span class="line"></span><br><span class="line">endings，默认值为<span class="string">"transparent"</span>，用于指定包含行结束符\n的字符串如何被写入   </span><br><span class="line"></span><br><span class="line">它是以下两个值中的一个： <span class="string">"native"</span>，代表行结束符会被更改为适合宿主操作系统文件系统的换行符   </span><br><span class="line">或者 <span class="string">"transparent"</span>，代表会保持blob中保存的结束符不变</span><br></pre></td></tr></table></figure>
<p>Blob 对象表示一个不可变、原始数据的类文件对象。Blob 表示的不一定是JavaScript原生格式的数据。  </p>
<p>File 接口基于Blob，继承了 blob 的功能并将其扩展使其支持用户系统上的文件   </p>
<p>File 对象是来自用户在一个 <input> 元素上选择文件后返回的 FileList 对象,<br>也可以是来自由拖放操作生成的 DataTransfer 对象，<br>或者来自 HTMLCanvasElement 上的 mozGetAsFile() API   </p>
<p>File 对象是特殊类型的 Blob，且可以用在任意的 Blob 类型的 context 中。<br>比如说， FileReader, URL.createObjectURL(), createImageBitmap(),<br>及 XMLHttpRequest.send() 都能处理 Blob 和 File。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li><p>Blob 基于二进制数据格式</p>
</li>
<li><p>file 基于Blob的子类型</p>
</li>
<li><p>创建图片预览</p>
<p> fileReader 异步</p>
<p> window.URL.createObjectURL 同步  在内存中</p>
<p> window.URL.createObjectURL() 和 window.URL.revokeObjectURL() 方法的支持。   </p>
<p> 这使得你可以创建用于引用任何数据的简单URL字符串，  </p>
<p> 也可以引用一个包括用户电脑上的本地文件的DOM File对象。  </p>
<p> window.URL.createObjectURL() 来创建</p>
<p> window.URL.revokeObjectURL() 来释放</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/03/27/Do-you-know-why-this-x-is-Undefined-when-x-is-declared-with-Const-or-Let/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/27/Do-you-know-why-this-x-is-Undefined-when-x-is-declared-with-Const-or-Let/" itemprop="url">Do you know why this.x is Undefined when x is declared with Const or Let?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-27T16:28:49+08:00">
                2020-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="question"><a href="#question" class="headerlink" title="question"></a>question</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line">f(); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p>根据文档，对于所有执行上下文，有三个组件-代码评估状态，函数和领域。 我们将研究第三个组件Realm  </p>
<p>A Realm is a kind of a world that associated ECMAScript resources live.   </p>
<p>And the realm of the running execution is called the current Realm.  </p>
<p> Why this is a matter? When you execute JavaScript code,   </p>
<p> it creates a global execution context whose current Realm is the global Realm.   </p>
<p> In this realm, an object called globalEnv is created and envolved, which contains a Lexical Environment.</p>
<p> 领域是一种与ECMAScript资源相关联的世界。 运行执行的领域称为当前领域。   </p>
<p> 为什么这是问题？ 当您执行JavaScript代码时，它将创建一个全局执行上下文，其当前领域是全局领域。   </p>
<p> 在此领域中，将创建并旋转一个名为globalEnv的对象，其中包含一个词法环境。</p>
<h2 id="Global-Lexical-Environment"><a href="#Global-Lexical-Environment" class="headerlink" title="Global Lexical Environment"></a>Global Lexical Environment</h2><p> Every lexical environment has an environment record, which contains your variables and keeps tracking them.     </p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> name = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> globalLexicalEnvironment = &#123;</span><br><span class="line">  environmentRecord: &#123;</span><br><span class="line">    name: name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">The lexical environment created <span class="keyword">in</span> the Realm <span class="keyword">of</span> the global execution context contains thewindow object.</span><br></pre></td></tr></table></figure>
<p> 生成全局执行上下文时，将创建其环境记录，并将其视为所有ECMAScript元素共享的最外部作用域。   </p>
<p> 全球环境记录中存在一个领域，换句话说，它是最外部的范围。   </p>
<p> 并且此环境记录提供了内置变量或函数的绑定。 这是这些内置物品的列表。  </p>
<p>Infinity<br>NaN<br>undefined<br>eval<br>Array<br>Boolean</p>
<p>….</p>
<p>对于浏览器JavaScript，将这些属性分配给的对象称为window。   </p>
<p>这种关系可以表示如下，但是，这当然不是JavaScript的工作方式</p>
<p>var window = {<br>  Infinity: …,<br>  NaN: …,<br>  undefined: …,<br>  eval: …,<br>  Array: …,<br>  Boolean: …,<br>};<br>var globalExecutionContext = {<br>  environmentRecords: {<br>    window: window<br>  }<br>};</p>
<h2 id="Var-vs-Const-amp-Let"><a href="#Var-vs-Const-amp-Let" class="headerlink" title="Var vs Const &amp; Let"></a>Var vs Const &amp; Let</h2><p>那么为什么var变量成为window属性 而let和const声明的属性则不是呢？</p>
<p>在将事物声明并分配给全局环境记录中涉及的名为window的对象时，将向全局环境记录中添加另一个声明。 称为TopLevelVarDeclaredNames。  </p>
<p>它定义了JavaScript如何在顶级范围内处理var变量。 根据规范，程序开头是一个空数组  </p>
<p>事实是，没有TopLevelLetDeclaredNames或TopLevelConstDeclaredNames。 意思是，const和let变量不会添加到全局对象window。   </p>
<h2 id="那我无法永远访问它们吗？"><a href="#那我无法永远访问它们吗？" class="headerlink" title="那我无法永远访问它们吗？"></a>那我无法永远访问它们吗？</h2><p>解决办法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.x = x;</span><br><span class="line">print(); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://jsonload.com/2020/03/27/this-keyword-in-JavaScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="killsos.ql@gmail.com">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="killsos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/27/this-keyword-in-JavaScript/" itemprop="url">this keyword in JavaScript</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-27T15:53:02+08:00">
                2020-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="what-is-this-keyword"><a href="#what-is-this-keyword" class="headerlink" title="what is this keyword"></a>what is this keyword</h2><p>首先，您应该知道“ this”是什么以及它在JavaScript中的作用。<br>JavaScript中存在一个称为“执行上下文”的区域，该区域是JavaScript首次运行代码或调用函数时创建的。<br>如果连续调用5个函数，则将创建6个执行上下文-全局执行上下文，以及其他5个函数执行上下文。<br>每个执行上下文都包含一个名为ThisBinding的值，该值与“ this”关键字有关</p>
<p>那又是什么呢？ 在JavaScript中，“ this”是一个特殊的关键字，无论您当前的函数在哪里，<br>都可以使用它直接在当前作用域中访问某个对象。<br>认情况下，它引用全局对象。 在Node.Js中，它将是全局的global；在浏览器中，它将是window。  </p>
<p>但更重要的是要记住，“ this”所指出的内容取决于哪个上下文调用包含“ this”的函数。</p>
<h2 id="how-use-this"><a href="#how-use-this" class="headerlink" title="how use this"></a>how use this</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">x</span>: <span class="number">2</span> &#125;;</span><br><span class="line">obj.foo = foo;</span><br><span class="line"></span><br><span class="line">obj.foo(); <span class="comment">// 2</span></span><br><span class="line">foo(); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>即使“ this”是由调用函数的上下文决定的，但“ this”并不总是遵循此规则</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">x</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> x = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);  </span><br><span class="line">  &#125;</span><br><span class="line">  bar();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.foo = foo;</span><br><span class="line">obj.foo();</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<h2 id="How-to-avoid-this-flaw"><a href="#How-to-avoid-this-flaw" class="headerlink" title="How to avoid this flaw?"></a>How to avoid this flaw?</h2><ol>
<li><p>Function.prototype.bind</p>
</li>
<li><p>Function.prototype.call and Function.prototype.apply</p>
</li>
<li><p>that = this  _this = this</p>
</li>
<li><p>arrow function  this取决于声明的地方</p>
</li>
</ol>
<p>An arrow function does not have its own this<br>The this value of the enclosing lexical scope is used<br>arrow functions follow the normal variable lookup rules  </p>
<h2 id="this-in-a-constructor-function"><a href="#this-in-a-constructor-function" class="headerlink" title="this in a constructor function"></a>this in a constructor function</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">killsos.ql@gmail.com</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">135</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">killsos.ql@gmail.com</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
